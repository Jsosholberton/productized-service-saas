(()=>{var a={};a.id=203,a.ids=[203],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},1881:a=>{"use strict";var b=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyNames,e=Object.prototype.hasOwnProperty,f={};((a,c)=>{for(var d in c)b(a,d,{get:c[d],enumerable:!0})})(f,{VercelOidcTokenError:()=>g}),a.exports=((a,f,g,h)=>{if(f&&"object"==typeof f||"function"==typeof f)for(let i of d(f))e.call(a,i)||i===g||b(a,i,{get:()=>f[i],enumerable:!(h=c(f,i))||h.enumerable});return a})(b({},"__esModule",{value:!0}),f);class g extends Error{constructor(a,b){super(a),this.name="VercelOidcTokenError",this.cause=b}toString(){return this.cause?`${this.name}: ${this.message}: ${this.cause}`:`${this.name}: ${this.message}`}}},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3421:(a,b,c)=>{"use strict";Object.defineProperty(b,"I",{enumerable:!0,get:function(){return g}});let d=c(71237),e=c(55088),f=c(17679);async function g(a,b,c,g){if((0,d.isNodeNextResponse)(b)){var h;b.statusCode=c.status,b.statusMessage=c.statusText;let d=["set-cookie","www-authenticate","proxy-authenticate","vary"];null==(h=c.headers)||h.forEach((a,c)=>{if("x-middleware-set-cookie"!==c.toLowerCase())if("set-cookie"===c.toLowerCase())for(let d of(0,f.splitCookiesString)(a))b.appendHeader(c,d);else{let e=void 0!==b.getHeader(c);(d.includes(c.toLowerCase())||!e)&&b.appendHeader(c,a)}});let{originalResponse:i}=b;c.body&&"HEAD"!==a.method?await (0,e.pipeToNodeResponse)(c.body,i,g):i.end()}}},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12872:(a,b,c)=>{"use strict";c.r(b),c.d(b,{"40b68259517ab7548e158ff6ef0a3c29864d8ee30a":()=>d.k,"70ce1ba1547cb37e65932060a56ac8051d2e68d52e":()=>d.V});var d=c(38279)},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:a=>{"use strict";a.exports=require("os")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{"use strict";a.exports=require("path")},38279:(a,b,c)=>{"use strict";let d;c.d(b,{k:()=>kZ,V:()=>k$});var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af=c(75879);c(68633);var ag="vercel.ai.error",ah=Symbol.for(ag),ai=class a extends(f=Error,e=ah,f){constructor({name:a,message:b,cause:c}){super(b),this[e]=!0,this.name=a,this.cause=c}static isInstance(b){return a.hasMarker(b,ag)}static hasMarker(a,b){let c=Symbol.for(b);return null!=a&&"object"==typeof a&&c in a&&"boolean"==typeof a[c]&&!0===a[c]}},aj="AI_APICallError",ak=`vercel.ai.error.${aj}`,al=Symbol.for(ak),am=class extends(h=ai,g=al,h){constructor({message:a,url:b,requestBodyValues:c,statusCode:d,responseHeaders:e,responseBody:f,cause:h,isRetryable:i=null!=d&&(408===d||409===d||429===d||d>=500),data:j}){super({name:aj,message:a,cause:h}),this[g]=!0,this.url=b,this.requestBodyValues=c,this.statusCode=d,this.responseHeaders=e,this.responseBody=f,this.isRetryable=i,this.data=j}static isInstance(a){return ai.hasMarker(a,ak)}},an="AI_EmptyResponseBodyError",ao=`vercel.ai.error.${an}`,ap=Symbol.for(ao),aq=class extends(j=ai,i=ap,j){constructor({message:a="Empty response body"}={}){super({name:an,message:a}),this[i]=!0}static isInstance(a){return ai.hasMarker(a,ao)}};function ar(a){return null==a?"unknown error":"string"==typeof a?a:a instanceof Error?a.message:JSON.stringify(a)}var as="AI_InvalidArgumentError",at=`vercel.ai.error.${as}`,au=Symbol.for(at),av=class extends(l=ai,k=au,l){constructor({message:a,cause:b,argument:c}){super({name:as,message:a,cause:b}),this[k]=!0,this.argument=c}static isInstance(a){return ai.hasMarker(a,at)}},aw="AI_InvalidPromptError",ax=`vercel.ai.error.${aw}`,ay=Symbol.for(ax),az=class extends(n=ai,m=ay,n){constructor({prompt:a,message:b,cause:c}){super({name:aw,message:`Invalid prompt: ${b}`,cause:c}),this[m]=!0,this.prompt=a}static isInstance(a){return ai.hasMarker(a,ax)}},aA="AI_InvalidResponseDataError",aB=`vercel.ai.error.${aA}`,aC=Symbol.for(aB),aD=class extends(p=ai,o=aC,p){constructor({data:a,message:b=`Invalid response data: ${JSON.stringify(a)}.`}){super({name:aA,message:b}),this[o]=!0,this.data=a}static isInstance(a){return ai.hasMarker(a,aB)}},aE="AI_JSONParseError",aF=`vercel.ai.error.${aE}`,aG=Symbol.for(aF),aH=class extends(r=ai,q=aG,r){constructor({text:a,cause:b}){super({name:aE,message:`JSON parsing failed: Text: ${a}.
Error message: ${ar(b)}`,cause:b}),this[q]=!0,this.text=a}static isInstance(a){return ai.hasMarker(a,aF)}},aI="AI_LoadAPIKeyError",aJ=`vercel.ai.error.${aI}`,aK=Symbol.for(aJ),aL=class extends(t=ai,s=aK,t){constructor({message:a}){super({name:aI,message:a}),this[s]=!0}static isInstance(a){return ai.hasMarker(a,aJ)}},aM=Symbol.for("vercel.ai.error.AI_LoadSettingError");Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");Symbol.for("vercel.ai.error.AI_NoSuchModelError");var aN="AI_TooManyEmbeddingValuesForCallError",aO=`vercel.ai.error.${aN}`,aP=Symbol.for(aO),aQ=class extends(v=ai,u=aP,v){constructor(a){super({name:aN,message:`Too many values for a single embedding call. The ${a.provider} model "${a.modelId}" can only embed up to ${a.maxEmbeddingsPerCall} values per call, but ${a.values.length} values were provided.`}),this[u]=!0,this.provider=a.provider,this.modelId=a.modelId,this.maxEmbeddingsPerCall=a.maxEmbeddingsPerCall,this.values=a.values}static isInstance(a){return ai.hasMarker(a,aO)}},aR="AI_TypeValidationError",aS=`vercel.ai.error.${aR}`,aT=Symbol.for(aS),aU=class a extends(x=ai,w=aT,x){constructor({value:a,cause:b,context:c}){let d="Type validation failed";if((null==c?void 0:c.field)&&(d+=` for ${c.field}`),(null==c?void 0:c.entityName)||(null==c?void 0:c.entityId)){d+=" (";let a=[];c.entityName&&a.push(c.entityName),c.entityId&&a.push(`id: "${c.entityId}"`),d+=a.join(", "),d+=")"}super({name:aR,message:`${d}: Value: ${JSON.stringify(a)}.
Error message: ${ar(b)}`,cause:b}),this[w]=!0,this.value=a,this.context=c}static isInstance(a){return ai.hasMarker(a,aS)}static wrap({value:b,cause:c,context:d}){var e,f,g;return a.isInstance(c)&&c.value===b&&(null==(e=c.context)?void 0:e.field)===(null==d?void 0:d.field)&&(null==(f=c.context)?void 0:f.entityName)===(null==d?void 0:d.entityName)&&(null==(g=c.context)?void 0:g.entityId)===(null==d?void 0:d.entityId)?c:new a({value:b,cause:c,context:d})}},aV="AI_UnsupportedFunctionalityError",aW=`vercel.ai.error.${aV}`,aX=Symbol.for(aW),aY=class extends(z=ai,y=aX,z){constructor({functionality:a,message:b=`'${a}' functionality not supported.`}){super({name:aV,message:b}),this[y]=!0,this.functionality=a}static isInstance(a){return ai.hasMarker(a,aW)}};Symbol("ZodOutput"),Symbol("ZodInput");class aZ{constructor(){this._map=new Map,this._idmap=new Map}add(a,...b){let c=b[0];if(this._map.set(a,c),c&&"object"==typeof c&&"id"in c){if(this._idmap.has(c.id))throw Error(`ID ${c.id} already exists in the registry`);this._idmap.set(c.id,a)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(a){let b=this._map.get(a);return b&&"object"==typeof b&&"id"in b&&this._idmap.delete(b.id),this._map.delete(a),this}get(a){let b=a._zod.parent;if(b){let c={...this.get(b)??{}};return delete c.id,{...c,...this._map.get(a)}}return this._map.get(a)}has(a){return this._map.has(a)}}let a$=new aZ;function a_(a){let b=Object.values(a).filter(a=>"number"==typeof a);return Object.entries(a).filter(([a,c])=>-1===b.indexOf(+a)).map(([a,b])=>b)}function a0(a,b){return"bigint"==typeof b?b.toString():b}function a1(a){return{get value(){{let b=a();return Object.defineProperty(this,"value",{value:b}),b}}}}function a2(a){let b=+!!a.startsWith("^"),c=a.endsWith("$")?a.length-1:a.length;return a.slice(b,c)}function a3(a,b,c){Object.defineProperty(a,b,{get(){{let d=c();return a[b]=d,d}},set(c){Object.defineProperty(a,b,{value:c})},configurable:!0})}function a4(a,b,c){Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!0,configurable:!0})}function a5(a){return JSON.stringify(a)}let a6=Error.captureStackTrace?Error.captureStackTrace:(...a)=>{};function a7(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}let a8=a1(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(a){return!1}});function a9(a){if(!1===a7(a))return!1;let b=a.constructor;if(void 0===b)return!0;let c=b.prototype;return!1!==a7(c)&&!1!==Object.prototype.hasOwnProperty.call(c,"isPrototypeOf")}let ba=new Set(["string","number","symbol"]);function bb(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function bc(a,b,c){let d=new a._zod.constr(b??a._zod.def);return(!b||c?.parent)&&(d._zod.parent=a),d}function bd(a){if(!a)return{};if("string"==typeof a)return{error:()=>a};if(a?.message!==void 0){if(a?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");a.error=a.message}return(delete a.message,"string"==typeof a.error)?{...a,error:()=>a.error}:a}let be={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function bf(a,b=0){for(let c=b;c<a.issues.length;c++)if(a.issues[c]?.continue!==!0)return!0;return!1}function bg(a,b){return b.map(b=>(b.path??(b.path=[]),b.path.unshift(a),b))}function bh(a){return"string"==typeof a?a:a?.message}function bi(a,b,c){let d={...a,path:a.path??[]};return a.message||(d.message=bh(a.inst?._zod.def?.error?.(a))??bh(b?.error?.(a))??bh(c.customError?.(a))??bh(c.localeError?.(a))??"Invalid input"),delete d.inst,delete d.continue,b?.reportInput||delete d.input,d}function bj(a){return Array.isArray(a)?"array":"string"==typeof a?"string":"unknown"}function bk(...a){let[b,c,d]=a;return"string"==typeof b?{message:b,code:"custom",input:c,inst:d}:{...b}}class bl{constructor(a){this.counter=0,this.metadataRegistry=a?.metadata??a$,this.target=a?.target??"draft-2020-12",this.unrepresentable=a?.unrepresentable??"throw",this.override=a?.override??(()=>{}),this.io=a?.io??"output",this.seen=new Map}process(a,b={path:[],schemaPath:[]}){var c;let d=a._zod.def,e=this.seen.get(a);if(e)return e.count++,b.schemaPath.includes(a)&&(e.cycle=b.path),e.schema;let f={schema:{},count:1,cycle:void 0,path:b.path};this.seen.set(a,f);let g=a._zod.toJSONSchema?.();if(g)f.schema=g;else{let c={...b,schemaPath:[...b.schemaPath,a],path:b.path},e=a._zod.parent;if(e)f.ref=e,this.process(e,c),this.seen.get(e).isParent=!0;else{let b=f.schema;switch(d.type){case"string":{b.type="string";let{minimum:c,maximum:d,format:e,patterns:g,contentEncoding:h}=a._zod.bag;if("number"==typeof c&&(b.minLength=c),"number"==typeof d&&(b.maxLength=d),e&&(b.format=({guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""})[e]??e,""===b.format&&delete b.format),h&&(b.contentEncoding=h),g&&g.size>0){let a=[...g];1===a.length?b.pattern=a[0].source:a.length>1&&(f.schema.allOf=[...a.map(a=>({..."draft-7"===this.target?{type:"string"}:{},pattern:a.source}))])}break}case"number":{let{minimum:c,maximum:d,format:e,multipleOf:f,exclusiveMaximum:g,exclusiveMinimum:h}=a._zod.bag;"string"==typeof e&&e.includes("int")?b.type="integer":b.type="number","number"==typeof h&&(b.exclusiveMinimum=h),"number"==typeof c&&(b.minimum=c,"number"==typeof h&&(h>=c?delete b.minimum:delete b.exclusiveMinimum)),"number"==typeof g&&(b.exclusiveMaximum=g),"number"==typeof d&&(b.maximum=d,"number"==typeof g&&(g<=d?delete b.maximum:delete b.exclusiveMaximum)),"number"==typeof f&&(b.multipleOf=f);break}case"boolean":case"success":b.type="boolean";break;case"bigint":if("throw"===this.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema");break;case"symbol":if("throw"===this.unrepresentable)throw Error("Symbols cannot be represented in JSON Schema");break;case"null":b.type="null";break;case"any":case"unknown":break;case"undefined":if("throw"===this.unrepresentable)throw Error("Undefined cannot be represented in JSON Schema");break;case"void":if("throw"===this.unrepresentable)throw Error("Void cannot be represented in JSON Schema");break;case"never":b.not={};break;case"date":if("throw"===this.unrepresentable)throw Error("Date cannot be represented in JSON Schema");break;case"array":{let{minimum:e,maximum:f}=a._zod.bag;"number"==typeof e&&(b.minItems=e),"number"==typeof f&&(b.maxItems=f),b.type="array",b.items=this.process(d.element,{...c,path:[...c.path,"items"]});break}case"object":{b.type="object",b.properties={};let a=d.shape;for(let d in a)b.properties[d]=this.process(a[d],{...c,path:[...c.path,"properties",d]});let e=new Set([...new Set(Object.keys(a))].filter(a=>{let b=d.shape[a]._zod;return"input"===this.io?void 0===b.optin:void 0===b.optout}));e.size>0&&(b.required=Array.from(e)),d.catchall?._zod.def.type==="never"?b.additionalProperties=!1:d.catchall?d.catchall&&(b.additionalProperties=this.process(d.catchall,{...c,path:[...c.path,"additionalProperties"]})):"output"===this.io&&(b.additionalProperties=!1);break}case"union":b.anyOf=d.options.map((a,b)=>this.process(a,{...c,path:[...c.path,"anyOf",b]}));break;case"intersection":{let a=this.process(d.left,{...c,path:[...c.path,"allOf",0]}),e=this.process(d.right,{...c,path:[...c.path,"allOf",1]}),f=a=>"allOf"in a&&1===Object.keys(a).length;b.allOf=[...f(a)?a.allOf:[a],...f(e)?e.allOf:[e]];break}case"tuple":{b.type="array";let e=d.items.map((a,b)=>this.process(a,{...c,path:[...c.path,"prefixItems",b]}));if("draft-2020-12"===this.target?b.prefixItems=e:b.items=e,d.rest){let a=this.process(d.rest,{...c,path:[...c.path,"items"]});"draft-2020-12"===this.target?b.items=a:b.additionalItems=a}d.rest&&(b.items=this.process(d.rest,{...c,path:[...c.path,"items"]}));let{minimum:f,maximum:g}=a._zod.bag;"number"==typeof f&&(b.minItems=f),"number"==typeof g&&(b.maxItems=g);break}case"record":b.type="object",b.propertyNames=this.process(d.keyType,{...c,path:[...c.path,"propertyNames"]}),b.additionalProperties=this.process(d.valueType,{...c,path:[...c.path,"additionalProperties"]});break;case"map":if("throw"===this.unrepresentable)throw Error("Map cannot be represented in JSON Schema");break;case"set":if("throw"===this.unrepresentable)throw Error("Set cannot be represented in JSON Schema");break;case"enum":{let a=a_(d.entries);a.every(a=>"number"==typeof a)&&(b.type="number"),a.every(a=>"string"==typeof a)&&(b.type="string"),b.enum=a;break}case"literal":{let a=[];for(let b of d.values)if(void 0===b){if("throw"===this.unrepresentable)throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if("bigint"==typeof b)if("throw"===this.unrepresentable)throw Error("BigInt literals cannot be represented in JSON Schema");else a.push(Number(b));else a.push(b);if(0===a.length);else if(1===a.length){let c=a[0];b.type=null===c?"null":typeof c,b.const=c}else a.every(a=>"number"==typeof a)&&(b.type="number"),a.every(a=>"string"==typeof a)&&(b.type="string"),a.every(a=>"boolean"==typeof a)&&(b.type="string"),a.every(a=>null===a)&&(b.type="null"),b.enum=a;break}case"file":{let c={type:"string",format:"binary",contentEncoding:"binary"},{minimum:d,maximum:e,mime:f}=a._zod.bag;void 0!==d&&(c.minLength=d),void 0!==e&&(c.maxLength=e),f?1===f.length?(c.contentMediaType=f[0],Object.assign(b,c)):b.anyOf=f.map(a=>({...c,contentMediaType:a})):Object.assign(b,c);break}case"transform":if("throw"===this.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema");break;case"nullable":b.anyOf=[this.process(d.innerType,c),{type:"null"}];break;case"nonoptional":case"promise":case"optional":this.process(d.innerType,c),f.ref=d.innerType;break;case"default":this.process(d.innerType,c),f.ref=d.innerType,b.default=JSON.parse(JSON.stringify(d.defaultValue));break;case"prefault":this.process(d.innerType,c),f.ref=d.innerType,"input"===this.io&&(b._prefault=JSON.parse(JSON.stringify(d.defaultValue)));break;case"catch":{let a;this.process(d.innerType,c),f.ref=d.innerType;try{a=d.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}b.default=a;break}case"nan":if("throw"===this.unrepresentable)throw Error("NaN cannot be represented in JSON Schema");break;case"template_literal":{let c=a._zod.pattern;if(!c)throw Error("Pattern not found in template literal");b.type="string",b.pattern=c.source;break}case"pipe":{let a="input"===this.io?"transform"===d.in._zod.def.type?d.out:d.in:d.out;this.process(a,c),f.ref=a;break}case"readonly":this.process(d.innerType,c),f.ref=d.innerType,b.readOnly=!0;break;case"lazy":{let b=a._zod.innerType;this.process(b,c),f.ref=b;break}case"custom":if("throw"===this.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")}}}let h=this.metadataRegistry.get(a);return h&&Object.assign(f.schema,h),"input"===this.io&&function a(b,c){let d=c??{seen:new Set};if(d.seen.has(b))return!1;d.seen.add(b);let e=b._zod.def;switch(e.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":case"custom":case"success":case"catch":return!1;case"array":return a(e.element,d);case"object":for(let b in e.shape)if(a(e.shape[b],d))return!0;return!1;case"union":for(let b of e.options)if(a(b,d))return!0;return!1;case"intersection":return a(e.left,d)||a(e.right,d);case"tuple":for(let b of e.items)if(a(b,d))return!0;if(e.rest&&a(e.rest,d))return!0;return!1;case"record":case"map":return a(e.keyType,d)||a(e.valueType,d);case"set":return a(e.valueType,d);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":case"default":case"prefault":return a(e.innerType,d);case"lazy":return a(e.getter(),d);case"transform":return!0;case"pipe":return a(e.in,d)||a(e.out,d)}throw Error(`Unknown schema type: ${e.type}`)}(a)&&(delete f.schema.examples,delete f.schema.default),"input"===this.io&&f.schema._prefault&&((c=f.schema).default??(c.default=f.schema._prefault)),delete f.schema._prefault,this.seen.get(a).schema}emit(a,b){let c={cycles:b?.cycles??"ref",reused:b?.reused??"inline",external:b?.external??void 0},d=this.seen.get(a);if(!d)throw Error("Unprocessed schema. This is a bug in Zod.");let e=a=>{let b="draft-2020-12"===this.target?"$defs":"definitions";if(c.external){let d=c.external.registry.get(a[0])?.id,e=c.external.uri??(a=>a);if(d)return{ref:e(d)};let f=a[1].defId??a[1].schema.id??`schema${this.counter++}`;return a[1].defId=f,{defId:f,ref:`${e("__shared")}#/${b}/${f}`}}if(a[1]===d)return{ref:"#"};let e=`#/${b}/`,f=a[1].schema.id??`__schema${this.counter++}`;return{defId:f,ref:e+f}},f=a=>{if(a[1].schema.$ref)return;let b=a[1],{ref:c,defId:d}=e(a);b.def={...b.schema},d&&(b.defId=d);let f=b.schema;for(let a in f)delete f[a];f.$ref=c};if("throw"===c.cycles)for(let a of this.seen.entries()){let b=a[1];if(b.cycle)throw Error(`Cycle detected: #/${b.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let b of this.seen.entries()){let d=b[1];if(a===b[0]){f(b);continue}if(c.external){let d=c.external.registry.get(b[0])?.id;if(a!==b[0]&&d){f(b);continue}}if(this.metadataRegistry.get(b[0])?.id||d.cycle||d.count>1&&"ref"===c.reused){f(b);continue}}let g=(a,b)=>{let c=this.seen.get(a),d=c.def??c.schema,e={...d};if(null===c.ref)return;let f=c.ref;if(c.ref=null,f){g(f,b);let a=this.seen.get(f).schema;a.$ref&&"draft-7"===b.target?(d.allOf=d.allOf??[],d.allOf.push(a)):(Object.assign(d,a),Object.assign(d,e))}c.isParent||this.override({zodSchema:a,jsonSchema:d,path:c.path??[]})};for(let a of[...this.seen.entries()].reverse())g(a[0],{target:this.target});let h={};if("draft-2020-12"===this.target?h.$schema="https://json-schema.org/draft/2020-12/schema":"draft-7"===this.target?h.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),c.external?.uri){let b=c.external.registry.get(a)?.id;if(!b)throw Error("Schema is missing an `id` property");h.$id=c.external.uri(b)}Object.assign(h,d.def);let i=c.external?.defs??{};for(let a of this.seen.entries()){let b=a[1];b.def&&b.defId&&(i[b.defId]=b.def)}c.external||Object.keys(i).length>0&&("draft-2020-12"===this.target?h.$defs=i:h.definitions=i);try{return JSON.parse(JSON.stringify(h))}catch(a){throw Error("Error converting schema to JSON.")}}}function bm(a,b,c){function d(c,d){var e;for(let f in Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(e=c._zod).traits??(e.traits=new Set),c._zod.traits.add(a),b(c,d),g.prototype)f in c||Object.defineProperty(c,f,{value:g.prototype[f].bind(c)});c._zod.constr=g,c._zod.def=d}let e=c?.Parent??Object;class f extends e{}function g(a){var b;let e=c?.Parent?new f:this;for(let c of(d(e,a),(b=e._zod).deferred??(b.deferred=[]),e._zod.deferred))c();return e}return Object.defineProperty(f,"name",{value:a}),Object.defineProperty(g,"init",{value:d}),Object.defineProperty(g,Symbol.hasInstance,{value:b=>!!c?.Parent&&b instanceof c.Parent||b?._zod?.traits?.has(a)}),Object.defineProperty(g,"name",{value:a}),g}Object.freeze({status:"aborted"}),Symbol("zod_brand");class bn extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}let bo={};function bp(a){return a&&Object.assign(bo,a),bo}let bq=(a,b)=>{a.name="$ZodError",Object.defineProperty(a,"_zod",{value:a._zod,enumerable:!1}),Object.defineProperty(a,"issues",{value:b,enumerable:!1}),Object.defineProperty(a,"message",{get:()=>JSON.stringify(b,a0,2),enumerable:!0}),Object.defineProperty(a,"toString",{value:()=>a.message,enumerable:!1})},br=bm("$ZodError",bq),bs=bm("$ZodError",bq,{Parent:Error}),bt=a=>(b,c,d)=>{let e=d?{...d,async:!1}:{async:!1},f=b._zod.run({value:c,issues:[]},e);if(f instanceof Promise)throw new bn;return f.issues.length?{success:!1,error:new(a??br)(f.issues.map(a=>bi(a,e,bp())))}:{success:!0,data:f.value}},bu=bt(bs),bv=a=>async(b,c,d)=>{let e=d?Object.assign(d,{async:!0}):{async:!0},f=b._zod.run({value:c,issues:[]},e);return f instanceof Promise&&(f=await f),f.issues.length?{success:!1,error:new a(f.issues.map(a=>bi(a,e,bp())))}:{success:!0,data:f.value}},bw=bv(bs),bx=(a,b)=>{br.init(a,b),a.name="ZodError",Object.defineProperties(a,{format:{value:b=>(function(a,b){let c=b||function(a){return a.message},d={_errors:[]},e=a=>{for(let b of a.issues)if("invalid_union"===b.code&&b.errors.length)b.errors.map(a=>e({issues:a}));else if("invalid_key"===b.code)e({issues:b.issues});else if("invalid_element"===b.code)e({issues:b.issues});else if(0===b.path.length)d._errors.push(c(b));else{let a=d,e=0;for(;e<b.path.length;){let d=b.path[e];e===b.path.length-1?(a[d]=a[d]||{_errors:[]},a[d]._errors.push(c(b))):a[d]=a[d]||{_errors:[]},a=a[d],e++}}};return e(a),d})(a,b)},flatten:{value:b=>(function(a,b=a=>a.message){let c={},d=[];for(let e of a.issues)e.path.length>0?(c[e.path[0]]=c[e.path[0]]||[],c[e.path[0]].push(b(e))):d.push(b(e));return{formErrors:d,fieldErrors:c}})(a,b)},addIssue:{value:b=>a.issues.push(b)},addIssues:{value:b=>a.issues.push(...b)},isEmpty:{get:()=>0===a.issues.length}})};bm("ZodError",bx);let by=bm("ZodError",bx,{Parent:Error}),bz=(a,b,c,d)=>{let e=c?Object.assign(c,{async:!1}):{async:!1},f=a._zod.run({value:b,issues:[]},e);if(f instanceof Promise)throw new bn;if(f.issues.length){let a=new(d?.Err??by)(f.issues.map(a=>bi(a,e,bp())));throw a6(a,d?.callee),a}return f.value},bA=async(a,b,c,d)=>{let e=c?Object.assign(c,{async:!0}):{async:!0},f=a._zod.run({value:b,issues:[]},e);if(f instanceof Promise&&(f=await f),f.issues.length){let a=new(d?.Err??by)(f.issues.map(a=>bi(a,e,bp())));throw a6(a,d?.callee),a}return f.value},bB=bt(by),bC=bv(by);!function(a){a.assertEqual=a=>{},a.assertIs=function(a){},a.assertNever=function(a){throw Error()},a.arrayToEnum=a=>{let b={};for(let c of a)b[c]=c;return b},a.getValidEnumValues=b=>{let c=a.objectKeys(b).filter(a=>"number"!=typeof b[b[a]]),d={};for(let a of c)d[a]=b[a];return a.objectValues(d)},a.objectValues=b=>a.objectKeys(b).map(function(a){return b[a]}),a.objectKeys="function"==typeof Object.keys?a=>Object.keys(a):a=>{let b=[];for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},a.find=(a,b)=>{for(let c of a)if(b(c))return c},a.isInteger="function"==typeof Number.isInteger?a=>Number.isInteger(a):a=>"number"==typeof a&&Number.isFinite(a)&&Math.floor(a)===a,a.joinValues=function(a,b=" | "){return a.map(a=>"string"==typeof a?`'${a}'`:a).join(b)},a.jsonStringifyReplacer=(a,b)=>"bigint"==typeof b?b.toString():b}(A||(A={})),(B||(B={})).mergeShapes=(a,b)=>({...a,...b});let bD=A.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),bE=a=>{switch(typeof a){case"undefined":return bD.undefined;case"string":return bD.string;case"number":return Number.isNaN(a)?bD.nan:bD.number;case"boolean":return bD.boolean;case"function":return bD.function;case"bigint":return bD.bigint;case"symbol":return bD.symbol;case"object":if(Array.isArray(a))return bD.array;if(null===a)return bD.null;if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return bD.promise;if("undefined"!=typeof Map&&a instanceof Map)return bD.map;if("undefined"!=typeof Set&&a instanceof Set)return bD.set;if("undefined"!=typeof Date&&a instanceof Date)return bD.date;return bD.object;default:return bD.unknown}},bF=A.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class bG extends Error{get errors(){return this.issues}constructor(a){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};let b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=a}format(a){let b=a||function(a){return a.message},c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code)e.unionErrors.map(d);else if("invalid_return_type"===e.code)d(e.returnTypeError);else if("invalid_arguments"===e.code)d(e.argumentsError);else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(this),c}static assert(a){if(!(a instanceof bG))throw Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,A.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(a=a=>a.message){let b={},c=[];for(let d of this.issues)if(d.path.length>0){let c=d.path[0];b[c]=b[c]||[],b[c].push(a(d))}else c.push(a(d));return{formErrors:c,fieldErrors:b}}get formErrors(){return this.flatten()}}bG.create=a=>new bG(a);let bH=(a,b)=>{let c;switch(a.code){case bF.invalid_type:c=a.received===bD.undefined?"Required":`Expected ${a.expected}, received ${a.received}`;break;case bF.invalid_literal:c=`Invalid literal value, expected ${JSON.stringify(a.expected,A.jsonStringifyReplacer)}`;break;case bF.unrecognized_keys:c=`Unrecognized key(s) in object: ${A.joinValues(a.keys,", ")}`;break;case bF.invalid_union:c="Invalid input";break;case bF.invalid_union_discriminator:c=`Invalid discriminator value. Expected ${A.joinValues(a.options)}`;break;case bF.invalid_enum_value:c=`Invalid enum value. Expected ${A.joinValues(a.options)}, received '${a.received}'`;break;case bF.invalid_arguments:c="Invalid function arguments";break;case bF.invalid_return_type:c="Invalid function return type";break;case bF.invalid_date:c="Invalid date";break;case bF.invalid_string:"object"==typeof a.validation?"includes"in a.validation?(c=`Invalid input: must include "${a.validation.includes}"`,"number"==typeof a.validation.position&&(c=`${c} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?c=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?c=`Invalid input: must end with "${a.validation.endsWith}"`:A.assertNever(a.validation):c="regex"!==a.validation?`Invalid ${a.validation}`:"Invalid";break;case bF.too_small:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:"number"===a.type||"bigint"===a.type?`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:"date"===a.type?`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:"Invalid input";break;case bF.too_big:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"bigint"===a.type?`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"date"===a.type?`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:"Invalid input";break;case bF.custom:c="Invalid input";break;case bF.invalid_intersection_types:c="Intersection results could not be merged";break;case bF.not_multiple_of:c=`Number must be a multiple of ${a.multipleOf}`;break;case bF.not_finite:c="Number must be finite";break;default:c=b.defaultError,A.assertNever(a)}return{message:c}};!function(a){a.errToObj=a=>"string"==typeof a?{message:a}:a||{},a.toString=a=>"string"==typeof a?a:a?.message}(C||(C={}));let bI=a=>{let{data:b,path:c,errorMaps:d,issueData:e}=a,f=[...c,...e.path||[]],g={...e,path:f};if(void 0!==e.message)return{...e,path:f,message:e.message};let h="";for(let a of d.filter(a=>!!a).slice().reverse())h=a(g,{data:b,defaultError:h}).message;return{...e,path:f,message:h}};function bJ(a,b){let c=bI({issueData:b,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,bH,void 0].filter(a=>!!a)});a.common.issues.push(c)}class bK{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(a,b){let c=[];for(let d of b){if("aborted"===d.status)return bL;"dirty"===d.status&&a.dirty(),c.push(d.value)}return{status:a.value,value:c}}static async mergeObjectAsync(a,b){let c=[];for(let a of b){let b=await a.key,d=await a.value;c.push({key:b,value:d})}return bK.mergeObjectSync(a,c)}static mergeObjectSync(a,b){let c={};for(let d of b){let{key:b,value:e}=d;if("aborted"===b.status||"aborted"===e.status)return bL;"dirty"===b.status&&a.dirty(),"dirty"===e.status&&a.dirty(),"__proto__"!==b.value&&(void 0!==e.value||d.alwaysSet)&&(c[b.value]=e.value)}return{status:a.value,value:c}}}let bL=Object.freeze({status:"aborted"}),bM=a=>({status:"dirty",value:a}),bN=a=>({status:"valid",value:a}),bO=a=>"undefined"!=typeof Promise&&a instanceof Promise;class bP{constructor(a,b,c,d){this._cachedPath=[],this.parent=a,this.data=b,this._path=c,this._key=d}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let bQ=(a,b)=>{if("valid"===b.status)return{success:!0,data:b.value};if(!a.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let b=new bG(a.common.issues);return this._error=b,this._error}}};function bR(a){if(!a)return{};let{errorMap:b,invalid_type_error:c,required_error:d,description:e}=a;if(b&&(c||d))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return b?{errorMap:b,description:e}:{errorMap:(b,e)=>{let{message:f}=a;return"invalid_enum_value"===b.code?{message:f??e.defaultError}:void 0===e.data?{message:f??d??e.defaultError}:"invalid_type"!==b.code?{message:e.defaultError}:{message:f??c??e.defaultError}},description:e}}class bS{get description(){return this._def.description}_getType(a){return bE(a.data)}_getOrReturnCtx(a,b){return b||{common:a.parent.common,data:a.data,parsedType:bE(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new bK,ctx:{common:a.parent.common,data:a.data,parsedType:bE(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){let b=this._parse(a);if(bO(b))throw Error("Synchronous parse encountered promise.");return b}_parseAsync(a){return Promise.resolve(this._parse(a))}parse(a,b){let c=this.safeParse(a,b);if(c.success)return c.data;throw c.error}safeParse(a,b){let c={common:{issues:[],async:b?.async??!1,contextualErrorMap:b?.errorMap},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:bE(a)},d=this._parseSync({data:a,path:c.path,parent:c});return bQ(c,d)}"~validate"(a){let b={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:bE(a)};if(!this["~standard"].async)try{let c=this._parseSync({data:a,path:[],parent:b});return"valid"===c.status?{value:c.value}:{issues:b.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),b.common={issues:[],async:!0}}return this._parseAsync({data:a,path:[],parent:b}).then(a=>"valid"===a.status?{value:a.value}:{issues:b.common.issues})}async parseAsync(a,b){let c=await this.safeParseAsync(a,b);if(c.success)return c.data;throw c.error}async safeParseAsync(a,b){let c={common:{issues:[],contextualErrorMap:b?.errorMap,async:!0},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:bE(a)},d=this._parse({data:a,path:c.path,parent:c});return bQ(c,await (bO(d)?d:Promise.resolve(d)))}refine(a,b){return this._refinement((c,d)=>{let e=a(c),f=()=>d.addIssue({code:bF.custom,..."string"==typeof b||void 0===b?{message:b}:"function"==typeof b?b(c):b});return"undefined"!=typeof Promise&&e instanceof Promise?e.then(a=>!!a||(f(),!1)):!!e||(f(),!1)})}refinement(a,b){return this._refinement((c,d)=>!!a(c)||(d.addIssue("function"==typeof b?b(c,d):b),!1))}_refinement(a){return new cB({schema:this,typeName:D.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return cC.create(this,this._def)}nullable(){return cD.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ck.create(this)}promise(){return cA.create(this,this._def)}or(a){return cm.create([this,a],this._def)}and(a){return cp.create(this,a,this._def)}transform(a){return new cB({...bR(this._def),schema:this,typeName:D.ZodEffects,effect:{type:"transform",transform:a}})}default(a){return new cE({...bR(this._def),innerType:this,defaultValue:"function"==typeof a?a:()=>a,typeName:D.ZodDefault})}brand(){return new cH({typeName:D.ZodBranded,type:this,...bR(this._def)})}catch(a){return new cF({...bR(this._def),innerType:this,catchValue:"function"==typeof a?a:()=>a,typeName:D.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return cI.create(this,a)}readonly(){return cJ.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let bT=/^c[^\s-]{8,}$/i,bU=/^[0-9a-z]+$/,bV=/^[0-9A-HJKMNP-TV-Z]{26}$/i,bW=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,bX=/^[a-z0-9_-]{21}$/i,bY=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,bZ=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,b$=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,b_=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,b0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,b1=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,b2=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,b3=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,b4=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,b5="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",b6=RegExp(`^${b5}$`);function b7(a){let b="[0-5]\\d";a.precision?b=`${b}\\.\\d{${a.precision}}`:null==a.precision&&(b=`${b}(\\.\\d+)?`);let c=a.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${b})${c}`}class b8 extends bS{_parse(a){var b,c,e,f;let g;if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==bD.string){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.string,received:b.parsedType}),bL}let h=new bK;for(let i of this._def.checks)if("min"===i.kind)a.data.length<i.value&&(bJ(g=this._getOrReturnCtx(a,g),{code:bF.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("max"===i.kind)a.data.length>i.value&&(bJ(g=this._getOrReturnCtx(a,g),{code:bF.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("length"===i.kind){let b=a.data.length>i.value,c=a.data.length<i.value;(b||c)&&(g=this._getOrReturnCtx(a,g),b?bJ(g,{code:bF.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&bJ(g,{code:bF.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),h.dirty())}else if("email"===i.kind)b$.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"email",code:bF.invalid_string,message:i.message}),h.dirty());else if("emoji"===i.kind)d||(d=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),d.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"emoji",code:bF.invalid_string,message:i.message}),h.dirty());else if("uuid"===i.kind)bW.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"uuid",code:bF.invalid_string,message:i.message}),h.dirty());else if("nanoid"===i.kind)bX.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"nanoid",code:bF.invalid_string,message:i.message}),h.dirty());else if("cuid"===i.kind)bT.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"cuid",code:bF.invalid_string,message:i.message}),h.dirty());else if("cuid2"===i.kind)bU.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"cuid2",code:bF.invalid_string,message:i.message}),h.dirty());else if("ulid"===i.kind)bV.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"ulid",code:bF.invalid_string,message:i.message}),h.dirty());else if("url"===i.kind)try{new URL(a.data)}catch{bJ(g=this._getOrReturnCtx(a,g),{validation:"url",code:bF.invalid_string,message:i.message}),h.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"regex",code:bF.invalid_string,message:i.message}),h.dirty())):"trim"===i.kind?a.data=a.data.trim():"includes"===i.kind?a.data.includes(i.value,i.position)||(bJ(g=this._getOrReturnCtx(a,g),{code:bF.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),h.dirty()):"toLowerCase"===i.kind?a.data=a.data.toLowerCase():"toUpperCase"===i.kind?a.data=a.data.toUpperCase():"startsWith"===i.kind?a.data.startsWith(i.value)||(bJ(g=this._getOrReturnCtx(a,g),{code:bF.invalid_string,validation:{startsWith:i.value},message:i.message}),h.dirty()):"endsWith"===i.kind?a.data.endsWith(i.value)||(bJ(g=this._getOrReturnCtx(a,g),{code:bF.invalid_string,validation:{endsWith:i.value},message:i.message}),h.dirty()):"datetime"===i.kind?(function(a){let b=`${b5}T${b7(a)}`,c=[];return c.push(a.local?"Z?":"Z"),a.offset&&c.push("([+-]\\d{2}:?\\d{2})"),b=`${b}(${c.join("|")})`,RegExp(`^${b}$`)})(i).test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{code:bF.invalid_string,validation:"datetime",message:i.message}),h.dirty()):"date"===i.kind?b6.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{code:bF.invalid_string,validation:"date",message:i.message}),h.dirty()):"time"===i.kind?RegExp(`^${b7(i)}$`).test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{code:bF.invalid_string,validation:"time",message:i.message}),h.dirty()):"duration"===i.kind?bZ.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"duration",code:bF.invalid_string,message:i.message}),h.dirty()):"ip"===i.kind?(b=a.data,!(("v4"===(c=i.version)||!c)&&b_.test(b)||("v6"===c||!c)&&b1.test(b))&&1&&(bJ(g=this._getOrReturnCtx(a,g),{validation:"ip",code:bF.invalid_string,message:i.message}),h.dirty())):"jwt"===i.kind?!function(a,b){if(!bY.test(a))return!1;try{let[c]=a.split(".");if(!c)return!1;let d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),e=JSON.parse(atob(d));if("object"!=typeof e||null===e||"typ"in e&&e?.typ!=="JWT"||!e.alg||b&&e.alg!==b)return!1;return!0}catch{return!1}}(a.data,i.alg)&&(bJ(g=this._getOrReturnCtx(a,g),{validation:"jwt",code:bF.invalid_string,message:i.message}),h.dirty()):"cidr"===i.kind?(e=a.data,!(("v4"===(f=i.version)||!f)&&b0.test(e)||("v6"===f||!f)&&b2.test(e))&&1&&(bJ(g=this._getOrReturnCtx(a,g),{validation:"cidr",code:bF.invalid_string,message:i.message}),h.dirty())):"base64"===i.kind?b3.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"base64",code:bF.invalid_string,message:i.message}),h.dirty()):"base64url"===i.kind?b4.test(a.data)||(bJ(g=this._getOrReturnCtx(a,g),{validation:"base64url",code:bF.invalid_string,message:i.message}),h.dirty()):A.assertNever(i);return{status:h.value,value:a.data}}_regex(a,b,c){return this.refinement(b=>a.test(b),{validation:b,code:bF.invalid_string,...C.errToObj(c)})}_addCheck(a){return new b8({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...C.errToObj(a)})}url(a){return this._addCheck({kind:"url",...C.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...C.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...C.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...C.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...C.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...C.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...C.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...C.errToObj(a)})}base64url(a){return this._addCheck({kind:"base64url",...C.errToObj(a)})}jwt(a){return this._addCheck({kind:"jwt",...C.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...C.errToObj(a)})}cidr(a){return this._addCheck({kind:"cidr",...C.errToObj(a)})}datetime(a){return"string"==typeof a?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:void 0===a?.precision?null:a?.precision,offset:a?.offset??!1,local:a?.local??!1,...C.errToObj(a?.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return"string"==typeof a?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:void 0===a?.precision?null:a?.precision,...C.errToObj(a?.message)})}duration(a){return this._addCheck({kind:"duration",...C.errToObj(a)})}regex(a,b){return this._addCheck({kind:"regex",regex:a,...C.errToObj(b)})}includes(a,b){return this._addCheck({kind:"includes",value:a,position:b?.position,...C.errToObj(b?.message)})}startsWith(a,b){return this._addCheck({kind:"startsWith",value:a,...C.errToObj(b)})}endsWith(a,b){return this._addCheck({kind:"endsWith",value:a,...C.errToObj(b)})}min(a,b){return this._addCheck({kind:"min",value:a,...C.errToObj(b)})}max(a,b){return this._addCheck({kind:"max",value:a,...C.errToObj(b)})}length(a,b){return this._addCheck({kind:"length",value:a,...C.errToObj(b)})}nonempty(a){return this.min(1,C.errToObj(a))}trim(){return new b8({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new b8({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new b8({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>"datetime"===a.kind)}get isDate(){return!!this._def.checks.find(a=>"date"===a.kind)}get isTime(){return!!this._def.checks.find(a=>"time"===a.kind)}get isDuration(){return!!this._def.checks.find(a=>"duration"===a.kind)}get isEmail(){return!!this._def.checks.find(a=>"email"===a.kind)}get isURL(){return!!this._def.checks.find(a=>"url"===a.kind)}get isEmoji(){return!!this._def.checks.find(a=>"emoji"===a.kind)}get isUUID(){return!!this._def.checks.find(a=>"uuid"===a.kind)}get isNANOID(){return!!this._def.checks.find(a=>"nanoid"===a.kind)}get isCUID(){return!!this._def.checks.find(a=>"cuid"===a.kind)}get isCUID2(){return!!this._def.checks.find(a=>"cuid2"===a.kind)}get isULID(){return!!this._def.checks.find(a=>"ulid"===a.kind)}get isIP(){return!!this._def.checks.find(a=>"ip"===a.kind)}get isCIDR(){return!!this._def.checks.find(a=>"cidr"===a.kind)}get isBase64(){return!!this._def.checks.find(a=>"base64"===a.kind)}get isBase64url(){return!!this._def.checks.find(a=>"base64url"===a.kind)}get minLength(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxLength(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}b8.create=a=>new b8({checks:[],typeName:D.ZodString,coerce:a?.coerce??!1,...bR(a)});class b9 extends bS{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){let b;if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==bD.number){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.number,received:b.parsedType}),bL}let c=new bK;for(let d of this._def.checks)"int"===d.kind?A.isInteger(a.data)||(bJ(b=this._getOrReturnCtx(a,b),{code:bF.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(bJ(b=this._getOrReturnCtx(a,b),{code:bF.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(bJ(b=this._getOrReturnCtx(a,b),{code:bF.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"multipleOf"===d.kind?0!==function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}(a.data,d.value)&&(bJ(b=this._getOrReturnCtx(a,b),{code:bF.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):"finite"===d.kind?Number.isFinite(a.data)||(bJ(b=this._getOrReturnCtx(a,b),{code:bF.not_finite,message:d.message}),c.dirty()):A.assertNever(d);return{status:c.value,value:a.data}}gte(a,b){return this.setLimit("min",a,!0,C.toString(b))}gt(a,b){return this.setLimit("min",a,!1,C.toString(b))}lte(a,b){return this.setLimit("max",a,!0,C.toString(b))}lt(a,b){return this.setLimit("max",a,!1,C.toString(b))}setLimit(a,b,c,d){return new b9({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:C.toString(d)}]})}_addCheck(a){return new b9({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:C.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:C.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:C.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:C.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:C.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:C.toString(b)})}finite(a){return this._addCheck({kind:"finite",message:C.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:C.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:C.toString(a)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}get isInt(){return!!this._def.checks.find(a=>"int"===a.kind||"multipleOf"===a.kind&&A.isInteger(a.value))}get isFinite(){let a=null,b=null;for(let c of this._def.checks)if("finite"===c.kind||"int"===c.kind||"multipleOf"===c.kind)return!0;else"min"===c.kind?(null===b||c.value>b)&&(b=c.value):"max"===c.kind&&(null===a||c.value<a)&&(a=c.value);return Number.isFinite(b)&&Number.isFinite(a)}}b9.create=a=>new b9({checks:[],typeName:D.ZodNumber,coerce:a?.coerce||!1,...bR(a)});class ca extends bS{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){let b;if(this._def.coerce)try{a.data=BigInt(a.data)}catch{return this._getInvalidInput(a)}if(this._getType(a)!==bD.bigint)return this._getInvalidInput(a);let c=new bK;for(let d of this._def.checks)"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(bJ(b=this._getOrReturnCtx(a,b),{code:bF.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(bJ(b=this._getOrReturnCtx(a,b),{code:bF.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"multipleOf"===d.kind?a.data%d.value!==BigInt(0)&&(bJ(b=this._getOrReturnCtx(a,b),{code:bF.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):A.assertNever(d);return{status:c.value,value:a.data}}_getInvalidInput(a){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.bigint,received:b.parsedType}),bL}gte(a,b){return this.setLimit("min",a,!0,C.toString(b))}gt(a,b){return this.setLimit("min",a,!1,C.toString(b))}lte(a,b){return this.setLimit("max",a,!0,C.toString(b))}lt(a,b){return this.setLimit("max",a,!1,C.toString(b))}setLimit(a,b,c,d){return new ca({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:C.toString(d)}]})}_addCheck(a){return new ca({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:C.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:C.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:C.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:C.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:C.toString(b)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}ca.create=a=>new ca({checks:[],typeName:D.ZodBigInt,coerce:a?.coerce??!1,...bR(a)});class cb extends bS{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==bD.boolean){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.boolean,received:b.parsedType}),bL}return bN(a.data)}}cb.create=a=>new cb({typeName:D.ZodBoolean,coerce:a?.coerce||!1,...bR(a)});class cc extends bS{_parse(a){let b;if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==bD.date){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.date,received:b.parsedType}),bL}if(Number.isNaN(a.data.getTime()))return bJ(this._getOrReturnCtx(a),{code:bF.invalid_date}),bL;let c=new bK;for(let d of this._def.checks)"min"===d.kind?a.data.getTime()<d.value&&(bJ(b=this._getOrReturnCtx(a,b),{code:bF.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),c.dirty()):"max"===d.kind?a.data.getTime()>d.value&&(bJ(b=this._getOrReturnCtx(a,b),{code:bF.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),c.dirty()):A.assertNever(d);return{status:c.value,value:new Date(a.data.getTime())}}_addCheck(a){return new cc({...this._def,checks:[...this._def.checks,a]})}min(a,b){return this._addCheck({kind:"min",value:a.getTime(),message:C.toString(b)})}max(a,b){return this._addCheck({kind:"max",value:a.getTime(),message:C.toString(b)})}get minDate(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return null!=a?new Date(a):null}get maxDate(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return null!=a?new Date(a):null}}cc.create=a=>new cc({checks:[],coerce:a?.coerce||!1,typeName:D.ZodDate,...bR(a)});class cd extends bS{_parse(a){if(this._getType(a)!==bD.symbol){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.symbol,received:b.parsedType}),bL}return bN(a.data)}}cd.create=a=>new cd({typeName:D.ZodSymbol,...bR(a)});class ce extends bS{_parse(a){if(this._getType(a)!==bD.undefined){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.undefined,received:b.parsedType}),bL}return bN(a.data)}}ce.create=a=>new ce({typeName:D.ZodUndefined,...bR(a)});class cf extends bS{_parse(a){if(this._getType(a)!==bD.null){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.null,received:b.parsedType}),bL}return bN(a.data)}}cf.create=a=>new cf({typeName:D.ZodNull,...bR(a)});class cg extends bS{constructor(){super(...arguments),this._any=!0}_parse(a){return bN(a.data)}}cg.create=a=>new cg({typeName:D.ZodAny,...bR(a)});class ch extends bS{constructor(){super(...arguments),this._unknown=!0}_parse(a){return bN(a.data)}}ch.create=a=>new ch({typeName:D.ZodUnknown,...bR(a)});class ci extends bS{_parse(a){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.never,received:b.parsedType}),bL}}ci.create=a=>new ci({typeName:D.ZodNever,...bR(a)});class cj extends bS{_parse(a){if(this._getType(a)!==bD.undefined){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.void,received:b.parsedType}),bL}return bN(a.data)}}cj.create=a=>new cj({typeName:D.ZodVoid,...bR(a)});class ck extends bS{_parse(a){let{ctx:b,status:c}=this._processInputParams(a),d=this._def;if(b.parsedType!==bD.array)return bJ(b,{code:bF.invalid_type,expected:bD.array,received:b.parsedType}),bL;if(null!==d.exactLength){let a=b.data.length>d.exactLength.value,e=b.data.length<d.exactLength.value;(a||e)&&(bJ(b,{code:a?bF.too_big:bF.too_small,minimum:e?d.exactLength.value:void 0,maximum:a?d.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:d.exactLength.message}),c.dirty())}if(null!==d.minLength&&b.data.length<d.minLength.value&&(bJ(b,{code:bF.too_small,minimum:d.minLength.value,type:"array",inclusive:!0,exact:!1,message:d.minLength.message}),c.dirty()),null!==d.maxLength&&b.data.length>d.maxLength.value&&(bJ(b,{code:bF.too_big,maximum:d.maxLength.value,type:"array",inclusive:!0,exact:!1,message:d.maxLength.message}),c.dirty()),b.common.async)return Promise.all([...b.data].map((a,c)=>d.type._parseAsync(new bP(b,a,b.path,c)))).then(a=>bK.mergeArray(c,a));let e=[...b.data].map((a,c)=>d.type._parseSync(new bP(b,a,b.path,c)));return bK.mergeArray(c,e)}get element(){return this._def.type}min(a,b){return new ck({...this._def,minLength:{value:a,message:C.toString(b)}})}max(a,b){return new ck({...this._def,maxLength:{value:a,message:C.toString(b)}})}length(a,b){return new ck({...this._def,exactLength:{value:a,message:C.toString(b)}})}nonempty(a){return this.min(1,a)}}ck.create=(a,b)=>new ck({type:a,minLength:null,maxLength:null,exactLength:null,typeName:D.ZodArray,...bR(b)});class cl extends bS{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let a=this._def.shape(),b=A.objectKeys(a);return this._cached={shape:a,keys:b},this._cached}_parse(a){if(this._getType(a)!==bD.object){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.object,received:b.parsedType}),bL}let{status:b,ctx:c}=this._processInputParams(a),{shape:d,keys:e}=this._getCached(),f=[];if(!(this._def.catchall instanceof ci&&"strip"===this._def.unknownKeys))for(let a in c.data)e.includes(a)||f.push(a);let g=[];for(let a of e){let b=d[a],e=c.data[a];g.push({key:{status:"valid",value:a},value:b._parse(new bP(c,e,c.path,a)),alwaysSet:a in c.data})}if(this._def.catchall instanceof ci){let a=this._def.unknownKeys;if("passthrough"===a)for(let a of f)g.push({key:{status:"valid",value:a},value:{status:"valid",value:c.data[a]}});else if("strict"===a)f.length>0&&(bJ(c,{code:bF.unrecognized_keys,keys:f}),b.dirty());else if("strip"===a);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let a=this._def.catchall;for(let b of f){let d=c.data[b];g.push({key:{status:"valid",value:b},value:a._parse(new bP(c,d,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{let a=[];for(let b of g){let c=await b.key,d=await b.value;a.push({key:c,value:d,alwaysSet:b.alwaysSet})}return a}).then(a=>bK.mergeObjectSync(b,a)):bK.mergeObjectSync(b,g)}get shape(){return this._def.shape()}strict(a){return C.errToObj,new cl({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(b,c)=>{let d=this._def.errorMap?.(b,c).message??c.defaultError;return"unrecognized_keys"===b.code?{message:C.errToObj(a).message??d}:{message:d}}}:{}})}strip(){return new cl({...this._def,unknownKeys:"strip"})}passthrough(){return new cl({...this._def,unknownKeys:"passthrough"})}extend(a){return new cl({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new cl({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:D.ZodObject})}setKey(a,b){return this.augment({[a]:b})}catchall(a){return new cl({...this._def,catchall:a})}pick(a){let b={};for(let c of A.objectKeys(a))a[c]&&this.shape[c]&&(b[c]=this.shape[c]);return new cl({...this._def,shape:()=>b})}omit(a){let b={};for(let c of A.objectKeys(this.shape))a[c]||(b[c]=this.shape[c]);return new cl({...this._def,shape:()=>b})}deepPartial(){return function a(b){if(b instanceof cl){let c={};for(let d in b.shape){let e=b.shape[d];c[d]=cC.create(a(e))}return new cl({...b._def,shape:()=>c})}if(b instanceof ck)return new ck({...b._def,type:a(b.element)});if(b instanceof cC)return cC.create(a(b.unwrap()));if(b instanceof cD)return cD.create(a(b.unwrap()));if(b instanceof cq)return cq.create(b.items.map(b=>a(b)));else return b}(this)}partial(a){let b={};for(let c of A.objectKeys(this.shape)){let d=this.shape[c];a&&!a[c]?b[c]=d:b[c]=d.optional()}return new cl({...this._def,shape:()=>b})}required(a){let b={};for(let c of A.objectKeys(this.shape))if(a&&!a[c])b[c]=this.shape[c];else{let a=this.shape[c];for(;a instanceof cC;)a=a._def.innerType;b[c]=a}return new cl({...this._def,shape:()=>b})}keyof(){return cx(A.objectKeys(this.shape))}}cl.create=(a,b)=>new cl({shape:()=>a,unknownKeys:"strip",catchall:ci.create(),typeName:D.ZodObject,...bR(b)}),cl.strictCreate=(a,b)=>new cl({shape:()=>a,unknownKeys:"strict",catchall:ci.create(),typeName:D.ZodObject,...bR(b)}),cl.lazycreate=(a,b)=>new cl({shape:a,unknownKeys:"strip",catchall:ci.create(),typeName:D.ZodObject,...bR(b)});class cm extends bS{_parse(a){let{ctx:b}=this._processInputParams(a),c=this._def.options;if(b.common.async)return Promise.all(c.map(async a=>{let c={...b,common:{...b.common,issues:[]},parent:null};return{result:await a._parseAsync({data:b.data,path:b.path,parent:c}),ctx:c}})).then(function(a){for(let b of a)if("valid"===b.result.status)return b.result;for(let c of a)if("dirty"===c.result.status)return b.common.issues.push(...c.ctx.common.issues),c.result;let c=a.map(a=>new bG(a.ctx.common.issues));return bJ(b,{code:bF.invalid_union,unionErrors:c}),bL});{let a,d=[];for(let e of c){let c={...b,common:{...b.common,issues:[]},parent:null},f=e._parseSync({data:b.data,path:b.path,parent:c});if("valid"===f.status)return f;"dirty"!==f.status||a||(a={result:f,ctx:c}),c.common.issues.length&&d.push(c.common.issues)}if(a)return b.common.issues.push(...a.ctx.common.issues),a.result;let e=d.map(a=>new bG(a));return bJ(b,{code:bF.invalid_union,unionErrors:e}),bL}}get options(){return this._def.options}}cm.create=(a,b)=>new cm({options:a,typeName:D.ZodUnion,...bR(b)});let cn=a=>{if(a instanceof cv)return cn(a.schema);if(a instanceof cB)return cn(a.innerType());if(a instanceof cw)return[a.value];if(a instanceof cy)return a.options;if(a instanceof cz)return A.objectValues(a.enum);else if(a instanceof cE)return cn(a._def.innerType);else if(a instanceof ce)return[void 0];else if(a instanceof cf)return[null];else if(a instanceof cC)return[void 0,...cn(a.unwrap())];else if(a instanceof cD)return[null,...cn(a.unwrap())];else if(a instanceof cH)return cn(a.unwrap());else if(a instanceof cJ)return cn(a.unwrap());else if(a instanceof cF)return cn(a._def.innerType);else return[]};class co extends bS{_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==bD.object)return bJ(b,{code:bF.invalid_type,expected:bD.object,received:b.parsedType}),bL;let c=this.discriminator,d=b.data[c],e=this.optionsMap.get(d);return e?b.common.async?e._parseAsync({data:b.data,path:b.path,parent:b}):e._parseSync({data:b.data,path:b.path,parent:b}):(bJ(b,{code:bF.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[c]}),bL)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,b,c){let d=new Map;for(let c of b){let b=cn(c.shape[a]);if(!b.length)throw Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(let e of b){if(d.has(e))throw Error(`Discriminator property ${String(a)} has duplicate value ${String(e)}`);d.set(e,c)}}return new co({typeName:D.ZodDiscriminatedUnion,discriminator:a,options:b,optionsMap:d,...bR(c)})}}class cp extends bS{_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=(a,d)=>{if("aborted"===a.status||"aborted"===d.status)return bL;let e=function a(b,c){let d=bE(b),e=bE(c);if(b===c)return{valid:!0,data:b};if(d===bD.object&&e===bD.object){let d=A.objectKeys(c),e=A.objectKeys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1};f[d]=e.data}return{valid:!0,data:f}}if(d===bD.array&&e===bD.array){if(b.length!==c.length)return{valid:!1};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1};d.push(f.data)}return{valid:!0,data:d}}if(d===bD.date&&e===bD.date&&+b==+c)return{valid:!0,data:b};return{valid:!1}}(a.value,d.value);return e.valid?(("dirty"===a.status||"dirty"===d.status)&&b.dirty(),{status:b.value,value:e.data}):(bJ(c,{code:bF.invalid_intersection_types}),bL)};return c.common.async?Promise.all([this._def.left._parseAsync({data:c.data,path:c.path,parent:c}),this._def.right._parseAsync({data:c.data,path:c.path,parent:c})]).then(([a,b])=>d(a,b)):d(this._def.left._parseSync({data:c.data,path:c.path,parent:c}),this._def.right._parseSync({data:c.data,path:c.path,parent:c}))}}cp.create=(a,b,c)=>new cp({left:a,right:b,typeName:D.ZodIntersection,...bR(c)});class cq extends bS{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==bD.array)return bJ(c,{code:bF.invalid_type,expected:bD.array,received:c.parsedType}),bL;if(c.data.length<this._def.items.length)return bJ(c,{code:bF.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),bL;!this._def.rest&&c.data.length>this._def.items.length&&(bJ(c,{code:bF.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());let d=[...c.data].map((a,b)=>{let d=this._def.items[b]||this._def.rest;return d?d._parse(new bP(c,a,c.path,b)):null}).filter(a=>!!a);return c.common.async?Promise.all(d).then(a=>bK.mergeArray(b,a)):bK.mergeArray(b,d)}get items(){return this._def.items}rest(a){return new cq({...this._def,rest:a})}}cq.create=(a,b)=>{if(!Array.isArray(a))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new cq({items:a,typeName:D.ZodTuple,rest:null,...bR(b)})};class cr extends bS{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==bD.object)return bJ(c,{code:bF.invalid_type,expected:bD.object,received:c.parsedType}),bL;let d=[],e=this._def.keyType,f=this._def.valueType;for(let a in c.data)d.push({key:e._parse(new bP(c,a,c.path,a)),value:f._parse(new bP(c,c.data[a],c.path,a)),alwaysSet:a in c.data});return c.common.async?bK.mergeObjectAsync(b,d):bK.mergeObjectSync(b,d)}get element(){return this._def.valueType}static create(a,b,c){return new cr(b instanceof bS?{keyType:a,valueType:b,typeName:D.ZodRecord,...bR(c)}:{keyType:b8.create(),valueType:a,typeName:D.ZodRecord,...bR(b)})}}class cs extends bS{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==bD.map)return bJ(c,{code:bF.invalid_type,expected:bD.map,received:c.parsedType}),bL;let d=this._def.keyType,e=this._def.valueType,f=[...c.data.entries()].map(([a,b],f)=>({key:d._parse(new bP(c,a,c.path,[f,"key"])),value:e._parse(new bP(c,b,c.path,[f,"value"]))}));if(c.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of f){let d=await c.key,e=await c.value;if("aborted"===d.status||"aborted"===e.status)return bL;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}})}{let a=new Map;for(let c of f){let d=c.key,e=c.value;if("aborted"===d.status||"aborted"===e.status)return bL;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}}}}cs.create=(a,b,c)=>new cs({valueType:b,keyType:a,typeName:D.ZodMap,...bR(c)});class ct extends bS{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==bD.set)return bJ(c,{code:bF.invalid_type,expected:bD.set,received:c.parsedType}),bL;let d=this._def;null!==d.minSize&&c.data.size<d.minSize.value&&(bJ(c,{code:bF.too_small,minimum:d.minSize.value,type:"set",inclusive:!0,exact:!1,message:d.minSize.message}),b.dirty()),null!==d.maxSize&&c.data.size>d.maxSize.value&&(bJ(c,{code:bF.too_big,maximum:d.maxSize.value,type:"set",inclusive:!0,exact:!1,message:d.maxSize.message}),b.dirty());let e=this._def.valueType;function f(a){let c=new Set;for(let d of a){if("aborted"===d.status)return bL;"dirty"===d.status&&b.dirty(),c.add(d.value)}return{status:b.value,value:c}}let g=[...c.data.values()].map((a,b)=>e._parse(new bP(c,a,c.path,b)));return c.common.async?Promise.all(g).then(a=>f(a)):f(g)}min(a,b){return new ct({...this._def,minSize:{value:a,message:C.toString(b)}})}max(a,b){return new ct({...this._def,maxSize:{value:a,message:C.toString(b)}})}size(a,b){return this.min(a,b).max(a,b)}nonempty(a){return this.min(1,a)}}ct.create=(a,b)=>new ct({valueType:a,minSize:null,maxSize:null,typeName:D.ZodSet,...bR(b)});class cu extends bS{constructor(){super(...arguments),this.validate=this.implement}_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==bD.function)return bJ(b,{code:bF.invalid_type,expected:bD.function,received:b.parsedType}),bL;function c(a,c){return bI({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,bH,bH].filter(a=>!!a),issueData:{code:bF.invalid_arguments,argumentsError:c}})}function d(a,c){return bI({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,bH,bH].filter(a=>!!a),issueData:{code:bF.invalid_return_type,returnTypeError:c}})}let e={errorMap:b.common.contextualErrorMap},f=b.data;if(this._def.returns instanceof cA){let a=this;return bN(async function(...b){let g=new bG([]),h=await a._def.args.parseAsync(b,e).catch(a=>{throw g.addIssue(c(b,a)),g}),i=await Reflect.apply(f,this,h);return await a._def.returns._def.type.parseAsync(i,e).catch(a=>{throw g.addIssue(d(i,a)),g})})}{let a=this;return bN(function(...b){let g=a._def.args.safeParse(b,e);if(!g.success)throw new bG([c(b,g.error)]);let h=Reflect.apply(f,this,g.data),i=a._def.returns.safeParse(h,e);if(!i.success)throw new bG([d(h,i.error)]);return i.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new cu({...this._def,args:cq.create(a).rest(ch.create())})}returns(a){return new cu({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,b,c){return new cu({args:a||cq.create([]).rest(ch.create()),returns:b||ch.create(),typeName:D.ZodFunction,...bR(c)})}}class cv extends bS{get schema(){return this._def.getter()}_parse(a){let{ctx:b}=this._processInputParams(a);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}cv.create=(a,b)=>new cv({getter:a,typeName:D.ZodLazy,...bR(b)});class cw extends bS{_parse(a){if(a.data!==this._def.value){let b=this._getOrReturnCtx(a);return bJ(b,{received:b.data,code:bF.invalid_literal,expected:this._def.value}),bL}return{status:"valid",value:a.data}}get value(){return this._def.value}}function cx(a,b){return new cy({values:a,typeName:D.ZodEnum,...bR(b)})}cw.create=(a,b)=>new cw({value:a,typeName:D.ZodLiteral,...bR(b)});class cy extends bS{_parse(a){if("string"!=typeof a.data){let b=this._getOrReturnCtx(a),c=this._def.values;return bJ(b,{expected:A.joinValues(c),received:b.parsedType,code:bF.invalid_type}),bL}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(a.data)){let b=this._getOrReturnCtx(a),c=this._def.values;return bJ(b,{received:b.data,code:bF.invalid_enum_value,options:c}),bL}return bN(a.data)}get options(){return this._def.values}get enum(){let a={};for(let b of this._def.values)a[b]=b;return a}get Values(){let a={};for(let b of this._def.values)a[b]=b;return a}get Enum(){let a={};for(let b of this._def.values)a[b]=b;return a}extract(a,b=this._def){return cy.create(a,{...this._def,...b})}exclude(a,b=this._def){return cy.create(this.options.filter(b=>!a.includes(b)),{...this._def,...b})}}cy.create=cx;class cz extends bS{_parse(a){let b=A.getValidEnumValues(this._def.values),c=this._getOrReturnCtx(a);if(c.parsedType!==bD.string&&c.parsedType!==bD.number){let a=A.objectValues(b);return bJ(c,{expected:A.joinValues(a),received:c.parsedType,code:bF.invalid_type}),bL}if(this._cache||(this._cache=new Set(A.getValidEnumValues(this._def.values))),!this._cache.has(a.data)){let a=A.objectValues(b);return bJ(c,{received:c.data,code:bF.invalid_enum_value,options:a}),bL}return bN(a.data)}get enum(){return this._def.values}}cz.create=(a,b)=>new cz({values:a,typeName:D.ZodNativeEnum,...bR(b)});class cA extends bS{unwrap(){return this._def.type}_parse(a){let{ctx:b}=this._processInputParams(a);return b.parsedType!==bD.promise&&!1===b.common.async?(bJ(b,{code:bF.invalid_type,expected:bD.promise,received:b.parsedType}),bL):bN((b.parsedType===bD.promise?b.data:Promise.resolve(b.data)).then(a=>this._def.type.parseAsync(a,{path:b.path,errorMap:b.common.contextualErrorMap})))}}cA.create=(a,b)=>new cA({type:a,typeName:D.ZodPromise,...bR(b)});class cB extends bS{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===D.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=this._def.effect||null,e={addIssue:a=>{bJ(c,a),a.fatal?b.abort():b.dirty()},get path(){return c.path}};if(e.addIssue=e.addIssue.bind(e),"preprocess"===d.type){let a=d.transform(c.data,e);if(c.common.async)return Promise.resolve(a).then(async a=>{if("aborted"===b.value)return bL;let d=await this._def.schema._parseAsync({data:a,path:c.path,parent:c});return"aborted"===d.status?bL:"dirty"===d.status||"dirty"===b.value?bM(d.value):d});{if("aborted"===b.value)return bL;let d=this._def.schema._parseSync({data:a,path:c.path,parent:c});return"aborted"===d.status?bL:"dirty"===d.status||"dirty"===b.value?bM(d.value):d}}if("refinement"===d.type){let a=a=>{let b=d.refinement(a,e);if(c.common.async)return Promise.resolve(b);if(b instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(c=>"aborted"===c.status?bL:("dirty"===c.status&&b.dirty(),a(c.value).then(()=>({status:b.value,value:c.value}))));{let d=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===d.status?bL:("dirty"===d.status&&b.dirty(),a(d.value),{status:b.value,value:d.value})}}if("transform"===d.type)if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(a=>"valid"!==a.status?bL:Promise.resolve(d.transform(a.value,e)).then(a=>({status:b.value,value:a})));else{let a=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});if("valid"!==a.status)return bL;let f=d.transform(a.value,e);if(f instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:f}}A.assertNever(d)}}cB.create=(a,b,c)=>new cB({schema:a,typeName:D.ZodEffects,effect:b,...bR(c)}),cB.createWithPreprocess=(a,b,c)=>new cB({schema:b,effect:{type:"preprocess",transform:a},typeName:D.ZodEffects,...bR(c)});class cC extends bS{_parse(a){return this._getType(a)===bD.undefined?bN(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}cC.create=(a,b)=>new cC({innerType:a,typeName:D.ZodOptional,...bR(b)});class cD extends bS{_parse(a){return this._getType(a)===bD.null?bN(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}cD.create=(a,b)=>new cD({innerType:a,typeName:D.ZodNullable,...bR(b)});class cE extends bS{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return b.parsedType===bD.undefined&&(c=this._def.defaultValue()),this._def.innerType._parse({data:c,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}cE.create=(a,b)=>new cE({innerType:a,typeName:D.ZodDefault,defaultValue:"function"==typeof b.default?b.default:()=>b.default,...bR(b)});class cF extends bS{_parse(a){let{ctx:b}=this._processInputParams(a),c={...b,common:{...b.common,issues:[]}},d=this._def.innerType._parse({data:c.data,path:c.path,parent:{...c}});return bO(d)?d.then(a=>({status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new bG(c.common.issues)},input:c.data})})):{status:"valid",value:"valid"===d.status?d.value:this._def.catchValue({get error(){return new bG(c.common.issues)},input:c.data})}}removeCatch(){return this._def.innerType}}cF.create=(a,b)=>new cF({innerType:a,typeName:D.ZodCatch,catchValue:"function"==typeof b.catch?b.catch:()=>b.catch,...bR(b)});class cG extends bS{_parse(a){if(this._getType(a)!==bD.nan){let b=this._getOrReturnCtx(a);return bJ(b,{code:bF.invalid_type,expected:bD.nan,received:b.parsedType}),bL}return{status:"valid",value:a.data}}}cG.create=a=>new cG({typeName:D.ZodNaN,...bR(a)}),Symbol("zod_brand");class cH extends bS{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return this._def.type._parse({data:c,path:b.path,parent:b})}unwrap(){return this._def.type}}class cI extends bS{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?bL:"dirty"===a.status?(b.dirty(),bM(a.value)):this._def.out._parseAsync({data:a.value,path:c.path,parent:c})})();{let a=this._def.in._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?bL:"dirty"===a.status?(b.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:c.path,parent:c})}}static create(a,b){return new cI({in:a,out:b,typeName:D.ZodPipeline})}}class cJ extends bS{_parse(a){let b=this._def.innerType._parse(a),c=a=>("valid"===a.status&&(a.value=Object.freeze(a.value)),a);return bO(b)?b.then(a=>c(a)):c(b)}unwrap(){return this._def.innerType}}cJ.create=(a,b)=>new cJ({innerType:a,typeName:D.ZodReadonly,...bR(b)}),cl.lazycreate,function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"}(D||(D={}));let cK=b8.create,cL=b9.create;cG.create,ca.create,cb.create,cc.create,cd.create,ce.create,cf.create,cg.create,ch.create,ci.create,cj.create;let cM=ck.create,cN=cl.create;cl.strictCreate;let cO=cm.create;co.create,cp.create,cq.create,cr.create,cs.create,ct.create,cu.create,cv.create,cw.create;let cP=cy.create;cz.create,cA.create,cB.create,cC.create,cD.create,cB.createWithPreprocess,cI.create;class cQ extends Error{constructor(a,b){super(a),this.name="ParseError",this.type=b.type,this.field=b.field,this.value=b.value,this.line=b.line}}function cR(a){}class cS extends TransformStream{constructor({onError:a,onRetry:b,onComment:c}={}){let d;super({start(e){d=function(a){if("function"==typeof a)throw TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");let{onEvent:b=cR,onError:c=cR,onRetry:d=cR,onComment:e}=a,f="",g=!0,h,i="",j="";function k(a){if(""===a)return void(i.length>0&&b({id:h,event:j||void 0,data:i.endsWith(`
`)?i.slice(0,-1):i}),h=void 0,i="",j="");if(a.startsWith(":")){e&&e(a.slice(a.startsWith(": ")?2:1));return}let c=a.indexOf(":");if(-1!==c){let b=a.slice(0,c),d=" "===a[c+1]?2:1;l(b,a.slice(c+d),a);return}l(a,"",a)}function l(a,b,e){switch(a){case"event":j=b;break;case"data":i=`${i}${b}
`;break;case"id":h=b.includes("\0")?void 0:b;break;case"retry":/^\d+$/.test(b)?d(parseInt(b,10)):c(new cQ(`Invalid \`retry\` value: "${b}"`,{type:"invalid-retry",value:b,line:e}));break;default:c(new cQ(`Unknown field "${a.length>20?`${a.slice(0,20)}\u2026`:a}"`,{type:"unknown-field",field:a,value:b,line:e}))}}return{feed:function(a){let b=g?a.replace(/^\xEF\xBB\xBF/,""):a,[c,d]=function(a){let b=[],c="",d=0;for(;d<a.length;){let e=a.indexOf("\r",d),f=a.indexOf(`
`,d),g=-1;if(-1!==e&&-1!==f?g=Math.min(e,f):-1!==e?g=e===a.length-1?-1:e:-1!==f&&(g=f),-1===g){c=a.slice(d);break}{let c=a.slice(d,g);b.push(c),"\r"===a[(d=g+1)-1]&&a[d]===`
`&&d++}}return[b,c]}(`${f}${b}`);for(let a of c)k(a);f=d,g=!1},reset:function(a={}){f&&a.consume&&k(f),g=!0,h=void 0,i="",j="",f=""}}}({onEvent:a=>{e.enqueue(a)},onError(b){"terminate"===a?e.error(b):"function"==typeof a&&a(b)},onRetry:b,onComment:c})},transform(a){d.feed(a)}})}}function cT(...a){return a.reduce((a,b)=>({...a,...null!=b?b:{}}),{})}async function cU(a,b){if(null==a)return Promise.resolve();let c=null==b?void 0:b.abortSignal;return new Promise((b,d)=>{if(null==c?void 0:c.aborted)return void d(cV());let e=setTimeout(()=>{f(),b()},a),f=()=>{clearTimeout(e),null==c||c.removeEventListener("abort",g)},g=()=>{f(),d(cV())};null==c||c.addEventListener("abort",g)})}function cV(){return new DOMException("Delay was aborted","AbortError")}function cW(a){return Object.fromEntries([...a.headers])}var{btoa:cX,atob:cY}=globalThis;function cZ(a){let b=cY(a.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(b,a=>a.codePointAt(0))}function c$(a){let b="";for(let c=0;c<a.length;c++)b+=String.fromCodePoint(a[c]);return cX(b)}function c_(a){return a instanceof Uint8Array?c$(a):a}var c0="AI_DownloadError",c1=`vercel.ai.error.${c0}`,c2=Symbol.for(c1),c3=class extends(F=ai,E=c2,F){constructor({url:a,statusCode:b,statusText:c,cause:d,message:e=null==d?`Failed to download ${a}: ${b} ${c}`:`Failed to download ${a}: ${d}`}){super({name:c0,message:e,cause:d}),this[E]=!0,this.url=a,this.statusCode=b,this.statusText=c}static isInstance(a){return ai.hasMarker(a,c1)}};async function c4({response:a,url:b,maxBytes:c=0x80000000}){let d=a.headers.get("content-length");if(null!=d){let a=parseInt(d,10);if(!isNaN(a)&&a>c)throw new c3({url:b,message:`Download of ${b} exceeded maximum size of ${c} bytes (Content-Length: ${a}).`})}let e=a.body;if(null==e)return new Uint8Array(0);let f=e.getReader(),g=[],h=0;try{for(;;){let{done:a,value:d}=await f.read();if(a)break;if((h+=d.length)>c)throw new c3({url:b,message:`Download of ${b} exceeded maximum size of ${c} bytes.`});g.push(d)}}finally{try{await f.cancel()}finally{f.releaseLock()}}let i=new Uint8Array(h),j=0;for(let a of g)i.set(a,j),j+=a.length;return i}async function c5(a,b){var c,d;try{let e=await fetch(a,{signal:null==b?void 0:b.abortSignal});if(!e.ok)throw new c3({url:a,statusCode:e.status,statusText:e.statusText});let f=await c4({response:e,url:a,maxBytes:null!=(c=null==b?void 0:b.maxBytes)?c:0x80000000}),g=null!=(d=e.headers.get("content-type"))?d:void 0;return new Blob([f],g?{type:g}:void 0)}catch(b){if(c3.isInstance(b))throw b;throw new c3({url:a,cause:b})}}var c6=({prefix:a,size:b=16,alphabet:c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:d="-"}={})=>{let e=()=>{let a=c.length,d=Array(b);for(let e=0;e<b;e++)d[e]=c[Math.random()*a|0];return d.join("")};if(null==a)return e;if(c.includes(d))throw new av({argument:"separator",message:`The separator "${d}" must not be part of the alphabet "${c}".`});return()=>`${a}${d}${e()}`},c7=c6();function c8(a){return null==a?"unknown error":"string"==typeof a?a:a instanceof Error?a.message:JSON.stringify(a)}function c9(a){return(a instanceof Error||a instanceof DOMException)&&("AbortError"===a.name||"ResponseAborted"===a.name||"TimeoutError"===a.name)}var da=["fetch failed","failed to fetch"],db=["ConnectionRefused","ConnectionClosed","FailedToOpenSocket","ECONNRESET","ECONNREFUSED","ETIMEDOUT","EPIPE"];function dc({error:a,url:b,requestBodyValues:c}){if(c9(a))return a;if(a instanceof TypeError&&da.includes(a.message.toLowerCase())){let d=a.cause;if(null!=d)return new am({message:`Cannot connect to API: ${d.message}`,cause:d,url:b,requestBodyValues:c,isRetryable:!0})}return!function(a){if(!(a instanceof Error))return!1;let b=a.code;return!!("string"==typeof b&&db.includes(b))}(a)?a:new am({message:`Cannot connect to API: ${a.message}`,cause:a,url:b,requestBodyValues:c,isRetryable:!0})}function dd(a=globalThis){var b,c,d;return a.window?"runtime/browser":(null==(b=a.navigator)?void 0:b.userAgent)?`runtime/${a.navigator.userAgent.toLowerCase()}`:(null==(d=null==(c=a.process)?void 0:c.versions)?void 0:d.node)?`runtime/node.js/${a.process.version.substring(0)}`:a.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}function de(a,...b){let c=new Headers(function(a){if(null==a)return{};let b={};if(a instanceof Headers)a.forEach((a,c)=>{b[c.toLowerCase()]=a});else for(let[c,d]of(Array.isArray(a)||(a=Object.entries(a)),a))null!=d&&(b[c.toLowerCase()]=d);return b}(a)),d=c.get("user-agent")||"";return c.set("user-agent",[d,...b].filter(Boolean).join(" ")),Object.fromEntries(c.entries())}var df="4.0.15",dg=()=>globalThis.fetch,dh=async({url:a,headers:b={},successfulResponseHandler:c,failedResponseHandler:d,abortSignal:e,fetch:f=dg()})=>{try{let g=await f(a,{method:"GET",headers:de(b,`ai-sdk/provider-utils/${df}`,dd()),signal:e}),h=cW(g);if(!g.ok){let b;try{b=await d({response:g,url:a,requestBodyValues:{}})}catch(b){if(c9(b)||am.isInstance(b))throw b;throw new am({message:"Failed to process error response",cause:b,statusCode:g.status,url:a,responseHeaders:h,requestBodyValues:{}})}throw b.value}try{return await c({response:g,url:a,requestBodyValues:{}})}catch(b){if(b instanceof Error&&(c9(b)||am.isInstance(b)))throw b;throw new am({message:"Failed to process successful response",cause:b,statusCode:g.status,url:a,responseHeaders:h,requestBodyValues:{}})}}catch(b){throw dc({error:b,url:a,requestBodyValues:{}})}};function di(a){return null!=a}function dj({settingValue:a,environmentVariableName:b}){return"string"==typeof a?a:null!=a||"undefined"==typeof process?void 0:null!=(a=process.env[b])&&"string"==typeof a?a:void 0}var dk=/"__proto__"\s*:/,dl=/"constructor"\s*:/;function dm(a){let b=JSON.parse(a);return null===b||"object"!=typeof b||!1===dk.test(a)&&!1===dl.test(a)?b:function(a){let b=[a];for(;b.length;){let a=b;for(let c of(b=[],a)){if(Object.prototype.hasOwnProperty.call(c,"__proto__")||Object.prototype.hasOwnProperty.call(c,"constructor")&&Object.prototype.hasOwnProperty.call(c.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let a in c){let d=c[a];d&&"object"==typeof d&&b.push(d)}}}return a}(b)}function dn(a){let{stackTraceLimit:b}=Error;try{Error.stackTraceLimit=0}catch(b){return dm(a)}try{return dm(a)}finally{Error.stackTraceLimit=b}}function dp(a){if("object"===a.type||Array.isArray(a.type)&&a.type.includes("object")){a.additionalProperties=!1;let{properties:b}=a;if(null!=b)for(let a of Object.keys(b))b[a]=dq(b[a])}null!=a.items&&(a.items=Array.isArray(a.items)?a.items.map(dq):dq(a.items)),null!=a.anyOf&&(a.anyOf=a.anyOf.map(dq)),null!=a.allOf&&(a.allOf=a.allOf.map(dq)),null!=a.oneOf&&(a.oneOf=a.oneOf.map(dq));let{definitions:b}=a;if(null!=b)for(let a of Object.keys(b))b[a]=dq(b[a]);return a}function dq(a){return"boolean"==typeof a?a:dp(a)}var dr=Symbol("Let zodToJsonSchema decide on which parser to use"),ds={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function dt(a,b){return dE(a.type._def,b)}var du=void 0,dv={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===du&&(du=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),du),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function dw(a,b){let c={type:"string"};if(a.checks)for(let d of a.checks)switch(d.kind){case"min":c.minLength="number"==typeof c.minLength?Math.max(c.minLength,d.value):d.value;break;case"max":c.maxLength="number"==typeof c.maxLength?Math.min(c.maxLength,d.value):d.value;break;case"email":switch(b.emailStrategy){case"format:email":dz(c,"email",d.message,b);break;case"format:idn-email":dz(c,"idn-email",d.message,b);break;case"pattern:zod":dA(c,dv.email,d.message,b)}break;case"url":dz(c,"uri",d.message,b);break;case"uuid":dz(c,"uuid",d.message,b);break;case"regex":dA(c,d.regex,d.message,b);break;case"cuid":dA(c,dv.cuid,d.message,b);break;case"cuid2":dA(c,dv.cuid2,d.message,b);break;case"startsWith":dA(c,RegExp(`^${dx(d.value,b)}`),d.message,b);break;case"endsWith":dA(c,RegExp(`${dx(d.value,b)}$`),d.message,b);break;case"datetime":dz(c,"date-time",d.message,b);break;case"date":dz(c,"date",d.message,b);break;case"time":dz(c,"time",d.message,b);break;case"duration":dz(c,"duration",d.message,b);break;case"length":c.minLength="number"==typeof c.minLength?Math.max(c.minLength,d.value):d.value,c.maxLength="number"==typeof c.maxLength?Math.min(c.maxLength,d.value):d.value;break;case"includes":dA(c,RegExp(dx(d.value,b)),d.message,b);break;case"ip":"v6"!==d.version&&dz(c,"ipv4",d.message,b),"v4"!==d.version&&dz(c,"ipv6",d.message,b);break;case"base64url":dA(c,dv.base64url,d.message,b);break;case"jwt":dA(c,dv.jwt,d.message,b);break;case"cidr":"v6"!==d.version&&dA(c,dv.ipv4Cidr,d.message,b),"v4"!==d.version&&dA(c,dv.ipv6Cidr,d.message,b);break;case"emoji":dA(c,dv.emoji(),d.message,b);break;case"ulid":dA(c,dv.ulid,d.message,b);break;case"base64":switch(b.base64Strategy){case"format:binary":dz(c,"binary",d.message,b);break;case"contentEncoding:base64":c.contentEncoding="base64";break;case"pattern:zod":dA(c,dv.base64,d.message,b)}break;case"nanoid":dA(c,dv.nanoid,d.message,b)}return c}function dx(a,b){return"escape"===b.patternStrategy?function(a){let b="";for(let c=0;c<a.length;c++)dy.has(a[c])||(b+="\\"),b+=a[c];return b}(a):a}var dy=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function dz(a,b,c,d){var e;a.format||(null==(e=a.anyOf)?void 0:e.some(a=>a.format))?(a.anyOf||(a.anyOf=[]),a.format&&(a.anyOf.push({format:a.format}),delete a.format),a.anyOf.push({format:b,...c&&d.errorMessages&&{errorMessage:{format:c}}})):a.format=b}function dA(a,b,c,d){var e;a.pattern||(null==(e=a.allOf)?void 0:e.some(a=>a.pattern))?(a.allOf||(a.allOf=[]),a.pattern&&(a.allOf.push({pattern:a.pattern}),delete a.pattern),a.allOf.push({pattern:dB(b,d),...c&&d.errorMessages&&{errorMessage:{pattern:c}}})):a.pattern=dB(b,d)}function dB(a,b){var c;if(!b.applyRegexFlags||!a.flags)return a.source;let d={i:a.flags.includes("i"),m:a.flags.includes("m"),s:a.flags.includes("s")},e=d.i?a.source.toLowerCase():a.source,f="",g=!1,h=!1,i=!1;for(let a=0;a<e.length;a++){if(g){f+=e[a],g=!1;continue}if(d.i){if(h){if(e[a].match(/[a-z]/)){i?(f+=e[a],f+=`${e[a-2]}-${e[a]}`.toUpperCase(),i=!1):"-"===e[a+1]&&(null==(c=e[a+2])?void 0:c.match(/[a-z]/))?(f+=e[a],i=!0):f+=`${e[a]}${e[a].toUpperCase()}`;continue}}else if(e[a].match(/[a-z]/)){f+=`[${e[a]}${e[a].toUpperCase()}]`;continue}}if(d.m){if("^"===e[a]){f+=`(^|(?<=[\r
]))`;continue}else if("$"===e[a]){f+=`($|(?=[\r
]))`;continue}}if(d.s&&"."===e[a]){f+=h?`${e[a]}\r
`:`[${e[a]}\r
]`;continue}f+=e[a],"\\"===e[a]?g=!0:h&&"]"===e[a]?h=!1:h||"["!==e[a]||(h=!0)}try{new RegExp(f)}catch(c){return console.warn(`Could not convert regex pattern at ${b.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),a.source}return f}function dC(a,b){var c,d,e,f,g,h;let i={type:"object",additionalProperties:null!=(c=dE(a.valueType._def,{...b,currentPath:[...b.currentPath,"additionalProperties"]}))?c:b.allowedAdditionalProperties};if((null==(d=a.keyType)?void 0:d._def.typeName)===D.ZodString&&(null==(e=a.keyType._def.checks)?void 0:e.length)){let{type:c,...d}=dw(a.keyType._def,b);return{...i,propertyNames:d}}if((null==(f=a.keyType)?void 0:f._def.typeName)===D.ZodEnum)return{...i,propertyNames:{enum:a.keyType._def.values}};if((null==(g=a.keyType)?void 0:g._def.typeName)===D.ZodBranded&&a.keyType._def.type._def.typeName===D.ZodString&&(null==(h=a.keyType._def.type._def.checks)?void 0:h.length)){let{type:c,...d}=dt(a.keyType._def,b);return{...i,propertyNames:d}}return i}var dD={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function dE(a,b,c=!1){var d;let e=b.seen.get(a);if(b.override){let f=null==(d=b.override)?void 0:d.call(b,a,b,e,c);if(f!==dr)return f}if(e&&!c){let a=dF(e,b);if(void 0!==a)return a}let f={def:a,path:b.currentPath,jsonSchema:void 0};b.seen.set(a,f);let g=((a,b,c)=>{switch(b){case D.ZodString:return dw(a,c);case D.ZodNumber:var d,e,f,g,h,i,j=a;let k={type:"number"};if(!j.checks)return k;for(let a of j.checks)switch(a.kind){case"int":k.type="integer";break;case"min":a.inclusive?k.minimum=a.value:k.exclusiveMinimum=a.value;break;case"max":a.inclusive?k.maximum=a.value:k.exclusiveMaximum=a.value;break;case"multipleOf":k.multipleOf=a.value}return k;case D.ZodObject:return function(a,b){let c={type:"object",properties:{}},d=[],e=a.shape();for(let a in e){let f=e[a];if(void 0===f||void 0===f._def)continue;let g=function(a){try{return a.isOptional()}catch(a){return!0}}(f),h=dE(f._def,{...b,currentPath:[...b.currentPath,"properties",a],propertyPath:[...b.currentPath,"properties",a]});void 0!==h&&(c.properties[a]=h,g||d.push(a))}d.length&&(c.required=d);let f=function(a,b){if("ZodNever"!==a.catchall._def.typeName)return dE(a.catchall._def,{...b,currentPath:[...b.currentPath,"additionalProperties"]});switch(a.unknownKeys){case"passthrough":return b.allowedAdditionalProperties;case"strict":return b.rejectedAdditionalProperties;case"strip":return"strict"===b.removeAdditionalStrategy?b.allowedAdditionalProperties:b.rejectedAdditionalProperties}}(a,b);return void 0!==f&&(c.additionalProperties=f),c}(a,c);case D.ZodBigInt:var l=a;let m={type:"integer",format:"int64"};if(!l.checks)return m;for(let a of l.checks)switch(a.kind){case"min":a.inclusive?m.minimum=a.value:m.exclusiveMinimum=a.value;break;case"max":a.inclusive?m.maximum=a.value:m.exclusiveMaximum=a.value;break;case"multipleOf":m.multipleOf=a.value}return m;case D.ZodBoolean:return{type:"boolean"};case D.ZodDate:return function a(b,c,d){let e=null!=d?d:c.dateStrategy;if(Array.isArray(e))return{anyOf:e.map((d,e)=>a(b,c,d))};switch(e){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":var f=b;let g={type:"integer",format:"unix-time"};for(let a of f.checks)switch(a.kind){case"min":g.minimum=a.value;break;case"max":g.maximum=a.value}return g}}(a,c);case D.ZodUndefined:return{not:{}};case D.ZodNull:return{type:"null"};case D.ZodArray:var n,o,p,q=a,r=c;let s={type:"array"};return(null==(n=q.type)?void 0:n._def)&&(null==(p=null==(o=q.type)?void 0:o._def)?void 0:p.typeName)!==D.ZodAny&&(s.items=dE(q.type._def,{...r,currentPath:[...r.currentPath,"items"]})),q.minLength&&(s.minItems=q.minLength.value),q.maxLength&&(s.maxItems=q.maxLength.value),q.exactLength&&(s.minItems=q.exactLength.value,s.maxItems=q.exactLength.value),s;case D.ZodUnion:case D.ZodDiscriminatedUnion:return function(a,b){let c=a.options instanceof Map?Array.from(a.options.values()):a.options;if(c.every(a=>a._def.typeName in dD&&(!a._def.checks||!a._def.checks.length))){let a=c.reduce((a,b)=>{let c=dD[b._def.typeName];return c&&!a.includes(c)?[...a,c]:a},[]);return{type:a.length>1?a:a[0]}}if(c.every(a=>"ZodLiteral"===a._def.typeName&&!a.description)){let a=c.reduce((a,b)=>{let c=typeof b._def.value;switch(c){case"string":case"number":case"boolean":return[...a,c];case"bigint":return[...a,"integer"];case"object":if(null===b._def.value)return[...a,"null"];default:return a}},[]);if(a.length===c.length){let b=a.filter((a,b,c)=>c.indexOf(a)===b);return{type:b.length>1?b:b[0],enum:c.reduce((a,b)=>a.includes(b._def.value)?a:[...a,b._def.value],[])}}}else if(c.every(a=>"ZodEnum"===a._def.typeName))return{type:"string",enum:c.reduce((a,b)=>[...a,...b._def.values.filter(b=>!a.includes(b))],[])};var d=a,e=b;let f=(d.options instanceof Map?Array.from(d.options.values()):d.options).map((a,b)=>dE(a._def,{...e,currentPath:[...e.currentPath,"anyOf",`${b}`]})).filter(a=>!!a&&(!e.strictUnions||"object"==typeof a&&Object.keys(a).length>0));return f.length?{anyOf:f}:void 0}(a,c);case D.ZodIntersection:var t=a,u=c;let v=[dE(t.left._def,{...u,currentPath:[...u.currentPath,"allOf","0"]}),dE(t.right._def,{...u,currentPath:[...u.currentPath,"allOf","1"]})].filter(a=>!!a),w=[];return v.forEach(a=>{if((!("type"in a)||"string"!==a.type)&&"allOf"in a)w.push(...a.allOf);else{let b=a;if("additionalProperties"in a&&!1===a.additionalProperties){let{additionalProperties:c,...d}=a;b=d}w.push(b)}}),w.length?{allOf:w}:void 0;case D.ZodTuple:return H=a,I=c,H.rest?{type:"array",minItems:H.items.length,items:H.items.map((a,b)=>dE(a._def,{...I,currentPath:[...I.currentPath,"items",`${b}`]})).reduce((a,b)=>void 0===b?a:[...a,b],[]),additionalItems:dE(H.rest._def,{...I,currentPath:[...I.currentPath,"additionalItems"]})}:{type:"array",minItems:H.items.length,maxItems:H.items.length,items:H.items.map((a,b)=>dE(a._def,{...I,currentPath:[...I.currentPath,"items",`${b}`]})).reduce((a,b)=>void 0===b?a:[...a,b],[])};case D.ZodRecord:return dC(a,c);case D.ZodLiteral:var x=a;let y=typeof x.value;return"bigint"!==y&&"number"!==y&&"boolean"!==y&&"string"!==y?{type:Array.isArray(x.value)?"array":"object"}:{type:"bigint"===y?"integer":y,const:x.value};case D.ZodEnum:return{type:"string",enum:Array.from(a.values)};case D.ZodNativeEnum:var z=a;let A=z.values,B=Object.keys(z.values).filter(a=>"number"!=typeof A[A[a]]).map(a=>A[a]),C=Array.from(new Set(B.map(a=>typeof a)));return{type:1===C.length?"string"===C[0]?"string":"number":["string","number"],enum:B};case D.ZodNullable:var E=a,F=c;if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(E.innerType._def.typeName)&&(!E.innerType._def.checks||!E.innerType._def.checks.length))return{type:[dD[E.innerType._def.typeName],"null"]};let G=dE(E.innerType._def,{...F,currentPath:[...F.currentPath,"anyOf","0"]});return G&&{anyOf:[G,{type:"null"}]};case D.ZodOptional:var H,I,J,K=a,L=c;if(L.currentPath.toString()===(null==(J=L.propertyPath)?void 0:J.toString()))return dE(K.innerType._def,L);let M=dE(K.innerType._def,{...L,currentPath:[...L.currentPath,"anyOf","1"]});return M?{anyOf:[{not:{}},M]}:{};case D.ZodMap:return d=a,"record"===(e=c).mapStrategy?dC(d,e):{type:"array",maxItems:125,items:{type:"array",items:[dE(d.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},dE(d.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}};case D.ZodSet:var N=a,O=c;let P={type:"array",uniqueItems:!0,items:dE(N.valueType._def,{...O,currentPath:[...O.currentPath,"items"]})};return N.minSize&&(P.minItems=N.minSize.value),N.maxSize&&(P.maxItems=N.maxSize.value),P;case D.ZodLazy:return()=>a.getter()._def;case D.ZodPromise:return dE(a.type._def,c);case D.ZodNaN:case D.ZodNever:return{not:{}};case D.ZodEffects:return f=a,"input"===(g=c).effectStrategy?dE(f.schema._def,g):{};case D.ZodAny:case D.ZodUnknown:return{};case D.ZodDefault:return h=a,i=c,{...dE(h.innerType._def,i),default:h.defaultValue()};case D.ZodBranded:return dt(a,c);case D.ZodReadonly:case D.ZodCatch:return dE(a.innerType._def,c);case D.ZodPipeline:var Q=a,R=c;if("input"===R.pipeStrategy)return dE(Q.in._def,R);if("output"===R.pipeStrategy)return dE(Q.out._def,R);let S=dE(Q.in._def,{...R,currentPath:[...R.currentPath,"allOf","0"]}),T=dE(Q.out._def,{...R,currentPath:[...R.currentPath,"allOf",S?"1":"0"]});return{allOf:[S,T].filter(a=>void 0!==a)};case D.ZodFunction:case D.ZodVoid:case D.ZodSymbol:default:return}})(a,a.typeName,b),h="function"==typeof g?dE(g(),b):g;if(h&&dG(a,b,h),b.postProcess){let c=b.postProcess(h,a,b);return f.jsonSchema=h,c}return f.jsonSchema=h,h}var dF=(a,b)=>{switch(b.$refStrategy){case"root":return{$ref:a.path.join("/")};case"relative":return{$ref:((a,b)=>{let c=0;for(;c<a.length&&c<b.length&&a[c]===b[c];c++);return[(a.length-c).toString(),...b.slice(c)].join("/")})(b.currentPath,a.path)};case"none":case"seen":if(a.path.length<b.currentPath.length&&a.path.every((a,c)=>b.currentPath[c]===a))return console.warn(`Recursive reference detected at ${b.currentPath.join("/")}! Defaulting to any`),{};return"seen"===b.$refStrategy?{}:void 0}},dG=(a,b,c)=>(a.description&&(c.description=a.description),c),dH=Symbol.for("vercel.ai.schema");function dI(a){let b;return()=>(null==b&&(b=a()),b)}function dJ(a,{validate:b}={}){return{[dH]:!0,_type:void 0,get jsonSchema(){return"function"==typeof a&&(a=a()),a},validate:b}}function dK(a){var b;return null==a?dJ({properties:{},additionalProperties:!1}):"object"==typeof a&&null!==a&&dH in a&&!0===a[dH]&&"jsonSchema"in a&&"validate"in a?a:"~standard"in a?"zod"===a["~standard"].vendor?dL(a):(b=a,dJ(()=>dp(b["~standard"].jsonSchema.input({target:"draft-07"})),{validate:async a=>{let c=await b["~standard"].validate(a);return"value"in c?{success:!0,value:c.value}:{success:!1,error:new aU({value:a,cause:c.issues})}}})):a()}function dL(a,b){var c,d;if("_zod"in a){let d=null!=(c=null==b?void 0:b.useReferences)&&c;return dJ(()=>dp(function(a,b){if(a instanceof aZ){let c=new bl(b),d={};for(let b of a._idmap.entries()){let[a,d]=b;c.process(d)}let e={},f={registry:a,uri:b?.uri,defs:d};for(let d of a._idmap.entries()){let[a,g]=d;e[a]=c.emit(g,{...b,external:f})}return Object.keys(d).length>0&&(e.__shared={["draft-2020-12"===c.target?"$defs":"definitions"]:d}),{schemas:e}}let c=new bl(b);return c.process(a),c.emit(a,b)}(a,{target:"draft-7",io:"input",reused:d?"ref":"inline"})),{validate:async b=>{let c=await bC(a,b);return c.success?{success:!0,value:c.data}:{success:!1,error:c.error}}})}let e=null!=(d=null==b?void 0:b.useReferences)&&d;return dJ(()=>((a,b)=>{var c;let d=(a=>{let b,c="string"==typeof(b=a)?{...ds,name:b}:{...ds,...b},d=void 0!==c.name?[...c.basePath,c.definitionPath,c.name]:c.basePath;return{...c,currentPath:d,propertyPath:void 0,seen:new Map(Object.entries(c.definitions).map(([a,b])=>[b._def,{def:b._def,path:[...c.basePath,c.definitionPath,a],jsonSchema:void 0}]))}})(b),e="object"==typeof b&&b.definitions?Object.entries(b.definitions).reduce((a,[b,c])=>{var e;return{...a,[b]:null!=(e=dE(c._def,{...d,currentPath:[...d.basePath,d.definitionPath,b]},!0))?e:{}}},{}):void 0,f="string"==typeof b?b:(null==b?void 0:b.nameStrategy)==="title"||null==b?void 0:b.name,g=null!=(c=dE(a._def,void 0===f?d:{...d,currentPath:[...d.basePath,d.definitionPath,f]},!1))?c:{},h="object"==typeof b&&void 0!==b.name&&"title"===b.nameStrategy?b.name:void 0;void 0!==h&&(g.title=h);let i=void 0===f?e?{...g,[d.definitionPath]:e}:g:{$ref:[..."relative"===d.$refStrategy?[]:d.basePath,d.definitionPath,f].join("/"),[d.definitionPath]:{...e,[f]:g}};return i.$schema="http://json-schema.org/draft-07/schema#",i})(a,{$refStrategy:e?"root":"none"}),{validate:async b=>{let c=await a.safeParseAsync(b);return c.success?{success:!0,value:c.data}:{success:!1,error:c.error}}})}async function dM({value:a,schema:b,context:c}){let d=await dN({value:a,schema:b,context:c});if(!d.success)throw aU.wrap({value:a,cause:d.error,context:c});return d.value}async function dN({value:a,schema:b,context:c}){let d=dK(b);try{if(null==d.validate)return{success:!0,value:a,rawValue:a};let b=await d.validate(a);if(b.success)return{success:!0,value:b.value,rawValue:a};return{success:!1,error:aU.wrap({value:a,cause:b.error,context:c}),rawValue:a}}catch(b){return{success:!1,error:aU.wrap({value:a,cause:b,context:c}),rawValue:a}}}async function dO({text:a,schema:b}){try{let c=dn(a);if(null==b)return c;return dM({value:c,schema:b})}catch(b){if(aH.isInstance(b)||aU.isInstance(b))throw b;throw new aH({text:a,cause:b})}}async function dP({text:a,schema:b}){try{let c=dn(a);if(null==b)return{success:!0,value:c,rawValue:c};return await dN({value:c,schema:b})}catch(b){return{success:!1,error:aH.isInstance(b)?b:new aH({text:a,cause:b}),rawValue:void 0}}}function dQ(a){try{return dn(a),!0}catch(a){return!1}}async function dR({provider:a,providerOptions:b,schema:c}){if((null==b?void 0:b[a])==null)return;let d=await dN({value:b[a],schema:c});if(!d.success)throw new av({argument:"providerOptions",message:`invalid ${a} provider options`,cause:d.error});return d.value}var dS=()=>globalThis.fetch,dT=async({url:a,headers:b,body:c,failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g})=>dV({url:a,headers:{"Content-Type":"application/json",...b},body:{content:JSON.stringify(c),values:c},failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g}),dU=async({url:a,headers:b,formData:c,failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g})=>dV({url:a,headers:b,body:{content:c,values:Object.fromEntries(c.entries())},failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g}),dV=async({url:a,headers:b={},body:c,successfulResponseHandler:d,failedResponseHandler:e,abortSignal:f,fetch:g=dS()})=>{try{let h=await g(a,{method:"POST",headers:de(b,`ai-sdk/provider-utils/${df}`,dd()),body:c.content,signal:f}),i=cW(h);if(!h.ok){let b;try{b=await e({response:h,url:a,requestBodyValues:c.values})}catch(b){if(c9(b)||am.isInstance(b))throw b;throw new am({message:"Failed to process error response",cause:b,statusCode:h.status,url:a,responseHeaders:i,requestBodyValues:c.values})}throw b.value}try{return await d({response:h,url:a,requestBodyValues:c.values})}catch(b){if(b instanceof Error&&(c9(b)||am.isInstance(b)))throw b;throw new am({message:"Failed to process successful response",cause:b,statusCode:h.status,url:a,responseHeaders:i,requestBodyValues:c.values})}}catch(b){throw dc({error:b,url:a,requestBodyValues:c.values})}};function dW({id:a,inputSchema:b,outputSchema:c,supportsDeferredResults:d}){return({execute:e,needsApproval:f,toModelOutput:g,onInputStart:h,onInputDelta:i,onInputAvailable:j,...k})=>({type:"provider",id:a,args:k,inputSchema:b,outputSchema:c,execute:e,needsApproval:f,toModelOutput:g,onInputStart:h,onInputDelta:i,onInputAvailable:j,supportsDeferredResults:d})}async function dX(a){return"function"==typeof a&&(a=a()),Promise.resolve(a)}var dY=({errorSchema:a,errorToMessage:b,isRetryable:c})=>async({response:d,url:e,requestBodyValues:f})=>{let g=await d.text(),h=cW(d);if(""===g.trim())return{responseHeaders:h,value:new am({message:d.statusText,url:e,requestBodyValues:f,statusCode:d.status,responseHeaders:h,responseBody:g,isRetryable:null==c?void 0:c(d)})};try{let i=await dO({text:g,schema:a});return{responseHeaders:h,value:new am({message:b(i),url:e,requestBodyValues:f,statusCode:d.status,responseHeaders:h,responseBody:g,data:i,isRetryable:null==c?void 0:c(d,i)})}}catch(a){return{responseHeaders:h,value:new am({message:d.statusText,url:e,requestBodyValues:f,statusCode:d.status,responseHeaders:h,responseBody:g,isRetryable:null==c?void 0:c(d)})}}},dZ=a=>async({response:b})=>{let c=cW(b);if(null==b.body)throw new aq({});return{responseHeaders:c,value:function({stream:a,schema:b}){return a.pipeThrough(new TextDecoderStream).pipeThrough(new cS).pipeThrough(new TransformStream({async transform({data:a},c){"[DONE]"!==a&&c.enqueue(await dP({text:a,schema:b}))}}))}({stream:b.body,schema:a})}},d$=a=>async({response:b,url:c,requestBodyValues:d})=>{let e=await b.text(),f=await dP({text:e,schema:a}),g=cW(b);if(!f.success)throw new am({message:"Invalid JSON response",cause:f.error,statusCode:b.status,responseHeaders:g,responseBody:e,url:c,requestBodyValues:d});return{responseHeaders:g,value:f.value,rawValue:f.rawValue}};function d_(a){return null==a?void 0:a.replace(/\/$/,"")}async function*d0({execute:a,input:b,options:c}){let d=a(b,c);if(null!=d&&"function"==typeof d[Symbol.asyncIterator]){let a;for await(let b of d)a=b,yield{type:"preliminary",output:b};yield{type:"final",output:a}}else yield{type:"final",output:await d}}let d1=/^[cC][^\s-]{8,}$/,d2=/^[0-9a-z]+$/,d3=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,d4=/^[0-9a-vA-V]{20}$/,d5=/^[A-Za-z0-9]{27}$/,d6=/^[a-zA-Z0-9_-]{21}$/,d7=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,d8=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,d9=a=>a?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${a}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,ea=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,eb=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ec=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,ed=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,ee=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ef=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,eg=/^[A-Za-z0-9_-]*$/,eh=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,ei=/^\+(?:[0-9]){6,14}[0-9]$/,ej="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",ek=RegExp(`^${ej}$`);function el(a){let b="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof a.precision?-1===a.precision?`${b}`:0===a.precision?`${b}:[0-5]\\d`:`${b}:[0-5]\\d\\.\\d{${a.precision}}`:`${b}(?::[0-5]\\d(?:\\.\\d+)?)?`}let em=/^\d+$/,en=/^-?\d+(?:\.\d+)?/i,eo=/true|false/i,ep=/null/i,eq=/^[^A-Z]*$/,er=/^[^a-z]*$/,es=bm("$ZodCheck",(a,b)=>{var c;a._zod??(a._zod={}),a._zod.def=b,(c=a._zod).onattach??(c.onattach=[])}),et={number:"number",bigint:"bigint",object:"date"},eu=bm("$ZodCheckLessThan",(a,b)=>{es.init(a,b);let c=et[typeof b.value];a._zod.onattach.push(a=>{let c=a._zod.bag,d=(b.inclusive?c.maximum:c.exclusiveMaximum)??1/0;b.value<d&&(b.inclusive?c.maximum=b.value:c.exclusiveMaximum=b.value)}),a._zod.check=d=>{(b.inclusive?d.value<=b.value:d.value<b.value)||d.issues.push({origin:c,code:"too_big",maximum:b.value,input:d.value,inclusive:b.inclusive,inst:a,continue:!b.abort})}}),ev=bm("$ZodCheckGreaterThan",(a,b)=>{es.init(a,b);let c=et[typeof b.value];a._zod.onattach.push(a=>{let c=a._zod.bag,d=(b.inclusive?c.minimum:c.exclusiveMinimum)??-1/0;b.value>d&&(b.inclusive?c.minimum=b.value:c.exclusiveMinimum=b.value)}),a._zod.check=d=>{(b.inclusive?d.value>=b.value:d.value>b.value)||d.issues.push({origin:c,code:"too_small",minimum:b.value,input:d.value,inclusive:b.inclusive,inst:a,continue:!b.abort})}}),ew=bm("$ZodCheckMultipleOf",(a,b)=>{es.init(a,b),a._zod.onattach.push(a=>{var c;(c=a._zod.bag).multipleOf??(c.multipleOf=b.value)}),a._zod.check=c=>{if(typeof c.value!=typeof b.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof c.value?c.value%b.value===BigInt(0):0===function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}(c.value,b.value))||c.issues.push({origin:typeof c.value,code:"not_multiple_of",divisor:b.value,input:c.value,inst:a,continue:!b.abort})}}),ex=bm("$ZodCheckNumberFormat",(a,b)=>{es.init(a,b),b.format=b.format||"float64";let c=b.format?.includes("int"),d=c?"int":"number",[e,f]=be[b.format];a._zod.onattach.push(a=>{let d=a._zod.bag;d.format=b.format,d.minimum=e,d.maximum=f,c&&(d.pattern=em)}),a._zod.check=g=>{let h=g.value;if(c){if(!Number.isInteger(h))return void g.issues.push({expected:d,format:b.format,code:"invalid_type",input:h,inst:a});if(!Number.isSafeInteger(h))return void(h>0?g.issues.push({input:h,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:a,origin:d,continue:!b.abort}):g.issues.push({input:h,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:a,origin:d,continue:!b.abort}))}h<e&&g.issues.push({origin:"number",input:h,code:"too_small",minimum:e,inclusive:!0,inst:a,continue:!b.abort}),h>f&&g.issues.push({origin:"number",input:h,code:"too_big",maximum:f,inst:a})}}),ey=bm("$ZodCheckMaxLength",(a,b)=>{var c;es.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return null!=b&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag.maximum??1/0;b.maximum<c&&(a._zod.bag.maximum=b.maximum)}),a._zod.check=c=>{let d=c.value;if(d.length<=b.maximum)return;let e=bj(d);c.issues.push({origin:e,code:"too_big",maximum:b.maximum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),ez=bm("$ZodCheckMinLength",(a,b)=>{var c;es.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return null!=b&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag.minimum??-1/0;b.minimum>c&&(a._zod.bag.minimum=b.minimum)}),a._zod.check=c=>{let d=c.value;if(d.length>=b.minimum)return;let e=bj(d);c.issues.push({origin:e,code:"too_small",minimum:b.minimum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),eA=bm("$ZodCheckLengthEquals",(a,b)=>{var c;es.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return null!=b&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag;c.minimum=b.length,c.maximum=b.length,c.length=b.length}),a._zod.check=c=>{let d=c.value,e=d.length;if(e===b.length)return;let f=bj(d),g=e>b.length;c.issues.push({origin:f,...g?{code:"too_big",maximum:b.length}:{code:"too_small",minimum:b.length},inclusive:!0,exact:!0,input:c.value,inst:a,continue:!b.abort})}}),eB=bm("$ZodCheckStringFormat",(a,b)=>{var c,d;es.init(a,b),a._zod.onattach.push(a=>{let c=a._zod.bag;c.format=b.format,b.pattern&&(c.patterns??(c.patterns=new Set),c.patterns.add(b.pattern))}),b.pattern?(c=a._zod).check??(c.check=c=>{b.pattern.lastIndex=0,b.pattern.test(c.value)||c.issues.push({origin:"string",code:"invalid_format",format:b.format,input:c.value,...b.pattern?{pattern:b.pattern.toString()}:{},inst:a,continue:!b.abort})}):(d=a._zod).check??(d.check=()=>{})}),eC=bm("$ZodCheckRegex",(a,b)=>{eB.init(a,b),a._zod.check=c=>{b.pattern.lastIndex=0,b.pattern.test(c.value)||c.issues.push({origin:"string",code:"invalid_format",format:"regex",input:c.value,pattern:b.pattern.toString(),inst:a,continue:!b.abort})}}),eD=bm("$ZodCheckLowerCase",(a,b)=>{b.pattern??(b.pattern=eq),eB.init(a,b)}),eE=bm("$ZodCheckUpperCase",(a,b)=>{b.pattern??(b.pattern=er),eB.init(a,b)}),eF=bm("$ZodCheckIncludes",(a,b)=>{es.init(a,b);let c=bb(b.includes),d=new RegExp("number"==typeof b.position?`^.{${b.position}}${c}`:c);b.pattern=d,a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(d)}),a._zod.check=c=>{c.value.includes(b.includes,b.position)||c.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:b.includes,input:c.value,inst:a,continue:!b.abort})}}),eG=bm("$ZodCheckStartsWith",(a,b)=>{es.init(a,b);let c=RegExp(`^${bb(b.prefix)}.*`);b.pattern??(b.pattern=c),a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(c)}),a._zod.check=c=>{c.value.startsWith(b.prefix)||c.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:b.prefix,input:c.value,inst:a,continue:!b.abort})}}),eH=bm("$ZodCheckEndsWith",(a,b)=>{es.init(a,b);let c=RegExp(`.*${bb(b.suffix)}$`);b.pattern??(b.pattern=c),a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(c)}),a._zod.check=c=>{c.value.endsWith(b.suffix)||c.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:b.suffix,input:c.value,inst:a,continue:!b.abort})}}),eI=bm("$ZodCheckOverwrite",(a,b)=>{es.init(a,b),a._zod.check=a=>{a.value=b.tx(a.value)}});class eJ{constructor(a=[]){this.content=[],this.indent=0,this&&(this.args=a)}indented(a){this.indent+=1,a(this),this.indent-=1}write(a){if("function"==typeof a){a(this,{execution:"sync"}),a(this,{execution:"async"});return}let b=a.split("\n").filter(a=>a),c=Math.min(...b.map(a=>a.length-a.trimStart().length));for(let a of b.map(a=>a.slice(c)).map(a=>" ".repeat(2*this.indent)+a))this.content.push(a)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(a=>`  ${a}`)].join("\n"))}}let eK={major:4,minor:0,patch:0},eL=bm("$ZodType",(a,b)=>{var c;a??(a={}),a._zod.def=b,a._zod.bag=a._zod.bag||{},a._zod.version=eK;let d=[...a._zod.def.checks??[]];for(let b of(a._zod.traits.has("$ZodCheck")&&d.unshift(a),d))for(let c of b._zod.onattach)c(a);if(0===d.length)(c=a._zod).deferred??(c.deferred=[]),a._zod.deferred?.push(()=>{a._zod.run=a._zod.parse});else{let b=(a,b,c)=>{let d,e=bf(a);for(let f of b){if(f._zod.def.when){if(!f._zod.def.when(a))continue}else if(e)continue;let b=a.issues.length,g=f._zod.check(a);if(g instanceof Promise&&c?.async===!1)throw new bn;if(d||g instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await g,a.issues.length!==b&&(e||(e=bf(a,b)))});else{if(a.issues.length===b)continue;e||(e=bf(a,b))}}return d?d.then(()=>a):a};a._zod.run=(c,e)=>{let f=a._zod.parse(c,e);if(f instanceof Promise){if(!1===e.async)throw new bn;return f.then(a=>b(a,d,e))}return b(f,d,e)}}a["~standard"]={validate:b=>{try{let c=bu(a,b);return c.success?{value:c.data}:{issues:c.error?.issues}}catch(c){return bw(a,b).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}}),eM=bm("$ZodString",(a,b)=>{eL.init(a,b),a._zod.pattern=[...a?._zod.bag?.patterns??[]].pop()??(a=>{let b=a?`[\\s\\S]{${a?.minimum??0},${a?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${b}$`)})(a._zod.bag),a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=String(c.value)}catch(a){}return"string"==typeof c.value||c.issues.push({expected:"string",code:"invalid_type",input:c.value,inst:a}),c}}),eN=bm("$ZodStringFormat",(a,b)=>{eB.init(a,b),eM.init(a,b)}),eO=bm("$ZodGUID",(a,b)=>{b.pattern??(b.pattern=d8),eN.init(a,b)}),eP=bm("$ZodUUID",(a,b)=>{if(b.version){let a={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[b.version];if(void 0===a)throw Error(`Invalid UUID version: "${b.version}"`);b.pattern??(b.pattern=d9(a))}else b.pattern??(b.pattern=d9());eN.init(a,b)}),eQ=bm("$ZodEmail",(a,b)=>{b.pattern??(b.pattern=ea),eN.init(a,b)}),eR=bm("$ZodURL",(a,b)=>{eN.init(a,b),a._zod.check=c=>{try{let d=c.value,e=new URL(d),f=e.href;b.hostname&&(b.hostname.lastIndex=0,b.hostname.test(e.hostname)||c.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:eh.source,input:c.value,inst:a,continue:!b.abort})),b.protocol&&(b.protocol.lastIndex=0,b.protocol.test(e.protocol.endsWith(":")?e.protocol.slice(0,-1):e.protocol)||c.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:b.protocol.source,input:c.value,inst:a,continue:!b.abort})),!d.endsWith("/")&&f.endsWith("/")?c.value=f.slice(0,-1):c.value=f;return}catch(d){c.issues.push({code:"invalid_format",format:"url",input:c.value,inst:a,continue:!b.abort})}}}),eS=bm("$ZodEmoji",(a,b)=>{b.pattern??(b.pattern=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),eN.init(a,b)}),eT=bm("$ZodNanoID",(a,b)=>{b.pattern??(b.pattern=d6),eN.init(a,b)}),eU=bm("$ZodCUID",(a,b)=>{b.pattern??(b.pattern=d1),eN.init(a,b)}),eV=bm("$ZodCUID2",(a,b)=>{b.pattern??(b.pattern=d2),eN.init(a,b)}),eW=bm("$ZodULID",(a,b)=>{b.pattern??(b.pattern=d3),eN.init(a,b)}),eX=bm("$ZodXID",(a,b)=>{b.pattern??(b.pattern=d4),eN.init(a,b)}),eY=bm("$ZodKSUID",(a,b)=>{b.pattern??(b.pattern=d5),eN.init(a,b)}),eZ=bm("$ZodISODateTime",(a,b)=>{b.pattern??(b.pattern=function(a){let b=el({precision:a.precision}),c=["Z"];a.local&&c.push(""),a.offset&&c.push("([+-]\\d{2}:\\d{2})");let d=`${b}(?:${c.join("|")})`;return RegExp(`^${ej}T(?:${d})$`)}(b)),eN.init(a,b)}),e$=bm("$ZodISODate",(a,b)=>{b.pattern??(b.pattern=ek),eN.init(a,b)}),e_=bm("$ZodISOTime",(a,b)=>{b.pattern??(b.pattern=RegExp(`^${el(b)}$`)),eN.init(a,b)}),e0=bm("$ZodISODuration",(a,b)=>{b.pattern??(b.pattern=d7),eN.init(a,b)}),e1=bm("$ZodIPv4",(a,b)=>{b.pattern??(b.pattern=eb),eN.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.format="ipv4"})}),e2=bm("$ZodIPv6",(a,b)=>{b.pattern??(b.pattern=ec),eN.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.format="ipv6"}),a._zod.check=c=>{try{new URL(`http://[${c.value}]`)}catch{c.issues.push({code:"invalid_format",format:"ipv6",input:c.value,inst:a,continue:!b.abort})}}}),e3=bm("$ZodCIDRv4",(a,b)=>{b.pattern??(b.pattern=ed),eN.init(a,b)}),e4=bm("$ZodCIDRv6",(a,b)=>{b.pattern??(b.pattern=ee),eN.init(a,b),a._zod.check=c=>{let[d,e]=c.value.split("/");try{if(!e)throw Error();let a=Number(e);if(`${a}`!==e||a<0||a>128)throw Error();new URL(`http://[${d}]`)}catch{c.issues.push({code:"invalid_format",format:"cidrv6",input:c.value,inst:a,continue:!b.abort})}}});function e5(a){if(""===a)return!0;if(a.length%4!=0)return!1;try{return atob(a),!0}catch{return!1}}let e6=bm("$ZodBase64",(a,b)=>{b.pattern??(b.pattern=ef),eN.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64"}),a._zod.check=c=>{e5(c.value)||c.issues.push({code:"invalid_format",format:"base64",input:c.value,inst:a,continue:!b.abort})}}),e7=bm("$ZodBase64URL",(a,b)=>{b.pattern??(b.pattern=eg),eN.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64url"}),a._zod.check=c=>{!function(a){if(!eg.test(a))return!1;let b=a.replace(/[-_]/g,a=>"-"===a?"+":"/");return e5(b.padEnd(4*Math.ceil(b.length/4),"="))}(c.value)&&c.issues.push({code:"invalid_format",format:"base64url",input:c.value,inst:a,continue:!b.abort})}}),e8=bm("$ZodE164",(a,b)=>{b.pattern??(b.pattern=ei),eN.init(a,b)}),e9=bm("$ZodJWT",(a,b)=>{eN.init(a,b),a._zod.check=c=>{!function(a,b=null){try{let c=a.split(".");if(3!==c.length)return!1;let[d]=c;if(!d)return!1;let e=JSON.parse(atob(d));if("typ"in e&&e?.typ!=="JWT"||!e.alg||b&&(!("alg"in e)||e.alg!==b))return!1;return!0}catch{return!1}}(c.value,b.alg)&&c.issues.push({code:"invalid_format",format:"jwt",input:c.value,inst:a,continue:!b.abort})}}),fa=bm("$ZodNumber",(a,b)=>{eL.init(a,b),a._zod.pattern=a._zod.bag.pattern??en,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=Number(c.value)}catch(a){}let e=c.value;if("number"==typeof e&&!Number.isNaN(e)&&Number.isFinite(e))return c;let f="number"==typeof e?Number.isNaN(e)?"NaN":Number.isFinite(e)?void 0:"Infinity":void 0;return c.issues.push({expected:"number",code:"invalid_type",input:e,inst:a,...f?{received:f}:{}}),c}}),fb=bm("$ZodNumber",(a,b)=>{ex.init(a,b),fa.init(a,b)}),fc=bm("$ZodBoolean",(a,b)=>{eL.init(a,b),a._zod.pattern=eo,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=!!c.value}catch(a){}let e=c.value;return"boolean"==typeof e||c.issues.push({expected:"boolean",code:"invalid_type",input:e,inst:a}),c}}),fd=bm("$ZodNull",(a,b)=>{eL.init(a,b),a._zod.pattern=ep,a._zod.values=new Set([null]),a._zod.parse=(b,c)=>{let d=b.value;return null===d||b.issues.push({expected:"null",code:"invalid_type",input:d,inst:a}),b}}),fe=bm("$ZodAny",(a,b)=>{eL.init(a,b),a._zod.parse=a=>a}),ff=bm("$ZodUnknown",(a,b)=>{eL.init(a,b),a._zod.parse=a=>a}),fg=bm("$ZodNever",(a,b)=>{eL.init(a,b),a._zod.parse=(b,c)=>(b.issues.push({expected:"never",code:"invalid_type",input:b.value,inst:a}),b)});function fh(a,b,c){a.issues.length&&b.issues.push(...bg(c,a.issues)),b.value[c]=a.value}let fi=bm("$ZodArray",(a,b)=>{eL.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!Array.isArray(e))return c.issues.push({expected:"array",code:"invalid_type",input:e,inst:a}),c;c.value=Array(e.length);let f=[];for(let a=0;a<e.length;a++){let g=e[a],h=b.element._zod.run({value:g,issues:[]},d);h instanceof Promise?f.push(h.then(b=>fh(b,c,a))):fh(h,c,a)}return f.length?Promise.all(f).then(()=>c):c}});function fj(a,b,c){a.issues.length&&b.issues.push(...bg(c,a.issues)),b.value[c]=a.value}function fk(a,b,c,d){a.issues.length?void 0===d[c]?c in d?b.value[c]=void 0:b.value[c]=a.value:b.issues.push(...bg(c,a.issues)):void 0===a.value?c in d&&(b.value[c]=void 0):b.value[c]=a.value}let fl=bm("$ZodObject",(a,b)=>{let c,d;eL.init(a,b);let e=a1(()=>{let a=Object.keys(b.shape);for(let c of a)if(!(b.shape[c]instanceof eL))throw Error(`Invalid element at key "${c}": expected a Zod schema`);let c=function(a){return Object.keys(a).filter(b=>"optional"===a[b]._zod.optin&&"optional"===a[b]._zod.optout)}(b.shape);return{shape:b.shape,keys:a,keySet:new Set(a),numKeys:a.length,optionalKeys:new Set(c)}});a3(a._zod,"propValues",()=>{let a=b.shape,c={};for(let b in a){let d=a[b]._zod;if(d.values)for(let a of(c[b]??(c[b]=new Set),d.values))c[b].add(a)}return c});let f=!bo.jitless,g=f&&a8.value,h=b.catchall;a._zod.parse=(i,j)=>{d??(d=e.value);let k=i.value;if(!a7(k))return i.issues.push({expected:"object",code:"invalid_type",input:k,inst:a}),i;let l=[];if(f&&g&&j?.async===!1&&!0!==j.jitless)c||(c=(a=>{let b=new eJ(["shape","payload","ctx"]),c=e.value,d=a=>{let b=a5(a);return`shape[${b}]._zod.run({ value: input[${b}], issues: [] }, ctx)`};b.write("const input = payload.value;");let f=Object.create(null),g=0;for(let a of c.keys)f[a]=`key_${g++}`;for(let a of(b.write("const newResult = {}"),c.keys))if(c.optionalKeys.has(a)){let c=f[a];b.write(`const ${c} = ${d(a)};`);let e=a5(a);b.write(`
        if (${c}.issues.length) {
          if (input[${e}] === undefined) {
            if (${e} in input) {
              newResult[${e}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${c}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${e}, ...iss.path] : [${e}],
              }))
            );
          }
        } else if (${c}.value === undefined) {
          if (${e} in input) newResult[${e}] = undefined;
        } else {
          newResult[${e}] = ${c}.value;
        }
        `)}else{let c=f[a];b.write(`const ${c} = ${d(a)};`),b.write(`
          if (${c}.issues.length) payload.issues = payload.issues.concat(${c}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${a5(a)}, ...iss.path] : [${a5(a)}]
          })));`),b.write(`newResult[${a5(a)}] = ${c}.value`)}b.write("payload.value = newResult;"),b.write("return payload;");let h=b.compile();return(b,c)=>h(a,b,c)})(b.shape)),i=c(i,j);else{i.value={};let a=d.shape;for(let b of d.keys){let c=a[b],d=c._zod.run({value:k[b],issues:[]},j),e="optional"===c._zod.optin&&"optional"===c._zod.optout;d instanceof Promise?l.push(d.then(a=>e?fk(a,i,b,k):fj(a,i,b))):e?fk(d,i,b,k):fj(d,i,b)}}if(!h)return l.length?Promise.all(l).then(()=>i):i;let m=[],n=d.keySet,o=h._zod,p=o.def.type;for(let a of Object.keys(k)){if(n.has(a))continue;if("never"===p){m.push(a);continue}let b=o.run({value:k[a],issues:[]},j);b instanceof Promise?l.push(b.then(b=>fj(b,i,a))):fj(b,i,a)}return(m.length&&i.issues.push({code:"unrecognized_keys",keys:m,input:k,inst:a}),l.length)?Promise.all(l).then(()=>i):i}});function fm(a,b,c,d){for(let c of a)if(0===c.issues.length)return b.value=c.value,b;return b.issues.push({code:"invalid_union",input:b.value,inst:c,errors:a.map(a=>a.issues.map(a=>bi(a,d,bp())))}),b}let fn=bm("$ZodUnion",(a,b)=>{eL.init(a,b),a3(a._zod,"optin",()=>b.options.some(a=>"optional"===a._zod.optin)?"optional":void 0),a3(a._zod,"optout",()=>b.options.some(a=>"optional"===a._zod.optout)?"optional":void 0),a3(a._zod,"values",()=>{if(b.options.every(a=>a._zod.values))return new Set(b.options.flatMap(a=>Array.from(a._zod.values)))}),a3(a._zod,"pattern",()=>{if(b.options.every(a=>a._zod.pattern)){let a=b.options.map(a=>a._zod.pattern);return RegExp(`^(${a.map(a=>a2(a.source)).join("|")})$`)}}),a._zod.parse=(c,d)=>{let e=!1,f=[];for(let a of b.options){let b=a._zod.run({value:c.value,issues:[]},d);if(b instanceof Promise)f.push(b),e=!0;else{if(0===b.issues.length)return b;f.push(b)}}return e?Promise.all(f).then(b=>fm(b,c,a,d)):fm(f,c,a,d)}}),fo=bm("$ZodDiscriminatedUnion",(a,b)=>{fn.init(a,b);let c=a._zod.parse;a3(a._zod,"propValues",()=>{let a={};for(let c of b.options){let d=c._zod.propValues;if(!d||0===Object.keys(d).length)throw Error(`Invalid discriminated union option at index "${b.options.indexOf(c)}"`);for(let[b,c]of Object.entries(d))for(let d of(a[b]||(a[b]=new Set),c))a[b].add(d)}return a});let d=a1(()=>{let a=b.options,c=new Map;for(let d of a){let a=d._zod.propValues[b.discriminator];if(!a||0===a.size)throw Error(`Invalid discriminated union option at index "${b.options.indexOf(d)}"`);for(let b of a){if(c.has(b))throw Error(`Duplicate discriminator value "${String(b)}"`);c.set(b,d)}}return c});a._zod.parse=(e,f)=>{let g=e.value;if(!a7(g))return e.issues.push({code:"invalid_type",expected:"object",input:g,inst:a}),e;let h=d.value.get(g?.[b.discriminator]);return h?h._zod.run(e,f):b.unionFallback?c(e,f):(e.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:g,path:[b.discriminator],inst:a}),e)}}),fp=bm("$ZodIntersection",(a,b)=>{eL.init(a,b),a._zod.parse=(a,c)=>{let d=a.value,e=b.left._zod.run({value:d,issues:[]},c),f=b.right._zod.run({value:d,issues:[]},c);return e instanceof Promise||f instanceof Promise?Promise.all([e,f]).then(([b,c])=>fq(a,b,c)):fq(a,e,f)}});function fq(a,b,c){if(b.issues.length&&a.issues.push(...b.issues),c.issues.length&&a.issues.push(...c.issues),bf(a))return a;let d=function a(b,c){if(b===c||b instanceof Date&&c instanceof Date&&+b==+c)return{valid:!0,data:b};if(a9(b)&&a9(c)){let d=Object.keys(c),e=Object.keys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1,mergeErrorPath:[d,...e.mergeErrorPath]};f[d]=e.data}return{valid:!0,data:f}}if(Array.isArray(b)&&Array.isArray(c)){if(b.length!==c.length)return{valid:!1,mergeErrorPath:[]};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1,mergeErrorPath:[e,...f.mergeErrorPath]};d.push(f.data)}return{valid:!0,data:d}}return{valid:!1,mergeErrorPath:[]}}(b.value,c.value);if(!d.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(d.mergeErrorPath)}`);return a.value=d.data,a}let fr=bm("$ZodRecord",(a,b)=>{eL.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!a9(e))return c.issues.push({expected:"record",code:"invalid_type",input:e,inst:a}),c;let f=[];if(b.keyType._zod.values){let g,h=b.keyType._zod.values;for(let a of(c.value={},h))if("string"==typeof a||"number"==typeof a||"symbol"==typeof a){let g=b.valueType._zod.run({value:e[a],issues:[]},d);g instanceof Promise?f.push(g.then(b=>{b.issues.length&&c.issues.push(...bg(a,b.issues)),c.value[a]=b.value})):(g.issues.length&&c.issues.push(...bg(a,g.issues)),c.value[a]=g.value)}for(let a in e)h.has(a)||(g=g??[]).push(a);g&&g.length>0&&c.issues.push({code:"unrecognized_keys",input:e,inst:a,keys:g})}else for(let g of(c.value={},Reflect.ownKeys(e))){if("__proto__"===g)continue;let h=b.keyType._zod.run({value:g,issues:[]},d);if(h instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(h.issues.length){c.issues.push({origin:"record",code:"invalid_key",issues:h.issues.map(a=>bi(a,d,bp())),input:g,path:[g],inst:a}),c.value[h.value]=h.value;continue}let i=b.valueType._zod.run({value:e[g],issues:[]},d);i instanceof Promise?f.push(i.then(a=>{a.issues.length&&c.issues.push(...bg(g,a.issues)),c.value[h.value]=a.value})):(i.issues.length&&c.issues.push(...bg(g,i.issues)),c.value[h.value]=i.value)}return f.length?Promise.all(f).then(()=>c):c}}),fs=bm("$ZodEnum",(a,b)=>{eL.init(a,b);let c=a_(b.entries);a._zod.values=new Set(c),a._zod.pattern=RegExp(`^(${c.filter(a=>ba.has(typeof a)).map(a=>"string"==typeof a?bb(a):a.toString()).join("|")})$`),a._zod.parse=(b,d)=>{let e=b.value;return a._zod.values.has(e)||b.issues.push({code:"invalid_value",values:c,input:e,inst:a}),b}}),ft=bm("$ZodLiteral",(a,b)=>{eL.init(a,b),a._zod.values=new Set(b.values),a._zod.pattern=RegExp(`^(${b.values.map(a=>"string"==typeof a?bb(a):a?a.toString():String(a)).join("|")})$`),a._zod.parse=(c,d)=>{let e=c.value;return a._zod.values.has(e)||c.issues.push({code:"invalid_value",values:b.values,input:e,inst:a}),c}}),fu=bm("$ZodTransform",(a,b)=>{eL.init(a,b),a._zod.parse=(a,c)=>{let d=b.transform(a.value,a);if(c.async)return(d instanceof Promise?d:Promise.resolve(d)).then(b=>(a.value=b,a));if(d instanceof Promise)throw new bn;return a.value=d,a}}),fv=bm("$ZodOptional",(a,b)=>{eL.init(a,b),a._zod.optin="optional",a._zod.optout="optional",a3(a._zod,"values",()=>b.innerType._zod.values?new Set([...b.innerType._zod.values,void 0]):void 0),a3(a._zod,"pattern",()=>{let a=b.innerType._zod.pattern;return a?RegExp(`^(${a2(a.source)})?$`):void 0}),a._zod.parse=(a,c)=>"optional"===b.innerType._zod.optin?b.innerType._zod.run(a,c):void 0===a.value?a:b.innerType._zod.run(a,c)}),fw=bm("$ZodNullable",(a,b)=>{eL.init(a,b),a3(a._zod,"optin",()=>b.innerType._zod.optin),a3(a._zod,"optout",()=>b.innerType._zod.optout),a3(a._zod,"pattern",()=>{let a=b.innerType._zod.pattern;return a?RegExp(`^(${a2(a.source)}|null)$`):void 0}),a3(a._zod,"values",()=>b.innerType._zod.values?new Set([...b.innerType._zod.values,null]):void 0),a._zod.parse=(a,c)=>null===a.value?a:b.innerType._zod.run(a,c)}),fx=bm("$ZodDefault",(a,b)=>{eL.init(a,b),a._zod.optin="optional",a3(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>{if(void 0===a.value)return a.value=b.defaultValue,a;let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(a=>fy(a,b)):fy(d,b)}});function fy(a,b){return void 0===a.value&&(a.value=b.defaultValue),a}let fz=bm("$ZodPrefault",(a,b)=>{eL.init(a,b),a._zod.optin="optional",a3(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>(void 0===a.value&&(a.value=b.defaultValue),b.innerType._zod.run(a,c))}),fA=bm("$ZodNonOptional",(a,b)=>{eL.init(a,b),a3(a._zod,"values",()=>{let a=b.innerType._zod.values;return a?new Set([...a].filter(a=>void 0!==a)):void 0}),a._zod.parse=(c,d)=>{let e=b.innerType._zod.run(c,d);return e instanceof Promise?e.then(b=>fB(b,a)):fB(e,a)}});function fB(a,b){return a.issues.length||void 0!==a.value||a.issues.push({code:"invalid_type",expected:"nonoptional",input:a.value,inst:b}),a}let fC=bm("$ZodCatch",(a,b)=>{eL.init(a,b),a._zod.optin="optional",a3(a._zod,"optout",()=>b.innerType._zod.optout),a3(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>{let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(d=>(a.value=d.value,d.issues.length&&(a.value=b.catchValue({...a,error:{issues:d.issues.map(a=>bi(a,c,bp()))},input:a.value}),a.issues=[]),a)):(a.value=d.value,d.issues.length&&(a.value=b.catchValue({...a,error:{issues:d.issues.map(a=>bi(a,c,bp()))},input:a.value}),a.issues=[]),a)}}),fD=bm("$ZodPipe",(a,b)=>{eL.init(a,b),a3(a._zod,"values",()=>b.in._zod.values),a3(a._zod,"optin",()=>b.in._zod.optin),a3(a._zod,"optout",()=>b.out._zod.optout),a._zod.parse=(a,c)=>{let d=b.in._zod.run(a,c);return d instanceof Promise?d.then(a=>fE(a,b,c)):fE(d,b,c)}});function fE(a,b,c){return bf(a)?a:b.out._zod.run({value:a.value,issues:a.issues},c)}let fF=bm("$ZodReadonly",(a,b)=>{eL.init(a,b),a3(a._zod,"propValues",()=>b.innerType._zod.propValues),a3(a._zod,"values",()=>b.innerType._zod.values),a3(a._zod,"optin",()=>b.innerType._zod.optin),a3(a._zod,"optout",()=>b.innerType._zod.optout),a._zod.parse=(a,c)=>{let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(fG):fG(d)}});function fG(a){return a.value=Object.freeze(a.value),a}let fH=bm("$ZodLazy",(a,b)=>{eL.init(a,b),a3(a._zod,"innerType",()=>b.getter()),a3(a._zod,"pattern",()=>a._zod.innerType._zod.pattern),a3(a._zod,"propValues",()=>a._zod.innerType._zod.propValues),a3(a._zod,"optin",()=>a._zod.innerType._zod.optin),a3(a._zod,"optout",()=>a._zod.innerType._zod.optout),a._zod.parse=(b,c)=>a._zod.innerType._zod.run(b,c)}),fI=bm("$ZodCustom",(a,b)=>{es.init(a,b),eL.init(a,b),a._zod.parse=(a,b)=>a,a._zod.check=c=>{let d=c.value,e=b.fn(d);if(e instanceof Promise)return e.then(b=>fJ(b,c,d,a));fJ(e,c,d,a)}});function fJ(a,b,c,d){if(!a){let a={code:"custom",input:c,inst:d,path:[...d._zod.def.path??[]],continue:!d._zod.def.abort};d._zod.def.params&&(a.params=d._zod.def.params),b.issues.push(bk(a))}}function fK(a,b){return new a({type:"string",format:"guid",check:"string_format",abort:!1,...bd(b)})}function fL(a,b){return new eu({check:"less_than",...bd(b),value:a,inclusive:!1})}function fM(a,b){return new eu({check:"less_than",...bd(b),value:a,inclusive:!0})}function fN(a,b){return new ev({check:"greater_than",...bd(b),value:a,inclusive:!1})}function fO(a,b){return new ev({check:"greater_than",...bd(b),value:a,inclusive:!0})}function fP(a,b){return new ew({check:"multiple_of",...bd(b),value:a})}function fQ(a,b){return new ey({check:"max_length",...bd(b),maximum:a})}function fR(a,b){return new ez({check:"min_length",...bd(b),minimum:a})}function fS(a,b){return new eA({check:"length_equals",...bd(b),length:a})}function fT(a){return new eI({check:"overwrite",tx:a})}let fU=bm("ZodISODateTime",(a,b)=>{eZ.init(a,b),f0.init(a,b)}),fV=bm("ZodISODate",(a,b)=>{e$.init(a,b),f0.init(a,b)}),fW=bm("ZodISOTime",(a,b)=>{e_.init(a,b),f0.init(a,b)}),fX=bm("ZodISODuration",(a,b)=>{e0.init(a,b),f0.init(a,b)}),fY=bm("ZodType",(a,b)=>(eL.init(a,b),a.def=b,Object.defineProperty(a,"_def",{value:b}),a.check=(...c)=>a.clone({...b,checks:[...b.checks??[],...c.map(a=>"function"==typeof a?{_zod:{check:a,def:{check:"custom"},onattach:[]}}:a)]}),a.clone=(b,c)=>bc(a,b,c),a.brand=()=>a,a.register=(b,c)=>(b.add(a,c),a),a.parse=(b,c)=>bz(a,b,c,{callee:a.parse}),a.safeParse=(b,c)=>bB(a,b,c),a.parseAsync=async(b,c)=>bA(a,b,c,{callee:a.parseAsync}),a.safeParseAsync=async(b,c)=>bC(a,b,c),a.spa=a.safeParseAsync,a.refine=(b,c)=>a.check(function(a,b={}){return new g0({type:"custom",check:"custom",fn:a,...bd(b)})}(b,c)),a.superRefine=b=>a.check(function(a){let b=function(a){let b=new es({check:"custom"});return b._zod.check=a,b}(c=>(c.addIssue=a=>{"string"==typeof a?c.issues.push(bk(a,c.value,b._zod.def)):(a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=c.value),a.inst??(a.inst=b),a.continue??(a.continue=!b._zod.def.abort),c.issues.push(bk(a)))},a(c.value,c)));return b}(b)),a.overwrite=b=>a.check(fT(b)),a.optional=()=>gQ(a),a.nullable=()=>gS(a),a.nullish=()=>gQ(gS(a)),a.nonoptional=b=>new gV({type:"nonoptional",innerType:a,...bd(b)}),a.array=()=>gz(a),a.or=b=>gE([a,b]),a.and=b=>new gH({type:"intersection",left:a,right:b}),a.transform=b=>gY(a,new gO({type:"transform",transform:b})),a.default=b=>(function(a,b){return new gT({type:"default",innerType:a,get defaultValue(){return"function"==typeof b?b():b}})})(a,b),a.prefault=b=>(function(a,b){return new gU({type:"prefault",innerType:a,get defaultValue(){return"function"==typeof b?b():b}})})(a,b),a.catch=b=>(function(a,b){return new gW({type:"catch",innerType:a,catchValue:"function"==typeof b?b:()=>b})})(a,b),a.pipe=b=>gY(a,b),a.readonly=()=>new gZ({type:"readonly",innerType:a}),a.describe=b=>{let c=a.clone();return a$.add(c,{description:b}),c},Object.defineProperty(a,"description",{get:()=>a$.get(a)?.description,configurable:!0}),a.meta=(...b)=>{if(0===b.length)return a$.get(a);let c=a.clone();return a$.add(c,b[0]),c},a.isOptional=()=>a.safeParse(void 0).success,a.isNullable=()=>a.safeParse(null).success,a)),fZ=bm("_ZodString",(a,b)=>{eM.init(a,b),fY.init(a,b);let c=a._zod.bag;a.format=c.format??null,a.minLength=c.minimum??null,a.maxLength=c.maximum??null,a.regex=(...b)=>a.check(function(a,b){return new eC({check:"string_format",format:"regex",...bd(b),pattern:a})}(...b)),a.includes=(...b)=>a.check(function(a,b){return new eF({check:"string_format",format:"includes",...bd(b),includes:a})}(...b)),a.startsWith=(...b)=>a.check(function(a,b){return new eG({check:"string_format",format:"starts_with",...bd(b),prefix:a})}(...b)),a.endsWith=(...b)=>a.check(function(a,b){return new eH({check:"string_format",format:"ends_with",...bd(b),suffix:a})}(...b)),a.min=(...b)=>a.check(fR(...b)),a.max=(...b)=>a.check(fQ(...b)),a.length=(...b)=>a.check(fS(...b)),a.nonempty=(...b)=>a.check(fR(1,...b)),a.lowercase=b=>a.check(new eD({check:"string_format",format:"lowercase",...bd(b)})),a.uppercase=b=>a.check(new eE({check:"string_format",format:"uppercase",...bd(b)})),a.trim=()=>a.check(fT(a=>a.trim())),a.normalize=(...b)=>a.check(function(a){return fT(b=>b.normalize(a))}(...b)),a.toLowerCase=()=>a.check(fT(a=>a.toLowerCase())),a.toUpperCase=()=>a.check(fT(a=>a.toUpperCase()))}),f$=bm("ZodString",(a,b)=>{eM.init(a,b),fZ.init(a,b),a.email=b=>a.check(new f1({type:"string",format:"email",check:"string_format",abort:!1,...bd(b)})),a.url=b=>a.check(new f4({type:"string",format:"url",check:"string_format",abort:!1,...bd(b)})),a.jwt=b=>a.check(new gj({type:"string",format:"jwt",check:"string_format",abort:!1,...bd(b)})),a.emoji=b=>a.check(new f5({type:"string",format:"emoji",check:"string_format",abort:!1,...bd(b)})),a.guid=b=>a.check(fK(f2,b)),a.uuid=b=>a.check(new f3({type:"string",format:"uuid",check:"string_format",abort:!1,...bd(b)})),a.uuidv4=b=>a.check(new f3({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...bd(b)})),a.uuidv6=b=>a.check(new f3({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...bd(b)})),a.uuidv7=b=>a.check(new f3({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...bd(b)})),a.nanoid=b=>a.check(new f6({type:"string",format:"nanoid",check:"string_format",abort:!1,...bd(b)})),a.guid=b=>a.check(fK(f2,b)),a.cuid=b=>a.check(new f7({type:"string",format:"cuid",check:"string_format",abort:!1,...bd(b)})),a.cuid2=b=>a.check(new f8({type:"string",format:"cuid2",check:"string_format",abort:!1,...bd(b)})),a.ulid=b=>a.check(new f9({type:"string",format:"ulid",check:"string_format",abort:!1,...bd(b)})),a.base64=b=>a.check(new gg({type:"string",format:"base64",check:"string_format",abort:!1,...bd(b)})),a.base64url=b=>a.check(new gh({type:"string",format:"base64url",check:"string_format",abort:!1,...bd(b)})),a.xid=b=>a.check(new ga({type:"string",format:"xid",check:"string_format",abort:!1,...bd(b)})),a.ksuid=b=>a.check(new gb({type:"string",format:"ksuid",check:"string_format",abort:!1,...bd(b)})),a.ipv4=b=>a.check(new gc({type:"string",format:"ipv4",check:"string_format",abort:!1,...bd(b)})),a.ipv6=b=>a.check(new gd({type:"string",format:"ipv6",check:"string_format",abort:!1,...bd(b)})),a.cidrv4=b=>a.check(new ge({type:"string",format:"cidrv4",check:"string_format",abort:!1,...bd(b)})),a.cidrv6=b=>a.check(new gf({type:"string",format:"cidrv6",check:"string_format",abort:!1,...bd(b)})),a.e164=b=>a.check(new gi({type:"string",format:"e164",check:"string_format",abort:!1,...bd(b)})),a.datetime=b=>a.check(new fU({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...bd(b)})),a.date=b=>a.check(new fV({type:"string",format:"date",check:"string_format",...bd(b)})),a.time=b=>a.check(new fW({type:"string",format:"time",check:"string_format",precision:null,...bd(b)})),a.duration=b=>a.check(new fX({type:"string",format:"duration",check:"string_format",...bd(b)}))});function f_(a){return new f$({type:"string",...bd(a)})}let f0=bm("ZodStringFormat",(a,b)=>{eN.init(a,b),fZ.init(a,b)}),f1=bm("ZodEmail",(a,b)=>{eQ.init(a,b),f0.init(a,b)}),f2=bm("ZodGUID",(a,b)=>{eO.init(a,b),f0.init(a,b)}),f3=bm("ZodUUID",(a,b)=>{eP.init(a,b),f0.init(a,b)}),f4=bm("ZodURL",(a,b)=>{eR.init(a,b),f0.init(a,b)}),f5=bm("ZodEmoji",(a,b)=>{eS.init(a,b),f0.init(a,b)}),f6=bm("ZodNanoID",(a,b)=>{eT.init(a,b),f0.init(a,b)}),f7=bm("ZodCUID",(a,b)=>{eU.init(a,b),f0.init(a,b)}),f8=bm("ZodCUID2",(a,b)=>{eV.init(a,b),f0.init(a,b)}),f9=bm("ZodULID",(a,b)=>{eW.init(a,b),f0.init(a,b)}),ga=bm("ZodXID",(a,b)=>{eX.init(a,b),f0.init(a,b)}),gb=bm("ZodKSUID",(a,b)=>{eY.init(a,b),f0.init(a,b)}),gc=bm("ZodIPv4",(a,b)=>{e1.init(a,b),f0.init(a,b)}),gd=bm("ZodIPv6",(a,b)=>{e2.init(a,b),f0.init(a,b)}),ge=bm("ZodCIDRv4",(a,b)=>{e3.init(a,b),f0.init(a,b)}),gf=bm("ZodCIDRv6",(a,b)=>{e4.init(a,b),f0.init(a,b)}),gg=bm("ZodBase64",(a,b)=>{e6.init(a,b),f0.init(a,b)}),gh=bm("ZodBase64URL",(a,b)=>{e7.init(a,b),f0.init(a,b)}),gi=bm("ZodE164",(a,b)=>{e8.init(a,b),f0.init(a,b)}),gj=bm("ZodJWT",(a,b)=>{e9.init(a,b),f0.init(a,b)}),gk=bm("ZodNumber",(a,b)=>{fa.init(a,b),fY.init(a,b),a.gt=(b,c)=>a.check(fN(b,c)),a.gte=(b,c)=>a.check(fO(b,c)),a.min=(b,c)=>a.check(fO(b,c)),a.lt=(b,c)=>a.check(fL(b,c)),a.lte=(b,c)=>a.check(fM(b,c)),a.max=(b,c)=>a.check(fM(b,c)),a.int=b=>a.check(gn(b)),a.safe=b=>a.check(gn(b)),a.positive=b=>a.check(fN(0,b)),a.nonnegative=b=>a.check(fO(0,b)),a.negative=b=>a.check(fL(0,b)),a.nonpositive=b=>a.check(fM(0,b)),a.multipleOf=(b,c)=>a.check(fP(b,c)),a.step=(b,c)=>a.check(fP(b,c)),a.finite=()=>a;let c=a._zod.bag;a.minValue=Math.max(c.minimum??-1/0,c.exclusiveMinimum??-1/0)??null,a.maxValue=Math.min(c.maximum??1/0,c.exclusiveMaximum??1/0)??null,a.isInt=(c.format??"").includes("int")||Number.isSafeInteger(c.multipleOf??.5),a.isFinite=!0,a.format=c.format??null});function gl(a){return new gk({type:"number",checks:[],...bd(a)})}let gm=bm("ZodNumberFormat",(a,b)=>{fb.init(a,b),gk.init(a,b)});function gn(a){return new gm({type:"number",check:"number_format",abort:!1,format:"safeint",...bd(a)})}let go=bm("ZodBoolean",(a,b)=>{fc.init(a,b),fY.init(a,b)});function gp(a){return new go({type:"boolean",...bd(a)})}let gq=bm("ZodNull",(a,b)=>{fd.init(a,b),fY.init(a,b)});function gr(a){return new gq({type:"null",...bd(a)})}let gs=bm("ZodAny",(a,b)=>{fe.init(a,b),fY.init(a,b)});function gt(){return new gs({type:"any"})}let gu=bm("ZodUnknown",(a,b)=>{ff.init(a,b),fY.init(a,b)});function gv(){return new gu({type:"unknown"})}let gw=bm("ZodNever",(a,b)=>{fg.init(a,b),fY.init(a,b)});function gx(a){return new gw({type:"never",...bd(a)})}let gy=bm("ZodArray",(a,b)=>{fi.init(a,b),fY.init(a,b),a.element=b.element,a.min=(b,c)=>a.check(fR(b,c)),a.nonempty=b=>a.check(fR(1,b)),a.max=(b,c)=>a.check(fQ(b,c)),a.length=(b,c)=>a.check(fS(b,c)),a.unwrap=()=>a.element});function gz(a,b){return new gy({type:"array",element:a,...bd(b)})}let gA=bm("ZodObject",(a,b)=>{fl.init(a,b),fY.init(a,b),a3(a,"shape",()=>b.shape),a.keyof=()=>gL(Object.keys(a._zod.def.shape)),a.catchall=b=>a.clone({...a._zod.def,catchall:b}),a.passthrough=()=>a.clone({...a._zod.def,catchall:gv()}),a.loose=()=>a.clone({...a._zod.def,catchall:gv()}),a.strict=()=>a.clone({...a._zod.def,catchall:gx()}),a.strip=()=>a.clone({...a._zod.def,catchall:void 0}),a.extend=b=>(function(a,b){if(!a9(b))throw Error("Invalid input to extend: expected a plain object");let c={...a._zod.def,get shape(){let c={...a._zod.def.shape,...b};return a4(this,"shape",c),c},checks:[]};return bc(a,c)})(a,b),a.merge=b=>(function(a,b){return bc(a,{...a._zod.def,get shape(){let c={...a._zod.def.shape,...b._zod.def.shape};return a4(this,"shape",c),c},catchall:b._zod.def.catchall,checks:[]})})(a,b),a.pick=b=>(function(a,b){let c={},d=a._zod.def;for(let a in b){if(!(a in d.shape))throw Error(`Unrecognized key: "${a}"`);b[a]&&(c[a]=d.shape[a])}return bc(a,{...a._zod.def,shape:c,checks:[]})})(a,b),a.omit=b=>(function(a,b){let c={...a._zod.def.shape},d=a._zod.def;for(let a in b){if(!(a in d.shape))throw Error(`Unrecognized key: "${a}"`);b[a]&&delete c[a]}return bc(a,{...a._zod.def,shape:c,checks:[]})})(a,b),a.partial=(...b)=>(function(a,b,c){let d=b._zod.def.shape,e={...d};if(c)for(let b in c){if(!(b in d))throw Error(`Unrecognized key: "${b}"`);c[b]&&(e[b]=a?new a({type:"optional",innerType:d[b]}):d[b])}else for(let b in d)e[b]=a?new a({type:"optional",innerType:d[b]}):d[b];return bc(b,{...b._zod.def,shape:e,checks:[]})})(gP,a,b[0]),a.required=(...b)=>(function(a,b,c){let d=b._zod.def.shape,e={...d};if(c)for(let b in c){if(!(b in e))throw Error(`Unrecognized key: "${b}"`);c[b]&&(e[b]=new a({type:"nonoptional",innerType:d[b]}))}else for(let b in d)e[b]=new a({type:"nonoptional",innerType:d[b]});return bc(b,{...b._zod.def,shape:e,checks:[]})})(gV,a,b[0])});function gB(a,b){return new gA({type:"object",get shape(){return a4(this,"shape",{...a}),this.shape},...bd(b)})}function gC(a,b){return new gA({type:"object",get shape(){return a4(this,"shape",{...a}),this.shape},catchall:gx(),...bd(b)})}let gD=bm("ZodUnion",(a,b)=>{fn.init(a,b),fY.init(a,b),a.options=b.options});function gE(a,b){return new gD({type:"union",options:a,...bd(b)})}let gF=bm("ZodDiscriminatedUnion",(a,b)=>{gD.init(a,b),fo.init(a,b)});function gG(a,b,c){return new gF({type:"union",options:b,discriminator:a,...bd(c)})}let gH=bm("ZodIntersection",(a,b)=>{fp.init(a,b),fY.init(a,b)}),gI=bm("ZodRecord",(a,b)=>{fr.init(a,b),fY.init(a,b),a.keyType=b.keyType,a.valueType=b.valueType});function gJ(a,b,c){return new gI({type:"record",keyType:a,valueType:b,...bd(c)})}let gK=bm("ZodEnum",(a,b)=>{fs.init(a,b),fY.init(a,b),a.enum=b.entries,a.options=Object.values(b.entries);let c=new Set(Object.keys(b.entries));a.extract=(a,d)=>{let e={};for(let d of a)if(c.has(d))e[d]=b.entries[d];else throw Error(`Key ${d} not found in enum`);return new gK({...b,checks:[],...bd(d),entries:e})},a.exclude=(a,d)=>{let e={...b.entries};for(let b of a)if(c.has(b))delete e[b];else throw Error(`Key ${b} not found in enum`);return new gK({...b,checks:[],...bd(d),entries:e})}});function gL(a,b){return new gK({type:"enum",entries:Array.isArray(a)?Object.fromEntries(a.map(a=>[a,a])):a,...bd(b)})}let gM=bm("ZodLiteral",(a,b)=>{ft.init(a,b),fY.init(a,b),a.values=new Set(b.values),Object.defineProperty(a,"value",{get(){if(b.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return b.values[0]}})});function gN(a,b){return new gM({type:"literal",values:Array.isArray(a)?a:[a],...bd(b)})}let gO=bm("ZodTransform",(a,b)=>{fu.init(a,b),fY.init(a,b),a._zod.parse=(c,d)=>{c.addIssue=d=>{"string"==typeof d?c.issues.push(bk(d,c.value,b)):(d.fatal&&(d.continue=!1),d.code??(d.code="custom"),d.input??(d.input=c.value),d.inst??(d.inst=a),d.continue??(d.continue=!0),c.issues.push(bk(d)))};let e=b.transform(c.value,c);return e instanceof Promise?e.then(a=>(c.value=a,c)):(c.value=e,c)}}),gP=bm("ZodOptional",(a,b)=>{fv.init(a,b),fY.init(a,b),a.unwrap=()=>a._zod.def.innerType});function gQ(a){return new gP({type:"optional",innerType:a})}let gR=bm("ZodNullable",(a,b)=>{fw.init(a,b),fY.init(a,b),a.unwrap=()=>a._zod.def.innerType});function gS(a){return new gR({type:"nullable",innerType:a})}let gT=bm("ZodDefault",(a,b)=>{fx.init(a,b),fY.init(a,b),a.unwrap=()=>a._zod.def.innerType,a.removeDefault=a.unwrap}),gU=bm("ZodPrefault",(a,b)=>{fz.init(a,b),fY.init(a,b),a.unwrap=()=>a._zod.def.innerType}),gV=bm("ZodNonOptional",(a,b)=>{fA.init(a,b),fY.init(a,b),a.unwrap=()=>a._zod.def.innerType}),gW=bm("ZodCatch",(a,b)=>{fC.init(a,b),fY.init(a,b),a.unwrap=()=>a._zod.def.innerType,a.removeCatch=a.unwrap}),gX=bm("ZodPipe",(a,b)=>{fD.init(a,b),fY.init(a,b),a.in=b.in,a.out=b.out});function gY(a,b){return new gX({type:"pipe",in:a,out:b})}let gZ=bm("ZodReadonly",(a,b)=>{fF.init(a,b),fY.init(a,b)}),g$=bm("ZodLazy",(a,b)=>{fH.init(a,b),fY.init(a,b),a.unwrap=()=>a._zod.def.getter()});function g_(a){return new g$({type:"lazy",getter:a})}let g0=bm("ZodCustom",(a,b)=>{fI.init(a,b),fY.init(a,b)});function g1(a,b){let c=bd(b);return c.abort??(c.abort=!0),new g0({type:"custom",check:"custom",fn:a??(()=>!0),...c})}function g2(a,b={error:`Input not instance of ${a.name}`}){let c=new g0({type:"custom",check:"custom",fn:b=>b instanceof a,abort:!0,...bd(b)});return c._zod.bag.Class=a,c}var g3=c(98311),g4=Symbol.for("vercel.ai.gateway.error"),g5=class a extends(H=Error,G=g4,H){constructor({message:a,statusCode:b=500,cause:c,generationId:d}){super(d?`${a} [${d}]`:a),this[G]=!0,this.statusCode=b,this.cause=c,this.generationId=d}static isInstance(b){return a.hasMarker(b)}static hasMarker(a){return"object"==typeof a&&null!==a&&g4 in a&&!0===a[g4]}},g6="GatewayAuthenticationError",g7=Symbol.for(`vercel.ai.gateway.error.${g6}`),g8=class a extends(J=g5,I=g7,J){constructor({message:a="Authentication failed",statusCode:b=401,cause:c,generationId:d}={}){super({message:a,statusCode:b,cause:c,generationId:d}),this[I]=!0,this.name=g6,this.type="authentication_error"}static isInstance(a){return g5.hasMarker(a)&&g7 in a}static createContextualError({apiKeyProvided:b,oidcTokenProvided:c,message:d="Authentication failed",statusCode:e=401,cause:f,generationId:g}){return new a({message:b?`AI Gateway authentication failed: Invalid API key.

Create a new API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys

Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:c?`AI Gateway authentication failed: Invalid OIDC token.

Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.

Alternatively, use an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys`:`AI Gateway authentication failed: No authentication provided.

Option 1 - API key:
Create an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys
Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

Option 2 - OIDC token:
Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.`,statusCode:e,cause:f,generationId:g})}},g9="GatewayInvalidRequestError",ha=Symbol.for(`vercel.ai.gateway.error.${g9}`),hb=class extends(L=g5,K=ha,L){constructor({message:a="Invalid request",statusCode:b=400,cause:c,generationId:d}={}){super({message:a,statusCode:b,cause:c,generationId:d}),this[K]=!0,this.name=g9,this.type="invalid_request_error"}static isInstance(a){return g5.hasMarker(a)&&ha in a}},hc="GatewayRateLimitError",hd=Symbol.for(`vercel.ai.gateway.error.${hc}`),he=class extends(N=g5,M=hd,N){constructor({message:a="Rate limit exceeded",statusCode:b=429,cause:c,generationId:d}={}){super({message:a,statusCode:b,cause:c,generationId:d}),this[M]=!0,this.name=hc,this.type="rate_limit_exceeded"}static isInstance(a){return g5.hasMarker(a)&&hd in a}},hf="GatewayModelNotFoundError",hg=Symbol.for(`vercel.ai.gateway.error.${hf}`),hh=dI(()=>dL(gB({modelId:f_()}))),hi=class extends(P=g5,O=hg,P){constructor({message:a="Model not found",statusCode:b=404,modelId:c,cause:d,generationId:e}={}){super({message:a,statusCode:b,cause:d,generationId:e}),this[O]=!0,this.name=hf,this.type="model_not_found",this.modelId=c}static isInstance(a){return g5.hasMarker(a)&&hg in a}},hj="GatewayInternalServerError",hk=Symbol.for(`vercel.ai.gateway.error.${hj}`),hl=class extends(R=g5,Q=hk,R){constructor({message:a="Internal server error",statusCode:b=500,cause:c,generationId:d}={}){super({message:a,statusCode:b,cause:c,generationId:d}),this[Q]=!0,this.name=hj,this.type="internal_server_error"}static isInstance(a){return g5.hasMarker(a)&&hk in a}},hm="GatewayResponseError",hn=Symbol.for(`vercel.ai.gateway.error.${hm}`),ho=class extends(T=g5,S=hn,T){constructor({message:a="Invalid response from Gateway",statusCode:b=502,response:c,validationError:d,cause:e,generationId:f}={}){super({message:a,statusCode:b,cause:e,generationId:f}),this[S]=!0,this.name=hm,this.type="response_error",this.response=c,this.validationError=d}static isInstance(a){return g5.hasMarker(a)&&hn in a}};async function hp({response:a,statusCode:b,defaultMessage:c="Gateway request failed",cause:d,authMethod:e}){var f;let g=await dN({value:a,schema:hq});if(!g.success){let e="object"==typeof a&&null!==a&&"generationId"in a?a.generationId:void 0;return new ho({message:`Invalid error response format: ${c}`,statusCode:b,response:a,validationError:g.error,cause:d,generationId:e})}let h=g.value,i=h.error.type,j=h.error.message,k=null!=(f=h.generationId)?f:void 0;switch(i){case"authentication_error":return g8.createContextualError({apiKeyProvided:"api-key"===e,oidcTokenProvided:"oidc"===e,statusCode:b,cause:d,generationId:k});case"invalid_request_error":return new hb({message:j,statusCode:b,cause:d,generationId:k});case"rate_limit_exceeded":return new he({message:j,statusCode:b,cause:d,generationId:k});case"model_not_found":{let a=await dN({value:h.error.param,schema:hh});return new hi({message:j,statusCode:b,modelId:a.success?a.value.modelId:void 0,cause:d,generationId:k})}default:return new hl({message:j,statusCode:b,cause:d,generationId:k})}}var hq=dI(()=>dL(gB({error:gB({message:f_(),type:f_().nullish(),param:gv().nullish(),code:gE([f_(),gl()]).nullish()}),generationId:f_().nullish()}))),hr="GatewayTimeoutError",hs=Symbol.for(`vercel.ai.gateway.error.${hr}`),ht=class a extends(V=g5,U=hs,V){constructor({message:a="Request timed out",statusCode:b=408,cause:c,generationId:d}={}){super({message:a,statusCode:b,cause:c,generationId:d}),this[U]=!0,this.name=hr,this.type="timeout_error"}static isInstance(a){return g5.hasMarker(a)&&hs in a}static createTimeoutError({originalMessage:b,statusCode:c=408,cause:d,generationId:e}){return new a({message:`Gateway request timed out: ${b}

    This is a client-side timeout. To resolve this, increase your timeout configuration: https://vercel.com/docs/ai-gateway/capabilities/video-generation#extending-timeouts-for-node.js`,statusCode:c,cause:d,generationId:e})}};function hu(a){if(!(a instanceof Error))return!1;let b=a.code;return"string"==typeof b&&["UND_ERR_HEADERS_TIMEOUT","UND_ERR_BODY_TIMEOUT","UND_ERR_CONNECT_TIMEOUT"].includes(b)}async function hv(a,b){var c;return g5.isInstance(a)?a:hu(a)?ht.createTimeoutError({originalMessage:a instanceof Error?a.message:"Unknown error",cause:a}):am.isInstance(a)?a.cause&&hu(a.cause)?ht.createTimeoutError({originalMessage:a.message,cause:a}):await hp({response:function(a){if(void 0!==a.data)return a.data;if(null!=a.responseBody)try{return JSON.parse(a.responseBody)}catch(b){return a.responseBody}return{}}(a),statusCode:null!=(c=a.statusCode)?c:500,defaultMessage:"Gateway request failed",cause:a,authMethod:b}):await hp({response:{},statusCode:500,defaultMessage:a instanceof Error?`Gateway request failed: ${a.message}`:"Unknown Gateway error",cause:a,authMethod:b})}var hw="ai-gateway-auth-method";async function hx(a){let b=await dN({value:a[hw],schema:hy});return b.success?b.value:void 0}var hy=dI(()=>dL(gE([gN("api-key"),gN("oidc")]))),hz=class{constructor(a){this.config=a}async getAvailableModels(){try{let{value:a}=await dh({url:`${this.config.baseURL}/config`,headers:await dX(this.config.headers()),successfulResponseHandler:d$(hA),failedResponseHandler:dY({errorSchema:gt(),errorToMessage:a=>a}),fetch:this.config.fetch});return a}catch(a){throw await hv(a)}}async getCredits(){try{let a=new URL(this.config.baseURL),{value:b}=await dh({url:`${a.origin}/v1/credits`,headers:await dX(this.config.headers()),successfulResponseHandler:d$(hB),failedResponseHandler:dY({errorSchema:gt(),errorToMessage:a=>a}),fetch:this.config.fetch});return b}catch(a){throw await hv(a)}}},hA=dI(()=>dL(gB({models:gz(gB({id:f_(),name:f_(),description:f_().nullish(),pricing:gB({input:f_(),output:f_(),input_cache_read:f_().nullish(),input_cache_write:f_().nullish()}).transform(({input:a,output:b,input_cache_read:c,input_cache_write:d})=>({input:a,output:b,...c?{cachedInputTokens:c}:{},...d?{cacheCreationInputTokens:d}:{}})).nullish(),specification:gB({specificationVersion:gN("v3"),provider:f_(),modelId:f_()}),modelType:gL(["embedding","image","language","video"]).nullish()}))}))),hB=dI(()=>dL(gB({balance:f_(),total_used:f_()}).transform(({balance:a,total_used:b})=>({balance:a,totalUsed:b})))),hC=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v3",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(a){let{abortSignal:b,...c}=a;return{args:this.maybeEncodeFileParts(c),warnings:[]}}async doGenerate(a){let{args:b,warnings:c}=await this.getArgs(a),{abortSignal:d}=a,e=await dX(this.config.headers());try{let{responseHeaders:f,value:g,rawValue:h}=await dT({url:this.getUrl(),headers:cT(e,a.headers,this.getModelConfigHeaders(this.modelId,!1),await dX(this.config.o11yHeaders)),body:b,successfulResponseHandler:d$(gt()),failedResponseHandler:dY({errorSchema:gt(),errorToMessage:a=>a}),...d&&{abortSignal:d},fetch:this.config.fetch});return{...g,request:{body:b},response:{headers:f,body:h},warnings:c}}catch(a){throw await hv(a,await hx(e))}}async doStream(a){let{args:b,warnings:c}=await this.getArgs(a),{abortSignal:d}=a,e=await dX(this.config.headers());try{let{value:f,responseHeaders:g}=await dT({url:this.getUrl(),headers:cT(e,a.headers,this.getModelConfigHeaders(this.modelId,!0),await dX(this.config.o11yHeaders)),body:b,successfulResponseHandler:dZ(gt()),failedResponseHandler:dY({errorSchema:gt(),errorToMessage:a=>a}),...d&&{abortSignal:d},fetch:this.config.fetch});return{stream:f.pipeThrough(new TransformStream({start(a){c.length>0&&a.enqueue({type:"stream-start",warnings:c})},transform(b,c){if(b.success){let d=b.value;("raw"!==d.type||a.includeRawChunks)&&("response-metadata"===d.type&&d.timestamp&&"string"==typeof d.timestamp&&(d.timestamp=new Date(d.timestamp)),c.enqueue(d))}else c.error(b.error)}})),request:{body:b},response:{headers:g}}}catch(a){throw await hv(a,await hx(e))}}isFilePart(a){return a&&"object"==typeof a&&"type"in a&&"file"===a.type}maybeEncodeFileParts(a){for(let b of a.prompt)for(let a of b.content)if(this.isFilePart(a)&&a.data instanceof Uint8Array){let b=Uint8Array.from(a.data),c=Buffer.from(b).toString("base64");a.data=new URL(`data:${a.mediaType||"application/octet-stream"};base64,${c}`)}return a}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(a,b){return{"ai-language-model-specification-version":"3","ai-language-model-id":a,"ai-language-model-streaming":String(b)}}},hD=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v3",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed({values:a,headers:b,abortSignal:c,providerOptions:d}){var e;let f=await dX(this.config.headers());try{let{responseHeaders:g,value:h,rawValue:i}=await dT({url:this.getUrl(),headers:cT(f,null!=b?b:{},this.getModelConfigHeaders(),await dX(this.config.o11yHeaders)),body:{values:a,...d?{providerOptions:d}:{}},successfulResponseHandler:d$(hE),failedResponseHandler:dY({errorSchema:gt(),errorToMessage:a=>a}),...c&&{abortSignal:c},fetch:this.config.fetch});return{embeddings:h.embeddings,usage:null!=(e=h.usage)?e:void 0,providerMetadata:h.providerMetadata,response:{headers:g,body:i},warnings:[]}}catch(a){throw await hv(a,await hx(f))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"3","ai-model-id":this.modelId}}},hE=dI(()=>dL(gB({embeddings:gz(gz(gl())),usage:gB({tokens:gl()}).nullish(),providerMetadata:gJ(f_(),gJ(f_(),gv())).optional()}))),hF=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v3",this.maxImagesPerCall=Number.MAX_SAFE_INTEGER}get provider(){return this.config.provider}async doGenerate({prompt:a,n:b,size:c,aspectRatio:d,seed:e,files:f,mask:g,providerOptions:h,headers:i,abortSignal:j}){var k,l,m,n;let o=await dX(this.config.headers());try{let{responseHeaders:p,value:q,rawValue:r}=await dT({url:this.getUrl(),headers:cT(o,null!=i?i:{},this.getModelConfigHeaders(),await dX(this.config.o11yHeaders)),body:{prompt:a,n:b,...c&&{size:c},...d&&{aspectRatio:d},...e&&{seed:e},...h&&{providerOptions:h},...f&&{files:f.map(a=>hG(a))},...g&&{mask:hG(g)}},successfulResponseHandler:d$(hK),failedResponseHandler:dY({errorSchema:gt(),errorToMessage:a=>a}),...j&&{abortSignal:j},fetch:this.config.fetch});return{images:q.images,warnings:null!=(k=q.warnings)?k:[],providerMetadata:q.providerMetadata,response:{timestamp:new Date,modelId:this.modelId,headers:p},...null!=q.usage&&{usage:{inputTokens:null!=(l=q.usage.inputTokens)?l:void 0,outputTokens:null!=(m=q.usage.outputTokens)?m:void 0,totalTokens:null!=(n=q.usage.totalTokens)?n:void 0}}}}catch(a){throw await hv(a,await hx(o))}}getUrl(){return`${this.config.baseURL}/image-model`}getModelConfigHeaders(){return{"ai-image-model-specification-version":"3","ai-model-id":this.modelId}}};function hG(a){return"file"===a.type&&a.data instanceof Uint8Array?{...a,data:c$(a.data)}:a}var hH=gB({images:gz(gv()).optional()}).catchall(gv()),hI=gG("type",[gB({type:gN("unsupported"),feature:f_(),details:f_().optional()}),gB({type:gN("compatibility"),feature:f_(),details:f_().optional()}),gB({type:gN("other"),message:f_()})]),hJ=gB({inputTokens:gl().nullish(),outputTokens:gl().nullish(),totalTokens:gl().nullish()}),hK=gB({images:gz(f_()),warnings:gz(hI).optional(),providerMetadata:gJ(f_(),hH).optional(),usage:hJ.optional()}),hL=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v3",this.maxVideosPerCall=Number.MAX_SAFE_INTEGER}get provider(){return this.config.provider}async doGenerate({prompt:a,n:b,aspectRatio:c,resolution:d,duration:e,fps:f,seed:g,image:h,providerOptions:i,headers:j,abortSignal:k}){var l,m;let n=await dX(this.config.headers());try{let{responseHeaders:o,value:p,rawValue:q}=await dT({url:this.getUrl(),headers:cT(n,null!=j?j:{},this.getModelConfigHeaders(),await dX(this.config.o11yHeaders)),body:{prompt:a,n:b,...c&&{aspectRatio:c},...d&&{resolution:d},...e&&{duration:e},...f&&{fps:f},...g&&{seed:g},...i&&{providerOptions:i},...h&&{image:(m=h,"file"===m.type&&m.data instanceof Uint8Array?{...m,data:c$(m.data)}:m)}},successfulResponseHandler:d$(hP),failedResponseHandler:dY({errorSchema:gt(),errorToMessage:a=>a}),...k&&{abortSignal:k},fetch:this.config.fetch});return{videos:p.videos,warnings:null!=(l=p.warnings)?l:[],providerMetadata:p.providerMetadata,response:{timestamp:new Date,modelId:this.modelId,headers:o}}}catch(a){throw await hv(a,await hx(n))}}getUrl(){return`${this.config.baseURL}/video-model`}getModelConfigHeaders(){return{"ai-video-model-specification-version":"3","ai-model-id":this.modelId}}},hM=gB({videos:gz(gv()).optional()}).catchall(gv()),hN=gE([gB({type:gN("url"),url:f_(),mediaType:f_()}),gB({type:gN("base64"),data:f_(),mediaType:f_()})]),hO=gG("type",[gB({type:gN("unsupported"),feature:f_(),details:f_().optional()}),gB({type:gN("compatibility"),feature:f_(),details:f_().optional()}),gB({type:gN("other"),message:f_()})]),hP=gB({videos:gz(hN),warnings:gz(hO).optional(),providerMetadata:gJ(f_(),hM).optional()}),hQ=dW({id:"gateway.parallel_search",inputSchema:dI(()=>dL(cN({objective:cK().describe("Natural-language description of the web research goal, including source or freshness guidance and broader context from the task. Maximum 5000 characters."),search_queries:cM(cK()).optional().describe("Optional search queries to supplement the objective. Maximum 200 characters per query."),mode:cP(["one-shot","agentic"]).optional().describe('Mode preset: "one-shot" for comprehensive results with longer excerpts (default), "agentic" for concise, token-efficient results for multi-step workflows.'),max_results:cL().optional().describe("Maximum number of results to return (1-20). Defaults to 10 if not specified."),source_policy:cN({include_domains:cM(cK()).optional().describe("List of domains to include in search results."),exclude_domains:cM(cK()).optional().describe("List of domains to exclude from search results."),after_date:cK().optional().describe("Only include results published after this date (ISO 8601 format).")}).optional().describe("Source policy for controlling which domains to include/exclude and freshness."),excerpts:cN({max_chars_per_result:cL().optional().describe("Maximum characters per result."),max_chars_total:cL().optional().describe("Maximum total characters across all results.")}).optional().describe("Excerpt configuration for controlling result length."),fetch_policy:cN({max_age_seconds:cL().optional().describe("Maximum age in seconds for cached content. Set to 0 to always fetch fresh content.")}).optional().describe("Fetch policy for controlling content freshness.")}))),outputSchema:dI(()=>dL(cO([cN({searchId:cK(),results:cM(cN({url:cK(),title:cK(),excerpt:cK(),publishDate:cK().nullable().optional(),relevanceScore:cL().optional()}))}),cN({error:cP(["api_error","rate_limit","timeout","invalid_input","configuration_error","unknown"]),statusCode:cL().optional(),message:cK()})])))}),hR=dW({id:"gateway.perplexity_search",inputSchema:dI(()=>dL(cN({query:cO([cK(),cM(cK())]).describe("Search query (string) or multiple queries (array of up to 5 strings). Multi-query searches return combined results from all queries."),max_results:cL().optional().describe("Maximum number of search results to return (1-20, default: 10)"),max_tokens_per_page:cL().optional().describe("Maximum number of tokens to extract per search result page (256-2048, default: 2048)"),max_tokens:cL().optional().describe("Maximum total tokens across all search results (default: 25000, max: 1000000)"),country:cK().optional().describe("Two-letter ISO 3166-1 alpha-2 country code for regional search results (e.g., 'US', 'GB', 'FR')"),search_domain_filter:cM(cK()).optional().describe("List of domains to include or exclude from search results (max 20). To include: ['nature.com', 'science.org']. To exclude: ['-example.com', '-spam.net']"),search_language_filter:cM(cK()).optional().describe("List of ISO 639-1 language codes to filter results (max 10, lowercase). Examples: ['en', 'fr', 'de']"),search_after_date:cK().optional().describe("Include only results published after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),search_before_date:cK().optional().describe("Include only results published before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),last_updated_after_filter:cK().optional().describe("Include only results last updated after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),last_updated_before_filter:cK().optional().describe("Include only results last updated before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),search_recency_filter:cP(["day","week","month","year"]).optional().describe("Filter results by relative time period. Cannot be used with search_after_date or search_before_date.")}))),outputSchema:dI(()=>dL(cO([cN({results:cM(cN({title:cK(),url:cK(),snippet:cK(),date:cK().optional(),lastUpdated:cK().optional()})),id:cK()}),cN({error:cP(["api_error","rate_limit","timeout","invalid_input","unknown"]),statusCode:cL().optional(),message:cK()})])))}),hS={parallelSearch:(a={})=>hQ(a),perplexitySearch:(a={})=>hR(a)};async function hT(){var a;return null==(a=(0,g3.getContext)().headers)?void 0:a["x-vercel-id"]}var hU=function(a={}){var b,c;let d=null,e=null,f=null!=(b=a.metadataCacheRefreshMillis)?b:3e5,g=0,h=null!=(c=d_(a.baseURL))?c:"https://ai-gateway.vercel.sh/v3/ai",i=async()=>{try{let b=await hV(a);return de({Authorization:`Bearer ${b.token}`,"ai-gateway-protocol-version":"0.0.1",[hw]:b.authMethod,...a.headers},"ai-sdk/gateway/3.0.47")}catch(a){throw g8.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401,cause:a})}},j=()=>{let a=dj({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),b=dj({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),c=dj({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let d=await hT();return{...a&&{"ai-o11y-deployment-id":a},...b&&{"ai-o11y-environment":b},...c&&{"ai-o11y-region":c},...d&&{"ai-o11y-request-id":d}}}},k=b=>new hC(b,{provider:"gateway",baseURL:h,headers:i,fetch:a.fetch,o11yHeaders:j()}),l=async()=>{var b,c,j;let k=null!=(j=null==(c=null==(b=a._internal)?void 0:b.currentDate)?void 0:c.call(b).getTime())?j:Date.now();return(!d||k-g>f)&&(g=k,d=new hz({baseURL:h,headers:i,fetch:a.fetch}).getAvailableModels().then(a=>(e=a,a)).catch(async a=>{throw await hv(a,await hx(await i()))})),e?Promise.resolve(e):d},m=async()=>new hz({baseURL:h,headers:i,fetch:a.fetch}).getCredits().catch(async a=>{throw await hv(a,await hx(await i()))}),n=function(a){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return k(a)};n.specificationVersion="v3",n.getAvailableModels=l,n.getCredits=m,n.imageModel=b=>new hF(b,{provider:"gateway",baseURL:h,headers:i,fetch:a.fetch,o11yHeaders:j()}),n.languageModel=k;let o=b=>new hD(b,{provider:"gateway",baseURL:h,headers:i,fetch:a.fetch,o11yHeaders:j()});return n.embeddingModel=o,n.textEmbeddingModel=o,n.videoModel=b=>new hL(b,{provider:"gateway",baseURL:h,headers:i,fetch:a.fetch,o11yHeaders:j()}),n.chat=n.languageModel,n.embedding=n.embeddingModel,n.image=n.imageModel,n.video=n.videoModel,n.tools=hS,n}();async function hV(a){let b=dj({settingValue:a.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});return b?{token:b,authMethod:"api-key"}:{token:await (0,g3.getVercelOidcToken)(),authMethod:"oidc"}}var hW=c(69907),hX=c(10470),hY=c(92818),hZ=Object.defineProperty,h$="AI_InvalidArgumentError",h_=`vercel.ai.error.${h$}`,h0=Symbol.for(h_),h1=class extends ai{constructor({parameter:a,value:b,message:c}){super({name:h$,message:`Invalid argument for parameter ${a}: ${c}`}),this[W]=!0,this.parameter=a,this.value=b}static isInstance(a){return ai.hasMarker(a,h_)}};W=h0,Symbol.for("vercel.ai.error.AI_InvalidStreamPartError");var h2="AI_InvalidToolApprovalError",h3=`vercel.ai.error.${h2}`,h4=Symbol.for(h3),h5=class extends ai{constructor({approvalId:a}){super({name:h2,message:`Tool approval response references unknown approvalId: "${a}". No matching tool-approval-request found in message history.`}),this[X]=!0,this.approvalId=a}static isInstance(a){return ai.hasMarker(a,h3)}};X=h4;var h6="AI_InvalidToolInputError",h7=`vercel.ai.error.${h6}`,h8=Symbol.for(h7),h9=class extends ai{constructor({toolInput:a,toolName:b,cause:c,message:d=`Invalid input for tool ${b}: ${ar(c)}`}){super({name:h6,message:d,cause:c}),this[Y]=!0,this.toolInput=a,this.toolName=b}static isInstance(a){return ai.hasMarker(a,h7)}};Y=h8;var ia="AI_ToolCallNotFoundForApprovalError",ib=`vercel.ai.error.${ia}`,ic=Symbol.for(ib),id=class extends ai{constructor({toolCallId:a,approvalId:b}){super({name:ia,message:`Tool call "${a}" not found for approval request "${b}".`}),this[Z]=!0,this.toolCallId=a,this.approvalId=b}static isInstance(a){return ai.hasMarker(a,ib)}};Z=ic;var ie="AI_MissingToolResultsError",ig=`vercel.ai.error.${ie}`,ih=Symbol.for(ig),ii=class extends ai{constructor({toolCallIds:a}){super({name:ie,message:`Tool result${a.length>1?"s are":" is"} missing for tool call${a.length>1?"s":""} ${a.join(", ")}.`}),this[$]=!0,this.toolCallIds=a}static isInstance(a){return ai.hasMarker(a,ig)}};$=ih,Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");var ij="AI_NoObjectGeneratedError",ik=`vercel.ai.error.${ij}`,il=Symbol.for(ik),im=class extends ai{constructor({message:a="No object generated.",cause:b,text:c,response:d,usage:e,finishReason:f}){super({name:ij,message:a,cause:b}),this[_]=!0,this.text=c,this.response=d,this.usage=e,this.finishReason=f}static isInstance(a){return ai.hasMarker(a,ik)}};_=il;var io="AI_NoOutputGeneratedError",ip=`vercel.ai.error.${io}`,iq=Symbol.for(ip),ir=class extends ai{constructor({message:a="No output generated.",cause:b}={}){super({name:io,message:a,cause:b}),this[aa]=!0}static isInstance(a){return ai.hasMarker(a,ip)}};aa=iq,Symbol.for("vercel.ai.error.AI_NoSpeechGeneratedError"),Symbol.for("vercel.ai.error.AI_NoTranscriptGeneratedError"),Symbol.for("vercel.ai.error.AI_NoVideoGeneratedError");var is="AI_NoSuchToolError",it=`vercel.ai.error.${is}`,iu=Symbol.for(it),iv=class extends ai{constructor({toolName:a,availableTools:b,message:c=`Model tried to call unavailable tool '${a}'. ${void 0===b?"No tools are available.":`Available tools: ${b.join(", ")}.`}`}){super({name:is,message:c}),this[ab]=!0,this.toolName=a,this.availableTools=b}static isInstance(a){return ai.hasMarker(a,it)}};ab=iu;var iw="AI_ToolCallRepairError",ix=`vercel.ai.error.${iw}`,iy=Symbol.for(ix),iz=class extends ai{constructor({cause:a,originalError:b,message:c=`Error repairing tool call: ${ar(a)}`}){super({name:iw,message:c,cause:a}),this[ac]=!0,this.originalError=b}static isInstance(a){return ai.hasMarker(a,ix)}};ac=iy;var iA=class extends ai{constructor(a){super({name:"AI_UnsupportedModelVersionError",message:`Unsupported model version ${a.version} for provider "${a.provider}" and model "${a.modelId}". AI SDK 5 only supports models that implement specification version "v2".`}),this.version=a.version,this.provider=a.provider,this.modelId=a.modelId}},iB=(Symbol.for("vercel.ai.error.AI_UIMessageStreamError"),Symbol.for("vercel.ai.error.AI_InvalidDataContentError"),"AI_InvalidMessageRoleError"),iC=`vercel.ai.error.${iB}`,iD=Symbol.for(iC),iE=class extends ai{constructor({role:a,message:b=`Invalid message role: '${a}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:iB,message:b}),this[ad]=!0,this.role=a}static isInstance(a){return ai.hasMarker(a,iC)}};ad=iD,Symbol.for("vercel.ai.error.AI_MessageConversionError");var iF="AI_RetryError",iG=`vercel.ai.error.${iF}`,iH=Symbol.for(iG),iI=class extends ai{constructor({message:a,reason:b,errors:c}){super({name:iF,message:a}),this[ae]=!0,this.reason=b,this.errors=c,this.lastError=c[c.length-1]}static isInstance(a){return ai.hasMarker(a,iG)}};ae=iH;var iJ=!1,iK=a=>{if(0===a.warnings.length)return;let b=globalThis.AI_SDK_LOG_WARNINGS;if(!1!==b){if("function"==typeof b)return void b(a);for(let b of(iJ||(iJ=!0,console.info("AI SDK Warning System: To turn off warning logging, set the AI_SDK_LOG_WARNINGS global to false.")),a.warnings))console.warn(function({warning:a,provider:b,model:c}){let d=`AI SDK Warning (${b} / ${c}):`;switch(a.type){case"unsupported":{let b=`${d} The feature "${a.feature}" is not supported.`;return a.details&&(b+=` ${a.details}`),b}case"compatibility":{let b=`${d} The feature "${a.feature}" is used in a compatibility mode.`;return a.details&&(b+=` ${a.details}`),b}case"other":return`${d} ${a.message}`;default:return`${d} ${JSON.stringify(a,null,2)}`}}({warning:b,provider:a.provider,model:a.model}))}};function iL(a){return{unified:"unknown"===a?"other":a,raw:void 0}}function iM(a){return{inputTokens:{total:a.inputTokens,noCache:void 0,cacheRead:a.cachedInputTokens,cacheWrite:void 0},outputTokens:{total:a.outputTokens,text:void 0,reasoning:a.reasoningTokens}}}function iN(a){var b;if("string"!=typeof a){if("v3"!==a.specificationVersion&&"v2"!==a.specificationVersion)throw new iA({version:a.specificationVersion,provider:a.provider,modelId:a.modelId});return"v3"===a.specificationVersion?a:(!function({provider:a,modelId:b}){iK({warnings:[{type:"compatibility",feature:"specificationVersion",details:"Using v2 specification compatibility mode. Some features may not be available."}],provider:a,model:b})}({provider:a.provider,modelId:a.modelId}),new Proxy(a,{get(a,b){switch(b){case"specificationVersion":return"v3";case"doGenerate":return async(...b)=>{let c=await a.doGenerate(...b);return{...c,finishReason:iL(c.finishReason),usage:iM(c.usage)}};case"doStream":return async(...b)=>{let c=await a.doStream(...b);return{...c,stream:c.stream.pipeThrough(new TransformStream({transform(a,b){"finish"===a.type?b.enqueue({...a,finishReason:iL(a.finishReason),usage:iM(a.usage)}):b.enqueue(a)}}))}};default:return a[b]}}}))}return(null!=(b=globalThis.AI_SDK_DEFAULT_PROVIDER)?b:hU).languageModel(a)}function iO(a){if(null!=a)return"number"==typeof a?a:a.totalMs}var iP=[{mediaType:"image/gif",bytesPrefix:[71,73,70]},{mediaType:"image/png",bytesPrefix:[137,80,78,71]},{mediaType:"image/jpeg",bytesPrefix:[255,216]},{mediaType:"image/webp",bytesPrefix:[82,73,70,70,null,null,null,null,87,69,66,80]},{mediaType:"image/bmp",bytesPrefix:[66,77]},{mediaType:"image/tiff",bytesPrefix:[73,73,42,0]},{mediaType:"image/tiff",bytesPrefix:[77,77,0,42]},{mediaType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102]},{mediaType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99]}],iQ="6.0.87",iR=async({url:a,maxBytes:b,abortSignal:c})=>{var d;let e=a.toString();try{let a=await fetch(e,{headers:de({},`ai-sdk/${iQ}`,dd()),signal:c});if(!a.ok)throw new c3({url:e,statusCode:a.status,statusText:a.statusText});return{data:await c4({response:a,url:e,maxBytes:null!=b?b:0x80000000}),mediaType:null!=(d=a.headers.get("content-type"))?d:void 0}}catch(a){if(c3.isInstance(a))throw a;throw new c3({url:e,cause:a})}},iS=gE([f_(),g2(Uint8Array),g2(ArrayBuffer),g1(a=>{var b,c;return null!=(c=null==(b=globalThis.Buffer)?void 0:b.isBuffer(a))&&c},{message:"Must be a Buffer"})]);function iT(a){if(a instanceof Uint8Array)return{data:a,mediaType:void 0};if(a instanceof ArrayBuffer)return{data:new Uint8Array(a),mediaType:void 0};if("string"==typeof a)try{a=new URL(a)}catch(a){}if(a instanceof URL&&"data:"===a.protocol){let{mediaType:b,base64Content:c}=function(a){try{let[b,c]=a.split(",");return{mediaType:b.split(";")[0].split(":")[1],base64Content:c}}catch(a){return{mediaType:void 0,base64Content:void 0}}}(a.toString());if(null==b||null==c)throw new ai({name:"InvalidDataContentError",message:`Invalid data URL format in content ${a.toString()}`});return{data:c,mediaType:b}}return{data:a,mediaType:void 0}}function iU(a){return void 0===a?[]:Array.isArray(a)?a:[a]}async function iV({prompt:a,supportedUrls:b,download:c=((a=iR)=>b=>Promise.all(b.map(async b=>b.isUrlSupportedByModel?null:a(b))))()}){let d=await iW(a.messages,c,b),e=new Map;for(let b of a.messages)if("assistant"===b.role&&Array.isArray(b.content))for(let a of b.content)"tool-approval-request"===a.type&&"approvalId"in a&&"toolCallId"in a&&e.set(a.approvalId,a.toolCallId);let f=new Set;for(let b of a.messages)if("tool"===b.role){for(let a of b.content)if("tool-approval-response"===a.type){let b=e.get(a.approvalId);b&&f.add(b)}}let g=[...null!=a.system?"string"==typeof a.system?[{role:"system",content:a.system}]:iU(a.system).map(a=>({role:"system",content:a.content,providerOptions:a.providerOptions})):[],...a.messages.map(a=>(function({message:a,downloadedAssets:b}){let c=a.role;switch(c){case"system":return{role:"system",content:a.content,providerOptions:a.providerOptions};case"user":if("string"==typeof a.content)return{role:"user",content:[{type:"text",text:a.content}],providerOptions:a.providerOptions};return{role:"user",content:a.content.map(a=>(function(a,b){var c;let d;if("text"===a.type)return{type:"text",text:a.text,providerOptions:a.providerOptions};let e=a.type;switch(e){case"image":d=a.image;break;case"file":d=a.data;break;default:throw Error(`Unsupported part type: ${e}`)}let{data:f,mediaType:g}=iT(d),h=null!=g?g:a.mediaType,i=f;if(i instanceof URL){let a=b[i.toString()];a&&(i=a.data,null!=h||(h=a.mediaType))}switch(e){case"image":return(i instanceof Uint8Array||"string"==typeof i)&&(h=null!=(c=function({data:a,signatures:b}){let c="string"==typeof a&&a.startsWith("SUQz")||"string"!=typeof a&&a.length>10&&73===a[0]&&68===a[1]&&51===a[2]?(a=>{let b="string"==typeof a?cZ(a):a,c=(127&b[6])<<21|(127&b[7])<<14|(127&b[8])<<7|127&b[9];return b.slice(c+10)})(a):a,d="string"==typeof c?cZ(c.substring(0,Math.min(c.length,24))):c;for(let a of b)if(d.length>=a.bytesPrefix.length&&a.bytesPrefix.every((a,b)=>null===a||d[b]===a))return a.mediaType}({data:i,signatures:iP}))?c:h),{type:"file",mediaType:null!=h?h:"image/*",filename:void 0,data:i,providerOptions:a.providerOptions};case"file":if(null==h)throw Error("Media type is missing for file part");return{type:"file",mediaType:h,filename:a.filename,data:i,providerOptions:a.providerOptions}}})(a,b)).filter(a=>"text"!==a.type||""!==a.text),providerOptions:a.providerOptions};case"assistant":if("string"==typeof a.content)return{role:"assistant",content:[{type:"text",text:a.content}],providerOptions:a.providerOptions};return{role:"assistant",content:a.content.filter(a=>"text"!==a.type||""!==a.text||null!=a.providerOptions).filter(a=>"tool-approval-request"!==a.type).map(a=>{let b=a.providerOptions;switch(a.type){case"file":{let{data:c,mediaType:d}=iT(a.data);return{type:"file",data:c,filename:a.filename,mediaType:null!=d?d:a.mediaType,providerOptions:b}}case"reasoning":return{type:"reasoning",text:a.text,providerOptions:b};case"text":return{type:"text",text:a.text,providerOptions:b};case"tool-call":return{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,providerExecuted:a.providerExecuted,providerOptions:b};case"tool-result":return{type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:iX(a.output),providerOptions:b}}}),providerOptions:a.providerOptions};case"tool":return{role:"tool",content:a.content.filter(a=>"tool-approval-response"!==a.type||a.providerExecuted).map(a=>{switch(a.type){case"tool-result":return{type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:iX(a.output),providerOptions:a.providerOptions};case"tool-approval-response":return{type:"tool-approval-response",approvalId:a.approvalId,approved:a.approved,reason:a.reason}}}),providerOptions:a.providerOptions};default:throw new iE({role:c})}})({message:a,downloadedAssets:d}))],h=[];for(let a of g){if("tool"!==a.role){h.push(a);continue}let b=h.at(-1);(null==b?void 0:b.role)==="tool"?b.content.push(...a.content):h.push(a)}let i=new Set;for(let a of h)switch(a.role){case"assistant":for(let b of a.content)"tool-call"!==b.type||b.providerExecuted||i.add(b.toolCallId);break;case"tool":for(let b of a.content)"tool-result"===b.type&&i.delete(b.toolCallId);break;case"user":case"system":for(let a of f)i.delete(a);if(i.size>0)throw new ii({toolCallIds:Array.from(i)})}for(let a of f)i.delete(a);if(i.size>0)throw new ii({toolCallIds:Array.from(i)});return h.filter(a=>"tool"!==a.role||a.content.length>0)}async function iW(a,b,c){let d=a.filter(a=>"user"===a.role).map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>"image"===a.type||"file"===a.type).map(a=>{var b;let c=null!=(b=a.mediaType)?b:"image"===a.type?"image/*":void 0,d="image"===a.type?a.image:a.data;if("string"==typeof d)try{d=new URL(d)}catch(a){}return{mediaType:c,data:d}}).filter(a=>a.data instanceof URL).map(a=>({url:a.data,isUrlSupportedByModel:null!=a.mediaType&&function({mediaType:a,url:b,supportedUrls:c}){return b=b.toLowerCase(),a=a.toLowerCase(),Object.entries(c).map(([a,b])=>{let c=a.toLowerCase();return"*"===c||"*/*"===c?{mediaTypePrefix:"",regexes:b}:{mediaTypePrefix:c.replace(/\*/,""),regexes:b}}).filter(({mediaTypePrefix:b})=>a.startsWith(b)).flatMap(({regexes:a})=>a).some(a=>a.test(b))}({url:a.data.toString(),mediaType:a.mediaType,supportedUrls:c})}));return Object.fromEntries((await b(d)).map((a,b)=>null==a?null:[d[b].url.toString(),{data:a.data,mediaType:a.mediaType}]).filter(a=>null!=a))}function iX(a){return"content"!==a.type?a:{type:"content",value:a.value.map(a=>"media"!==a.type?a:a.mediaType.startsWith("image/")?{type:"image-data",data:a.data,mediaType:a.mediaType}:{type:"file-data",data:a.data,mediaType:a.mediaType})}}async function iY({toolCallId:a,input:b,output:c,tool:d,errorMode:e}){return"text"===e?{type:"error-text",value:ar(c)}:"json"===e?{type:"error-json",value:iZ(c)}:(null==d?void 0:d.toModelOutput)?await d.toModelOutput({toolCallId:a,input:b,output:c}):"string"==typeof c?{type:"text",value:c}:{type:"json",value:iZ(c)}}function iZ(a){return void 0===a?null:a}function i$({maxOutputTokens:a,temperature:b,topP:c,topK:d,presencePenalty:e,frequencyPenalty:f,seed:g,stopSequences:h}){if(null!=a){if(!Number.isInteger(a))throw new h1({parameter:"maxOutputTokens",value:a,message:"maxOutputTokens must be an integer"});if(a<1)throw new h1({parameter:"maxOutputTokens",value:a,message:"maxOutputTokens must be >= 1"})}if(null!=b&&"number"!=typeof b)throw new h1({parameter:"temperature",value:b,message:"temperature must be a number"});if(null!=c&&"number"!=typeof c)throw new h1({parameter:"topP",value:c,message:"topP must be a number"});if(null!=d&&"number"!=typeof d)throw new h1({parameter:"topK",value:d,message:"topK must be a number"});if(null!=e&&"number"!=typeof e)throw new h1({parameter:"presencePenalty",value:e,message:"presencePenalty must be a number"});if(null!=f&&"number"!=typeof f)throw new h1({parameter:"frequencyPenalty",value:f,message:"frequencyPenalty must be a number"});if(null!=g&&!Number.isInteger(g))throw new h1({parameter:"seed",value:g,message:"seed must be an integer"});return{maxOutputTokens:a,temperature:b,topP:c,topK:d,presencePenalty:e,frequencyPenalty:f,stopSequences:h,seed:g}}async function i_({tools:a,toolChoice:b,activeTools:c}){if(!(null!=a&&Object.keys(a).length>0))return{tools:void 0,toolChoice:void 0};let d=null!=c?Object.entries(a).filter(([a])=>c.includes(a)):Object.entries(a),e=[];for(let[a,b]of d){let c=b.type;switch(c){case void 0:case"dynamic":case"function":e.push({type:"function",name:a,description:b.description,inputSchema:await dK(b.inputSchema).jsonSchema,...null!=b.inputExamples?{inputExamples:b.inputExamples}:{},providerOptions:b.providerOptions,...null!=b.strict?{strict:b.strict}:{}});break;case"provider":e.push({type:"provider",name:a,id:b.id,args:b.args});break;default:throw Error(`Unsupported tool type: ${c}`)}}return{tools:e,toolChoice:null==b?{type:"auto"}:"string"==typeof b?{type:b}:{type:"tool",toolName:b.toolName}}}var i0=g_(()=>gE([gr(),f_(),gl(),gp(),gJ(f_(),i0.optional()),gz(i0)])),i1=gJ(f_(),gJ(f_(),i0.optional())),i2=gB({type:gN("text"),text:f_(),providerOptions:i1.optional()}),i3=gB({type:gN("image"),image:gE([iS,g2(URL)]),mediaType:f_().optional(),providerOptions:i1.optional()}),i4=gB({type:gN("file"),data:gE([iS,g2(URL)]),filename:f_().optional(),mediaType:f_(),providerOptions:i1.optional()}),i5=gB({type:gN("reasoning"),text:f_(),providerOptions:i1.optional()}),i6=gB({type:gN("tool-call"),toolCallId:f_(),toolName:f_(),input:gv(),providerOptions:i1.optional(),providerExecuted:gp().optional()}),i7=gG("type",[gB({type:gN("text"),value:f_(),providerOptions:i1.optional()}),gB({type:gN("json"),value:i0,providerOptions:i1.optional()}),gB({type:gN("execution-denied"),reason:f_().optional(),providerOptions:i1.optional()}),gB({type:gN("error-text"),value:f_(),providerOptions:i1.optional()}),gB({type:gN("error-json"),value:i0,providerOptions:i1.optional()}),gB({type:gN("content"),value:gz(gE([gB({type:gN("text"),text:f_(),providerOptions:i1.optional()}),gB({type:gN("media"),data:f_(),mediaType:f_()}),gB({type:gN("file-data"),data:f_(),mediaType:f_(),filename:f_().optional(),providerOptions:i1.optional()}),gB({type:gN("file-url"),url:f_(),providerOptions:i1.optional()}),gB({type:gN("file-id"),fileId:gE([f_(),gJ(f_(),f_())]),providerOptions:i1.optional()}),gB({type:gN("image-data"),data:f_(),mediaType:f_(),providerOptions:i1.optional()}),gB({type:gN("image-url"),url:f_(),providerOptions:i1.optional()}),gB({type:gN("image-file-id"),fileId:gE([f_(),gJ(f_(),f_())]),providerOptions:i1.optional()}),gB({type:gN("custom"),providerOptions:i1.optional()})]))})]),i8=gB({type:gN("tool-result"),toolCallId:f_(),toolName:f_(),output:i7,providerOptions:i1.optional()}),i9=gB({type:gN("tool-approval-request"),approvalId:f_(),toolCallId:f_()}),ja=gB({type:gN("tool-approval-response"),approvalId:f_(),approved:gp(),reason:f_().optional()}),jb=gB({role:gN("system"),content:f_(),providerOptions:i1.optional()}),jc=gB({role:gN("user"),content:gE([f_(),gz(gE([i2,i3,i4]))]),providerOptions:i1.optional()}),jd=gB({role:gN("assistant"),content:gE([f_(),gz(gE([i2,i4,i5,i6,i8,i9]))]),providerOptions:i1.optional()}),je=gB({role:gN("tool"),content:gz(gE([i8,ja])),providerOptions:i1.optional()}),jf=gE([jb,jc,jd,je]);async function jg(a){let b;if(null==a.prompt&&null==a.messages)throw new az({prompt:a,message:"prompt or messages must be defined"});if(null!=a.prompt&&null!=a.messages)throw new az({prompt:a,message:"prompt and messages cannot be defined at the same time"});if(null!=a.system&&"string"!=typeof a.system&&!iU(a.system).every(a=>"object"==typeof a&&null!==a&&"role"in a&&"system"===a.role))throw new az({prompt:a,message:"system must be a string, SystemModelMessage, or array of SystemModelMessage"});if(null!=a.prompt&&"string"==typeof a.prompt)b=[{role:"user",content:a.prompt}];else if(null!=a.prompt&&Array.isArray(a.prompt))b=a.prompt;else if(null!=a.messages)b=a.messages;else throw new az({prompt:a,message:"prompt or messages must be defined"});if(0===b.length)throw new az({prompt:a,message:"messages must not be empty"});let c=await dN({value:b,schema:gz(jf)});if(!c.success)throw new az({prompt:a,message:"The messages do not match the ModelMessage[] schema.",cause:c.error});return{messages:b,system:a.system}}function jh({operationId:a,telemetry:b}){return{"operation.name":`${a}${(null==b?void 0:b.functionId)!=null?` ${b.functionId}`:""}`,"resource.name":null==b?void 0:b.functionId,"ai.operationId":a,"ai.telemetry.functionId":null==b?void 0:b.functionId}}var ji={startSpan:()=>jj,startActiveSpan:(a,b,c,d)=>"function"==typeof b?b(jj):"function"==typeof c?c(jj):"function"==typeof d?d(jj):void 0},jj={spanContext:()=>jk,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},jk={traceId:"",spanId:"",traceFlags:0};async function jl({name:a,tracer:b,attributes:c,fn:d,endWhenDone:e=!0}){return b.startActiveSpan(a,{attributes:await c},async a=>{let b=hX._.active();try{let c=await hX._.with(b,()=>d(a));return e&&a.end(),c}catch(b){try{jm(a,b)}finally{a.end()}throw b}})}function jm(a,b){b instanceof Error?(a.recordException({name:b.name,message:b.message,stack:b.stack}),a.setStatus({code:hY.s.ERROR,message:b.message})):a.setStatus({code:hY.s.ERROR})}async function jn({telemetry:a,attributes:b}){if((null==a?void 0:a.isEnabled)!==!0)return{};let c={};for(let[d,e]of Object.entries(b))if(null!=e){if("object"==typeof e&&"input"in e&&"function"==typeof e.input){if((null==a?void 0:a.recordInputs)===!1)continue;let b=await e.input();null!=b&&(c[d]=b);continue}if("object"==typeof e&&"output"in e&&"function"==typeof e.output){if((null==a?void 0:a.recordOutputs)===!1)continue;let b=await e.output();null!=b&&(c[d]=b);continue}c[d]=e}return c}function jo(a,b){return null==a&&null==b?void 0:(null!=a?a:0)+(null!=b?b:0)}async function jp(a,{maxRetries:b,delayInMs:c,backoffFactor:d,abortSignal:e},f=[]){try{return await a()}catch(j){if(c9(j)||0===b)throw j;let g=c8(j),h=[...f,j],i=h.length;if(i>b)throw new iI({message:`Failed after ${i} attempts. Last error: ${g}`,reason:"maxRetriesExceeded",errors:h});if(j instanceof Error&&am.isInstance(j)&&!0===j.isRetryable&&i<=b)return await cU(function({error:a,exponentialBackoffDelay:b}){let c,d=a.responseHeaders;if(!d)return b;let e=d["retry-after-ms"];if(e){let a=parseFloat(e);Number.isNaN(a)||(c=a)}let f=d["retry-after"];if(f&&void 0===c){let a=parseFloat(f);c=Number.isNaN(a)?Date.parse(f)-Date.now():1e3*a}return null!=c&&!Number.isNaN(c)&&0<=c&&(c<6e4||c<b)?c:b}({error:j,exponentialBackoffDelay:c}),{abortSignal:e}),jp(a,{maxRetries:b,delayInMs:d*c,backoffFactor:d,abortSignal:e},h);if(1===i)throw j;throw new iI({message:`Failed after ${i} attempts with non-retryable error: '${g}'`,reason:"errorNotRetryable",errors:h})}}async function jq({toolCall:a,tools:b,tracer:c,telemetry:d,messages:e,abortSignal:f,experimental_context:g,onPreliminaryToolResult:h}){let{toolName:i,toolCallId:j,input:k}=a,l=null==b?void 0:b[i];if((null==l?void 0:l.execute)!=null)return jl({name:"ai.toolCall",attributes:jn({telemetry:d,attributes:{...jh({operationId:"ai.toolCall",telemetry:d}),"ai.toolCall.name":i,"ai.toolCall.id":j,"ai.toolCall.args":{output:()=>JSON.stringify(k)}}}),tracer:c,fn:async b=>{let c;try{for await(let b of d0({execute:l.execute.bind(l),input:k,options:{toolCallId:j,messages:e,abortSignal:f,experimental_context:g}}))"preliminary"===b.type?null==h||h({...a,type:"tool-result",output:b.output,preliminary:!0}):c=b.output}catch(c){return jm(b,c),{type:"tool-error",toolCallId:j,toolName:i,input:k,error:c,dynamic:"dynamic"===l.type,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}}}try{b.setAttributes(await jn({telemetry:d,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(c)}}}))}catch(a){}return{type:"tool-result",toolCallId:j,toolName:i,input:k,output:c,dynamic:"dynamic"===l.type,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}}}})}function jr(a){let b=a.filter(a=>"reasoning"===a.type);return 0===b.length?void 0:b.map(a=>a.text).join("\n")}function js(a){let b=a.filter(a=>"text"===a.type);if(0!==b.length)return b.map(a=>a.text).join("")}var jt=class{constructor({data:a,mediaType:b}){let c=a instanceof Uint8Array;this.base64Data=c?void 0:a,this.uint8ArrayData=c?a:void 0,this.mediaType=b}get base64(){return null==this.base64Data&&(this.base64Data=c$(this.uint8ArrayData)),this.base64Data}get uint8Array(){return null==this.uint8ArrayData&&(this.uint8ArrayData=cZ(this.base64Data)),this.uint8ArrayData}};async function ju({tool:a,toolCall:b,messages:c,experimental_context:d}){return null!=a.needsApproval&&("boolean"==typeof a.needsApproval?a.needsApproval:await a.needsApproval(b.input,{toolCallId:b.toolCallId,messages:c,experimental_context:d}))}async function jv(a){if(void 0===a)return{value:void 0,state:"undefined-input"};let b=await dP({text:a});return b.success?{value:b.value,state:"successful-parse"}:(b=await dP({text:function(a){let b=["ROOT"],c=-1,d=null;function e(a,e,f){switch(a){case'"':c=e,b.pop(),b.push(f),b.push("INSIDE_STRING");break;case"f":case"t":case"n":c=e,d=e,b.pop(),b.push(f),b.push("INSIDE_LITERAL");break;case"-":b.pop(),b.push(f),b.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c=e,b.pop(),b.push(f),b.push("INSIDE_NUMBER");break;case"{":c=e,b.pop(),b.push(f),b.push("INSIDE_OBJECT_START");break;case"[":c=e,b.pop(),b.push(f),b.push("INSIDE_ARRAY_START")}}function f(a,d){switch(a){case",":b.pop(),b.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":c=d,b.pop()}}function g(a,d){switch(a){case",":b.pop(),b.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":c=d,b.pop()}}for(let h=0;h<a.length;h++){let i=a[h];switch(b[b.length-1]){case"ROOT":e(i,h,"FINISH");break;case"INSIDE_OBJECT_START":switch(i){case'"':b.pop(),b.push("INSIDE_OBJECT_KEY");break;case"}":c=h,b.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===i&&(b.pop(),b.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===i&&(b.pop(),b.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===i&&(b.pop(),b.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":e(i,h,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":f(i,h);break;case"INSIDE_STRING":switch(i){case'"':b.pop(),c=h;break;case"\\":b.push("INSIDE_STRING_ESCAPE");break;default:c=h}break;case"INSIDE_ARRAY_START":"]"===i?(c=h,b.pop()):(c=h,e(i,h,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(i){case",":b.pop(),b.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":c=h,b.pop();break;default:c=h}break;case"INSIDE_ARRAY_AFTER_COMMA":e(i,h,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":b.pop(),c=h;break;case"INSIDE_NUMBER":switch(i){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c=h;break;case"e":case"E":case"-":case".":break;case",":b.pop(),"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]&&f(i,h);break;case"}":b.pop(),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]&&f(i,h);break;case"]":b.pop(),"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h);break;default:b.pop()}break;case"INSIDE_LITERAL":{let e=a.substring(d,h+1);"false".startsWith(e)||"true".startsWith(e)||"null".startsWith(e)?c=h:(b.pop(),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]?f(i,h):"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h))}}}let h=a.slice(0,c+1);for(let c=b.length-1;c>=0;c--)switch(b[c]){case"INSIDE_STRING":h+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":h+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":h+="]";break;case"INSIDE_LITERAL":{let b=a.substring(d,a.length);"true".startsWith(b)?h+="true".slice(b.length):"false".startsWith(b)?h+="false".slice(b.length):"null".startsWith(b)&&(h+="null".slice(b.length))}}return h}(a)})).success?{value:b.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}((a,b)=>{for(var c in b)hZ(a,c,{get:b[c],enumerable:!0})})({},{array:()=>jy,choice:()=>jz,json:()=>jA,object:()=>jx,text:()=>jw});var jw=()=>({name:"text",responseFormat:Promise.resolve({type:"text"}),parseCompleteOutput:async({text:a})=>a,parsePartialOutput:async({text:a})=>({partial:a}),createElementStreamTransform(){}}),jx=({schema:a,name:b,description:c})=>{let d=dK(a);return{name:"object",responseFormat:dX(d.jsonSchema).then(a=>({type:"json",schema:a,...null!=b&&{name:b},...null!=c&&{description:c}})),async parseCompleteOutput({text:a},b){let c=await dP({text:a});if(!c.success)throw new im({message:"No object generated: could not parse the response.",cause:c.error,text:a,response:b.response,usage:b.usage,finishReason:b.finishReason});let e=await dN({value:c.value,schema:d});if(!e.success)throw new im({message:"No object generated: response did not match schema.",cause:e.error,text:a,response:b.response,usage:b.usage,finishReason:b.finishReason});return e.value},async parsePartialOutput({text:a}){let b=await jv(a);switch(b.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:b.value}}},createElementStreamTransform(){}}},jy=({element:a,name:b,description:c})=>{let d=dK(a);return{name:"array",responseFormat:dX(d.jsonSchema).then(a=>{let{$schema:d,...e}=a;return{type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:e}},required:["elements"],additionalProperties:!1},...null!=b&&{name:b},...null!=c&&{description:c}}}),async parseCompleteOutput({text:a},b){let c=await dP({text:a});if(!c.success)throw new im({message:"No object generated: could not parse the response.",cause:c.error,text:a,response:b.response,usage:b.usage,finishReason:b.finishReason});let e=c.value;if(null==e||"object"!=typeof e||!("elements"in e)||!Array.isArray(e.elements))throw new im({message:"No object generated: response did not match schema.",cause:new aU({value:e,cause:"response must be an object with an elements array"}),text:a,response:b.response,usage:b.usage,finishReason:b.finishReason});for(let c of e.elements){let e=await dN({value:c,schema:d});if(!e.success)throw new im({message:"No object generated: response did not match schema.",cause:e.error,text:a,response:b.response,usage:b.usage,finishReason:b.finishReason})}return e.elements},async parsePartialOutput({text:a}){let b=await jv(a);switch(b.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let a=b.value;if(null==a||"object"!=typeof a||!("elements"in a)||!Array.isArray(a.elements))return;let c="repaired-parse"===b.state&&a.elements.length>0?a.elements.slice(0,-1):a.elements,e=[];for(let a of c){let b=await dN({value:a,schema:d});b.success&&e.push(b.value)}return{partial:e}}}},createElementStreamTransform(){let a=0;return new TransformStream({transform({partialOutput:b},c){if(null!=b)for(;a<b.length;a++)c.enqueue(b[a])}})}}},jz=({options:a,name:b,description:c})=>({name:"choice",responseFormat:Promise.resolve({type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:a}},required:["result"],additionalProperties:!1},...null!=b&&{name:b},...null!=c&&{description:c}}),async parseCompleteOutput({text:b},c){let d=await dP({text:b});if(!d.success)throw new im({message:"No object generated: could not parse the response.",cause:d.error,text:b,response:c.response,usage:c.usage,finishReason:c.finishReason});let e=d.value;if(null==e||"object"!=typeof e||!("result"in e)||"string"!=typeof e.result||!a.includes(e.result))throw new im({message:"No object generated: response did not match schema.",cause:new aU({value:e,cause:"response must be an object that contains a choice value."}),text:b,response:c.response,usage:c.usage,finishReason:c.finishReason});return e.result},async parsePartialOutput({text:b}){let c=await jv(b);switch(c.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let b=c.value;if(null==b||"object"!=typeof b||!("result"in b)||"string"!=typeof b.result)return;let d=a.filter(a=>a.startsWith(b.result));if("successful-parse"===c.state)return d.includes(b.result)?{partial:b.result}:void 0;return 1===d.length?{partial:d[0]}:void 0}}},createElementStreamTransform(){}}),jA=({name:a,description:b}={})=>({name:"json",responseFormat:Promise.resolve({type:"json",...null!=a&&{name:a},...null!=b&&{description:b}}),async parseCompleteOutput({text:a},b){let c=await dP({text:a});if(!c.success)throw new im({message:"No object generated: could not parse the response.",cause:c.error,text:a,response:b.response,usage:b.usage,finishReason:b.finishReason});return c.value},async parsePartialOutput({text:a}){let b=await jv(a);switch(b.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return void 0===b.value?void 0:{partial:b.value}}},createElementStreamTransform(){}});async function jB({toolCall:a,tools:b,repairToolCall:c,system:d,messages:e}){var f;try{if(null==b){if(a.providerExecuted&&a.dynamic)return await jC(a);throw new iv({toolName:a.toolName})}try{return await jD({toolCall:a,tools:b})}catch(g){if(null==c||!(iv.isInstance(g)||h9.isInstance(g)))throw g;let f=null;try{f=await c({toolCall:a,tools:b,inputSchema:async({toolName:a})=>{let{inputSchema:c}=b[a];return await dK(c).jsonSchema},system:d,messages:e,error:g})}catch(a){throw new iz({cause:a,originalError:g})}if(null==f)throw g;return await jD({toolCall:f,tools:b})}}catch(e){let c=await dP({text:a.input}),d=c.success?c.value:a.input;return{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:d,dynamic:!0,invalid:!0,error:e,title:null==(f=null==b?void 0:b[a.toolName])?void 0:f.title,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata}}}async function jC(a){let b=""===a.input.trim()?{success:!0,value:{}}:await dP({text:a.input});if(!1===b.success)throw new h9({toolName:a.toolName,toolInput:a.input,cause:b.error});return{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:b.value,providerExecuted:!0,dynamic:!0,providerMetadata:a.providerMetadata}}async function jD({toolCall:a,tools:b}){let c=a.toolName,d=b[c];if(null==d){if(a.providerExecuted&&a.dynamic)return await jC(a);throw new iv({toolName:a.toolName,availableTools:Object.keys(b)})}let e=dK(d.inputSchema),f=""===a.input.trim()?await dN({value:{},schema:e}):await dP({text:a.input,schema:e});if(!1===f.success)throw new h9({toolName:c,toolInput:a.input,cause:f.error});return"dynamic"===d.type?{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:f.value,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata,dynamic:!0,title:d.title}:{type:"tool-call",toolCallId:a.toolCallId,toolName:c,input:f.value,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata,title:d.title}}var jE=class{constructor({content:a,finishReason:b,rawFinishReason:c,usage:d,warnings:e,request:f,response:g,providerMetadata:h}){this.content=a,this.finishReason=b,this.rawFinishReason=c,this.usage=d,this.warnings=e,this.request=f,this.response=g,this.providerMetadata=h}get text(){return this.content.filter(a=>"text"===a.type).map(a=>a.text).join("")}get reasoning(){return this.content.filter(a=>"reasoning"===a.type)}get reasoningText(){return 0===this.reasoning.length?void 0:this.reasoning.map(a=>a.text).join("")}get files(){return this.content.filter(a=>"file"===a.type).map(a=>a.file)}get sources(){return this.content.filter(a=>"source"===a.type)}get toolCalls(){return this.content.filter(a=>"tool-call"===a.type)}get staticToolCalls(){return this.toolCalls.filter(a=>!0!==a.dynamic)}get dynamicToolCalls(){return this.toolCalls.filter(a=>!0===a.dynamic)}get toolResults(){return this.content.filter(a=>"tool-result"===a.type)}get staticToolResults(){return this.toolResults.filter(a=>!0!==a.dynamic)}get dynamicToolResults(){return this.toolResults.filter(a=>!0===a.dynamic)}};async function jF({stopConditions:a,steps:b}){return(await Promise.all(a.map(a=>a({steps:b})))).some(a=>a)}async function jG({content:a,tools:b}){let c=[],d=[];for(let c of a)if("source"!==c.type&&("tool-result"!==c.type&&"tool-error"!==c.type||c.providerExecuted)&&("text"!==c.type||0!==c.text.length))switch(c.type){case"text":d.push({type:"text",text:c.text,providerOptions:c.providerMetadata});break;case"reasoning":d.push({type:"reasoning",text:c.text,providerOptions:c.providerMetadata});break;case"file":d.push({type:"file",data:c.file.base64,mediaType:c.file.mediaType,providerOptions:c.providerMetadata});break;case"tool-call":d.push({type:"tool-call",toolCallId:c.toolCallId,toolName:c.toolName,input:c.input,providerExecuted:c.providerExecuted,providerOptions:c.providerMetadata});break;case"tool-result":{let a=await iY({toolCallId:c.toolCallId,input:c.input,tool:null==b?void 0:b[c.toolName],output:c.output,errorMode:"none"});d.push({type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,output:a,providerOptions:c.providerMetadata});break}case"tool-error":{let a=await iY({toolCallId:c.toolCallId,input:c.input,tool:null==b?void 0:b[c.toolName],output:c.error,errorMode:"json"});d.push({type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,output:a,providerOptions:c.providerMetadata});break}case"tool-approval-request":d.push({type:"tool-approval-request",approvalId:c.approvalId,toolCallId:c.toolCall.toolCallId})}d.length>0&&c.push({role:"assistant",content:d});let e=[];for(let c of a){if("tool-result"!==c.type&&"tool-error"!==c.type||c.providerExecuted)continue;let a=await iY({toolCallId:c.toolCallId,input:c.input,tool:null==b?void 0:b[c.toolName],output:"tool-result"===c.type?c.output:c.error,errorMode:"tool-error"===c.type?"text":"none"});e.push({type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,output:a,...null!=c.providerMetadata?{providerOptions:c.providerMetadata}:{}})}return e.length>0&&c.push({role:"tool",content:e}),c}var jH=c6({prefix:"aitxt",size:24});async function jI({model:a,tools:b,toolChoice:c,system:d,prompt:e,messages:f,maxRetries:g,abortSignal:h,timeout:i,headers:j,stopWhen:k=function(a){return({steps:a})=>1===a.length}(0),experimental_output:l,output:m=l,experimental_telemetry:n,providerOptions:o,experimental_activeTools:p,activeTools:q=p,experimental_prepareStep:r,prepareStep:s=r,experimental_repairToolCall:t,experimental_download:u,experimental_context:v,experimental_include:w,_internal:{generateId:x=jH}={},onStepFinish:y,onFinish:z,...A}){let B=iN(a),C=iU(k),D=iO(i),E=function(a){if(null!=a&&"number"!=typeof a)return a.stepMs}(i),F=null!=E?new AbortController:void 0,G=function(...a){let b=a.filter(a=>null!=a);if(0===b.length)return;if(1===b.length)return b[0];let c=new AbortController;for(let a of b){if(a.aborted){c.abort(a.reason);break}a.addEventListener("abort",()=>{c.abort(a.reason)},{once:!0})}return c.signal}(h,null!=D?AbortSignal.timeout(D):void 0,null==F?void 0:F.signal),{maxRetries:H,retry:I}=function({maxRetries:a,abortSignal:b}){if(null!=a){if(!Number.isInteger(a))throw new h1({parameter:"maxRetries",value:a,message:"maxRetries must be an integer"});if(a<0)throw new h1({parameter:"maxRetries",value:a,message:"maxRetries must be >= 0"})}let c=null!=a?a:2;return{maxRetries:c,retry:(({maxRetries:a=2,initialDelayInMs:b=2e3,backoffFactor:c=2,abortSignal:d}={})=>async e=>jp(e,{maxRetries:a,delayInMs:b,backoffFactor:c,abortSignal:d}))({maxRetries:c,abortSignal:b})}}({maxRetries:g,abortSignal:G}),J=i$(A),K=de(null!=j?j:{},`ai/${iQ}`),L=function({model:a,settings:b,telemetry:c,headers:d}){var e;return{"ai.model.provider":a.provider,"ai.model.id":a.modelId,...Object.entries(b).reduce((a,[b,c])=>{if("timeout"===b){let d=iO(c);null!=d&&(a[`ai.settings.${b}`]=d)}else a[`ai.settings.${b}`]=c;return a},{}),...Object.entries(null!=(e=null==c?void 0:c.metadata)?e:{}).reduce((a,[b,c])=>(a[`ai.telemetry.metadata.${b}`]=c,a),{}),...Object.entries(null!=d?d:{}).reduce((a,[b,c])=>(void 0!==c&&(a[`ai.request.headers.${b}`]=c),a),{})}}({model:B,telemetry:n,headers:K,settings:{...J,maxRetries:H}}),M=await jg({system:d,prompt:e,messages:f}),N=function({isEnabled:a=!1,tracer:b}={}){return a?b||hW.u.getTracer("ai"):ji}(n);try{return await jl({name:"ai.generateText",attributes:jn({telemetry:n,attributes:{...jh({operationId:"ai.generateText",telemetry:n}),...L,"ai.model.provider":B.provider,"ai.model.id":B.modelId,"ai.prompt":{input:()=>JSON.stringify({system:d,prompt:e,messages:f})}}}),tracer:N,fn:async a=>{var e,f,g,h,i,j,k,l,p,r,D,H;let J,O,P=M.messages,Q=[],{approvedToolApprovals:R,deniedToolApprovals:S}=function({messages:a}){let b=a.at(-1);if((null==b?void 0:b.role)!="tool")return{approvedToolApprovals:[],deniedToolApprovals:[]};let c={};for(let b of a)if("assistant"===b.role&&"string"!=typeof b.content)for(let a of b.content)"tool-call"===a.type&&(c[a.toolCallId]=a);let d={};for(let b of a)if("assistant"===b.role&&"string"!=typeof b.content)for(let a of b.content)"tool-approval-request"===a.type&&(d[a.approvalId]=a);let e={};for(let a of b.content)"tool-result"===a.type&&(e[a.toolCallId]=a);let f=[],g=[];for(let a of b.content.filter(a=>"tool-approval-response"===a.type)){let b=d[a.approvalId];if(null==b)throw new h5({approvalId:a.approvalId});if(null!=e[b.toolCallId])continue;let h=c[b.toolCallId];if(null==h)throw new id({toolCallId:b.toolCallId,approvalId:b.approvalId});let i={approvalRequest:b,approvalResponse:a,toolCall:h};a.approved?f.push(i):g.push(i)}return{approvedToolApprovals:f,deniedToolApprovals:g}}({messages:P}),T=R.filter(a=>!a.toolCall.providerExecuted);if(S.length>0||T.length>0){let a=await jJ({toolCalls:T.map(a=>a.toolCall),tools:b,tracer:N,telemetry:n,messages:P,abortSignal:G,experimental_context:v}),c=[];for(let d of a){let a=await iY({toolCallId:d.toolCallId,input:d.input,tool:null==b?void 0:b[d.toolName],output:"tool-result"===d.type?d.output:d.error,errorMode:"tool-error"===d.type?"json":"none"});c.push({type:"tool-result",toolCallId:d.toolCallId,toolName:d.toolName,output:a})}for(let a of S)c.push({type:"tool-result",toolCallId:a.toolCall.toolCallId,toolName:a.toolCall.toolName,output:{type:"execution-denied",reason:a.approvalResponse.reason,...a.toolCall.providerExecuted&&{providerOptions:{openai:{approvalId:a.approvalResponse.approvalId}}}}});Q.push({role:"tool",content:c})}let U=[...R,...S].filter(a=>a.toolCall.providerExecuted);U.length>0&&Q.push({role:"tool",content:U.map(a=>({type:"tool-approval-response",approvalId:a.approvalResponse.approvalId,approved:a.approvalResponse.approved,reason:a.approvalResponse.reason,providerExecuted:!0}))});let V=i$(A),W=[],X=[],Y=[],Z=new Map;do{let a=null!=E?setTimeout(()=>F.abort(),E):void 0;try{let a=[...P,...Q],z=await (null==s?void 0:s({model:B,steps:Y,stepNumber:Y.length,messages:a,experimental_context:v})),C=iN(null!=(e=null==z?void 0:z.model)?e:B),E=await iV({prompt:{system:null!=(f=null==z?void 0:z.system)?f:M.system,messages:null!=(g=null==z?void 0:z.messages)?g:a},supportedUrls:await C.supportedUrls,download:u});v=null!=(h=null==z?void 0:z.experimental_context)?h:v;let{toolChoice:F,tools:O}=await i_({tools:b,toolChoice:null!=(i=null==z?void 0:z.toolChoice)?i:c,activeTools:null!=(j=null==z?void 0:z.activeTools)?j:q});J=await I(()=>{var a;return jl({name:"ai.generateText.doGenerate",attributes:jn({telemetry:n,attributes:{...jh({operationId:"ai.generateText.doGenerate",telemetry:n}),...L,"ai.model.provider":C.provider,"ai.model.id":C.modelId,"ai.prompt.messages":{input:()=>JSON.stringify(E.map(a=>({...a,content:"string"==typeof a.content?a.content:a.content.map(a=>{var b;return"file"===a.type?{...a,data:a.data instanceof Uint8Array?"string"==typeof(b=a.data)?b:b instanceof ArrayBuffer?c$(new Uint8Array(b)):c$(b):a.data}:a})})))},"ai.prompt.tools":{input:()=>null==O?void 0:O.map(a=>JSON.stringify(a))},"ai.prompt.toolChoice":{input:()=>null!=F?JSON.stringify(F):void 0},"gen_ai.system":C.provider,"gen_ai.request.model":C.modelId,"gen_ai.request.frequency_penalty":A.frequencyPenalty,"gen_ai.request.max_tokens":A.maxOutputTokens,"gen_ai.request.presence_penalty":A.presencePenalty,"gen_ai.request.stop_sequences":A.stopSequences,"gen_ai.request.temperature":null!=(a=A.temperature)?a:void 0,"gen_ai.request.top_k":A.topK,"gen_ai.request.top_p":A.topP}}),tracer:N,fn:async a=>{var b,c,d,e,f,g,h,i;let j=function a(b,c){if(void 0===b&&void 0===c)return;if(void 0===b)return c;if(void 0===c)return b;let d={...b};for(let e in c)if(Object.prototype.hasOwnProperty.call(c,e)){let f=c[e];if(void 0===f)continue;let g=e in b?b[e]:void 0,h=null!==f&&"object"==typeof f&&!Array.isArray(f)&&!(f instanceof Date)&&!(f instanceof RegExp),i=null!=g&&"object"==typeof g&&!Array.isArray(g)&&!(g instanceof Date)&&!(g instanceof RegExp);h&&i?d[e]=a(g,f):d[e]=f}return d}(o,null==z?void 0:z.providerOptions),k=await C.doGenerate({...V,tools:O,toolChoice:F,responseFormat:await (null==m?void 0:m.responseFormat),prompt:E,providerOptions:j,abortSignal:G,headers:K}),l={id:null!=(c=null==(b=k.response)?void 0:b.id)?c:x(),timestamp:null!=(e=null==(d=k.response)?void 0:d.timestamp)?e:new Date,modelId:null!=(g=null==(f=k.response)?void 0:f.modelId)?g:C.modelId,headers:null==(h=k.response)?void 0:h.headers,body:null==(i=k.response)?void 0:i.body};return a.setAttributes(await jn({telemetry:n,attributes:{"ai.response.finishReason":k.finishReason.unified,"ai.response.text":{output:()=>js(k.content)},"ai.response.reasoning":{output:()=>jr(k.content)},"ai.response.toolCalls":{output:()=>{let a=jL(k.content);return null==a?void 0:JSON.stringify(a)}},"ai.response.id":l.id,"ai.response.model":l.modelId,"ai.response.timestamp":l.timestamp.toISOString(),"ai.response.providerMetadata":JSON.stringify(k.providerMetadata),"ai.usage.promptTokens":k.usage.inputTokens.total,"ai.usage.completionTokens":k.usage.outputTokens.total,"gen_ai.response.finish_reasons":[k.finishReason.unified],"gen_ai.response.id":l.id,"gen_ai.response.model":l.modelId,"gen_ai.usage.input_tokens":k.usage.inputTokens.total,"gen_ai.usage.output_tokens":k.usage.outputTokens.total}})),{...k,response:l}}})});let R=await Promise.all(J.content.filter(a=>"tool-call"===a.type).map(c=>jB({toolCall:c,tools:b,repairToolCall:t,system:d,messages:a}))),S={};for(let c of R){if(c.invalid)continue;let d=null==b?void 0:b[c.toolName];null!=d&&((null==d?void 0:d.onInputAvailable)!=null&&await d.onInputAvailable({input:c.input,toolCallId:c.toolCallId,messages:a,abortSignal:G,experimental_context:v}),await ju({tool:d,toolCall:c,messages:a,experimental_context:v})&&(S[c.toolCallId]={type:"tool-approval-request",approvalId:x(),toolCall:c}))}let T=R.filter(a=>a.invalid&&a.dynamic);for(let a of(X=[],T))X.push({type:"tool-error",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,error:c8(a.error),dynamic:!0});for(let c of(W=R.filter(a=>!a.providerExecuted),null!=b&&X.push(...await jJ({toolCalls:W.filter(a=>!a.invalid&&null==S[a.toolCallId]),tools:b,tracer:N,telemetry:n,messages:a,abortSignal:G,experimental_context:v})),R)){if(!c.providerExecuted)continue;let a=null==b?void 0:b[c.toolName];(null==a?void 0:a.type)==="provider"&&a.supportsDeferredResults&&(J.content.some(a=>"tool-result"===a.type&&a.toolCallId===c.toolCallId)||Z.set(c.toolCallId,{toolName:c.toolName}))}for(let a of J.content)"tool-result"===a.type&&Z.delete(a.toolCallId);let U=function({content:a,toolCalls:b,toolOutputs:c,toolApprovalRequests:d,tools:e}){let f=[];for(let c of a)switch(c.type){case"text":case"reasoning":case"source":f.push(c);break;case"file":f.push({type:"file",file:new jt(c),...null!=c.providerMetadata?{providerMetadata:c.providerMetadata}:{}});break;case"tool-call":f.push(b.find(a=>a.toolCallId===c.toolCallId));break;case"tool-result":{let a=b.find(a=>a.toolCallId===c.toolCallId);if(null==a){let a=null==e?void 0:e[c.toolName];if(!((null==a?void 0:a.type)==="provider"&&a.supportsDeferredResults))throw Error(`Tool call ${c.toolCallId} not found.`);c.isError?f.push({type:"tool-error",toolCallId:c.toolCallId,toolName:c.toolName,input:void 0,error:c.result,providerExecuted:!0,dynamic:c.dynamic}):f.push({type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,input:void 0,output:c.result,providerExecuted:!0,dynamic:c.dynamic});break}c.isError?f.push({type:"tool-error",toolCallId:c.toolCallId,toolName:c.toolName,input:a.input,error:c.result,providerExecuted:!0,dynamic:a.dynamic}):f.push({type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,input:a.input,output:c.result,providerExecuted:!0,dynamic:a.dynamic});break}case"tool-approval-request":{let a=b.find(a=>a.toolCallId===c.toolCallId);if(null==a)throw new id({toolCallId:c.toolCallId,approvalId:c.approvalId});f.push({type:"tool-approval-request",approvalId:c.approvalId,toolCall:a})}}return[...f,...c,...d]}({content:J.content,toolCalls:R,toolOutputs:X,toolApprovalRequests:Object.values(S),tools:b});Q.push(...await jG({content:U,tools:b}));let $=null==(k=null==w?void 0:w.requestBody)||k?null!=(l=J.request)?l:{}:{...J.request,body:void 0},_={...J.response,messages:structuredClone(Q),body:null==(p=null==w?void 0:w.responseBody)||p?null==(r=J.response)?void 0:r.body:void 0},aa=new jE({content:U,finishReason:J.finishReason.unified,rawFinishReason:J.finishReason.raw,usage:{inputTokens:(H=J.usage).inputTokens.total,inputTokenDetails:{noCacheTokens:H.inputTokens.noCache,cacheReadTokens:H.inputTokens.cacheRead,cacheWriteTokens:H.inputTokens.cacheWrite},outputTokens:H.outputTokens.total,outputTokenDetails:{textTokens:H.outputTokens.text,reasoningTokens:H.outputTokens.reasoning},totalTokens:jo(H.inputTokens.total,H.outputTokens.total),raw:H.raw,reasoningTokens:H.outputTokens.reasoning,cachedInputTokens:H.inputTokens.cacheRead},warnings:J.warnings,providerMetadata:J.providerMetadata,request:$,response:_});iK({warnings:null!=(D=J.warnings)?D:[],provider:C.provider,model:C.modelId}),Y.push(aa),await (null==y?void 0:y(aa))}finally{null!=a&&clearTimeout(a)}}while((W.length>0&&X.length===W.length||Z.size>0)&&!await jF({stopConditions:C,steps:Y}));a.setAttributes(await jn({telemetry:n,attributes:{"ai.response.finishReason":J.finishReason.unified,"ai.response.text":{output:()=>js(J.content)},"ai.response.reasoning":{output:()=>jr(J.content)},"ai.response.toolCalls":{output:()=>{let a=jL(J.content);return null==a?void 0:JSON.stringify(a)}},"ai.response.providerMetadata":JSON.stringify(J.providerMetadata),"ai.usage.promptTokens":J.usage.inputTokens.total,"ai.usage.completionTokens":J.usage.outputTokens.total}}));let $=Y[Y.length-1],_=Y.reduce((a,b)=>{var c,d,e,f,g,h,i,j,k,l,m;return c=b.usage,{inputTokens:jo(a.inputTokens,c.inputTokens),inputTokenDetails:{noCacheTokens:jo(null==(d=a.inputTokenDetails)?void 0:d.noCacheTokens,null==(e=c.inputTokenDetails)?void 0:e.noCacheTokens),cacheReadTokens:jo(null==(f=a.inputTokenDetails)?void 0:f.cacheReadTokens,null==(g=c.inputTokenDetails)?void 0:g.cacheReadTokens),cacheWriteTokens:jo(null==(h=a.inputTokenDetails)?void 0:h.cacheWriteTokens,null==(i=c.inputTokenDetails)?void 0:i.cacheWriteTokens)},outputTokens:jo(a.outputTokens,c.outputTokens),outputTokenDetails:{textTokens:jo(null==(j=a.outputTokenDetails)?void 0:j.textTokens,null==(k=c.outputTokenDetails)?void 0:k.textTokens),reasoningTokens:jo(null==(l=a.outputTokenDetails)?void 0:l.reasoningTokens,null==(m=c.outputTokenDetails)?void 0:m.reasoningTokens)},totalTokens:jo(a.totalTokens,c.totalTokens),reasoningTokens:jo(a.reasoningTokens,c.reasoningTokens),cachedInputTokens:jo(a.cachedInputTokens,c.cachedInputTokens)}},{inputTokens:void 0,outputTokens:void 0,totalTokens:void 0,reasoningTokens:void 0,cachedInputTokens:void 0});if(await (null==z?void 0:z({finishReason:$.finishReason,rawFinishReason:$.rawFinishReason,usage:$.usage,content:$.content,text:$.text,reasoningText:$.reasoningText,reasoning:$.reasoning,files:$.files,sources:$.sources,toolCalls:$.toolCalls,staticToolCalls:$.staticToolCalls,dynamicToolCalls:$.dynamicToolCalls,toolResults:$.toolResults,staticToolResults:$.staticToolResults,dynamicToolResults:$.dynamicToolResults,request:$.request,response:$.response,warnings:$.warnings,providerMetadata:$.providerMetadata,steps:Y,totalUsage:_,experimental_context:v})),"stop"===$.finishReason){let a=null!=m?m:jw();O=await a.parseCompleteOutput({text:$.text},{response:$.response,usage:$.usage,finishReason:$.finishReason})}return new jK({steps:Y,totalUsage:_,output:O})}})}catch(a){throw function(a){if(!g8.isInstance(a))return a;let b="https://ai-sdk.dev/unauthenticated-ai-gateway";return(null==process?void 0:"production")==="production"?new ai({name:"GatewayError",message:`Unauthenticated. Configure AI_GATEWAY_API_KEY or use a provider module. Learn more: ${b}`}):Object.assign(Error(`\x1b[1m\x1b[31mUnauthenticated request to AI Gateway.\x1b[0m

To authenticate, set the \x1b[33mAI_GATEWAY_API_KEY\x1b[0m environment variable with your API key.

Alternatively, you can use a provider module instead of the AI Gateway.

Learn more: \x1b[34m${b}\x1b[0m

`),{name:"GatewayAuthenticationError"})}(a)}}async function jJ({toolCalls:a,tools:b,tracer:c,telemetry:d,messages:e,abortSignal:f,experimental_context:g}){return(await Promise.all(a.map(async a=>jq({toolCall:a,tools:b,tracer:c,telemetry:d,messages:e,abortSignal:f,experimental_context:g})))).filter(a=>null!=a)}var jK=class{constructor(a){this.steps=a.steps,this._output=a.output,this.totalUsage=a.totalUsage}get finalStep(){return this.steps[this.steps.length-1]}get content(){return this.finalStep.content}get text(){return this.finalStep.text}get files(){return this.finalStep.files}get reasoningText(){return this.finalStep.reasoningText}get reasoning(){return this.finalStep.reasoning}get toolCalls(){return this.finalStep.toolCalls}get staticToolCalls(){return this.finalStep.staticToolCalls}get dynamicToolCalls(){return this.finalStep.dynamicToolCalls}get toolResults(){return this.finalStep.toolResults}get staticToolResults(){return this.finalStep.staticToolResults}get dynamicToolResults(){return this.finalStep.dynamicToolResults}get sources(){return this.finalStep.sources}get finishReason(){return this.finalStep.finishReason}get rawFinishReason(){return this.finalStep.rawFinishReason}get warnings(){return this.finalStep.warnings}get providerMetadata(){return this.finalStep.providerMetadata}get response(){return this.finalStep.response}get request(){return this.finalStep.request}get usage(){return this.finalStep.usage}get experimental_output(){return this.output}get output(){if(null==this._output)throw new ir;return this._output}};function jL(a){let b=a.filter(a=>"tool-call"===a.type);if(0!==b.length)return b.map(a=>({toolCallId:a.toolCallId,toolName:a.toolName,input:a.input}))}function jM(a){return({url:b,abortSignal:c})=>iR({url:b,maxBytes:null==a?void 0:a.maxBytes,abortSignal:c})}TransformStream,dI(()=>dL(gE([gC({type:gN("text-start"),id:f_(),providerMetadata:i1.optional()}),gC({type:gN("text-delta"),id:f_(),delta:f_(),providerMetadata:i1.optional()}),gC({type:gN("text-end"),id:f_(),providerMetadata:i1.optional()}),gC({type:gN("error"),errorText:f_()}),gC({type:gN("tool-input-start"),toolCallId:f_(),toolName:f_(),providerExecuted:gp().optional(),providerMetadata:i1.optional(),dynamic:gp().optional(),title:f_().optional()}),gC({type:gN("tool-input-delta"),toolCallId:f_(),inputTextDelta:f_()}),gC({type:gN("tool-input-available"),toolCallId:f_(),toolName:f_(),input:gv(),providerExecuted:gp().optional(),providerMetadata:i1.optional(),dynamic:gp().optional(),title:f_().optional()}),gC({type:gN("tool-input-error"),toolCallId:f_(),toolName:f_(),input:gv(),providerExecuted:gp().optional(),providerMetadata:i1.optional(),dynamic:gp().optional(),errorText:f_(),title:f_().optional()}),gC({type:gN("tool-approval-request"),approvalId:f_(),toolCallId:f_()}),gC({type:gN("tool-output-available"),toolCallId:f_(),output:gv(),providerExecuted:gp().optional(),dynamic:gp().optional(),preliminary:gp().optional()}),gC({type:gN("tool-output-error"),toolCallId:f_(),errorText:f_(),providerExecuted:gp().optional(),dynamic:gp().optional()}),gC({type:gN("tool-output-denied"),toolCallId:f_()}),gC({type:gN("reasoning-start"),id:f_(),providerMetadata:i1.optional()}),gC({type:gN("reasoning-delta"),id:f_(),delta:f_(),providerMetadata:i1.optional()}),gC({type:gN("reasoning-end"),id:f_(),providerMetadata:i1.optional()}),gC({type:gN("source-url"),sourceId:f_(),url:f_(),title:f_().optional(),providerMetadata:i1.optional()}),gC({type:gN("source-document"),sourceId:f_(),mediaType:f_(),title:f_(),filename:f_().optional(),providerMetadata:i1.optional()}),gC({type:gN("file"),url:f_(),mediaType:f_(),providerMetadata:i1.optional()}),gC({type:g1(a=>"string"==typeof a&&a.startsWith("data-"),{message:'Type must start with "data-"'}),id:f_().optional(),data:gv(),transient:gp().optional()}),gC({type:gN("start-step")}),gC({type:gN("finish-step")}),gC({type:gN("start"),messageId:f_().optional(),messageMetadata:gv().optional()}),gC({type:gN("finish"),finishReason:gL(["stop","length","content-filter","tool-calls","error","other"]).optional(),messageMetadata:gv().optional()}),gC({type:gN("abort"),reason:f_().optional()}),gC({type:gN("message-metadata"),messageMetadata:gv()})]))),c6({prefix:"aitxt",size:24}),dI(()=>dL(gz(gB({id:f_(),role:gL(["system","user","assistant"]),metadata:gv().optional(),parts:gz(gE([gB({type:gN("text"),text:f_(),state:gL(["streaming","done"]).optional(),providerMetadata:i1.optional()}),gB({type:gN("reasoning"),text:f_(),state:gL(["streaming","done"]).optional(),providerMetadata:i1.optional()}),gB({type:gN("source-url"),sourceId:f_(),url:f_(),title:f_().optional(),providerMetadata:i1.optional()}),gB({type:gN("source-document"),sourceId:f_(),mediaType:f_(),title:f_(),filename:f_().optional(),providerMetadata:i1.optional()}),gB({type:gN("file"),mediaType:f_(),filename:f_().optional(),url:f_(),providerMetadata:i1.optional()}),gB({type:gN("step-start")}),gB({type:f_().startsWith("data-"),id:f_().optional(),data:gv()}),gB({type:gN("dynamic-tool"),toolName:f_(),toolCallId:f_(),state:gN("input-streaming"),input:gv().optional(),providerExecuted:gp().optional(),callProviderMetadata:i1.optional(),output:gx().optional(),errorText:gx().optional(),approval:gx().optional()}),gB({type:gN("dynamic-tool"),toolName:f_(),toolCallId:f_(),state:gN("input-available"),input:gv(),providerExecuted:gp().optional(),output:gx().optional(),errorText:gx().optional(),callProviderMetadata:i1.optional(),approval:gx().optional()}),gB({type:gN("dynamic-tool"),toolName:f_(),toolCallId:f_(),state:gN("approval-requested"),input:gv(),providerExecuted:gp().optional(),output:gx().optional(),errorText:gx().optional(),callProviderMetadata:i1.optional(),approval:gB({id:f_(),approved:gx().optional(),reason:gx().optional()})}),gB({type:gN("dynamic-tool"),toolName:f_(),toolCallId:f_(),state:gN("approval-responded"),input:gv(),providerExecuted:gp().optional(),output:gx().optional(),errorText:gx().optional(),callProviderMetadata:i1.optional(),approval:gB({id:f_(),approved:gp(),reason:f_().optional()})}),gB({type:gN("dynamic-tool"),toolName:f_(),toolCallId:f_(),state:gN("output-available"),input:gv(),providerExecuted:gp().optional(),output:gv(),errorText:gx().optional(),callProviderMetadata:i1.optional(),preliminary:gp().optional(),approval:gB({id:f_(),approved:gN(!0),reason:f_().optional()}).optional()}),gB({type:gN("dynamic-tool"),toolName:f_(),toolCallId:f_(),state:gN("output-error"),input:gv(),rawInput:gv().optional(),providerExecuted:gp().optional(),output:gx().optional(),errorText:f_(),callProviderMetadata:i1.optional(),approval:gB({id:f_(),approved:gN(!0),reason:f_().optional()}).optional()}),gB({type:gN("dynamic-tool"),toolName:f_(),toolCallId:f_(),state:gN("output-denied"),input:gv(),providerExecuted:gp().optional(),output:gx().optional(),errorText:gx().optional(),callProviderMetadata:i1.optional(),approval:gB({id:f_(),approved:gN(!1),reason:f_().optional()})}),gB({type:f_().startsWith("tool-"),toolCallId:f_(),state:gN("input-streaming"),providerExecuted:gp().optional(),callProviderMetadata:i1.optional(),input:gv().optional(),output:gx().optional(),errorText:gx().optional(),approval:gx().optional()}),gB({type:f_().startsWith("tool-"),toolCallId:f_(),state:gN("input-available"),providerExecuted:gp().optional(),input:gv(),output:gx().optional(),errorText:gx().optional(),callProviderMetadata:i1.optional(),approval:gx().optional()}),gB({type:f_().startsWith("tool-"),toolCallId:f_(),state:gN("approval-requested"),input:gv(),providerExecuted:gp().optional(),output:gx().optional(),errorText:gx().optional(),callProviderMetadata:i1.optional(),approval:gB({id:f_(),approved:gx().optional(),reason:gx().optional()})}),gB({type:f_().startsWith("tool-"),toolCallId:f_(),state:gN("approval-responded"),input:gv(),providerExecuted:gp().optional(),output:gx().optional(),errorText:gx().optional(),callProviderMetadata:i1.optional(),approval:gB({id:f_(),approved:gp(),reason:f_().optional()})}),gB({type:f_().startsWith("tool-"),toolCallId:f_(),state:gN("output-available"),providerExecuted:gp().optional(),input:gv(),output:gv(),errorText:gx().optional(),callProviderMetadata:i1.optional(),preliminary:gp().optional(),approval:gB({id:f_(),approved:gN(!0),reason:f_().optional()}).optional()}),gB({type:f_().startsWith("tool-"),toolCallId:f_(),state:gN("output-error"),providerExecuted:gp().optional(),input:gv(),rawInput:gv().optional(),output:gx().optional(),errorText:f_(),callProviderMetadata:i1.optional(),approval:gB({id:f_(),approved:gN(!0),reason:f_().optional()}).optional()}),gB({type:f_().startsWith("tool-"),toolCallId:f_(),state:gN("output-denied"),providerExecuted:gp().optional(),input:gv(),output:gx().optional(),errorText:gx().optional(),callProviderMetadata:i1.optional(),approval:gB({id:f_(),approved:gN(!1),reason:f_().optional()})})])).nonempty("Message must contain at least one part")})).nonempty("Messages array must not be empty"))),c6({prefix:"aiobj",size:24}),c6({prefix:"aiobj",size:24}),jM(),Symbol.for("vercel.ai.error.AI_NoSuchProviderError"),jM();var jN=gB({error:gB({message:f_(),type:f_().nullish(),param:gt().nullish(),code:gE([f_(),gl()]).nullish()})}),jO=dY({errorSchema:jN,errorToMessage:a=>a.error.message});function jP(a){let b=a.startsWith("o3")||a.startsWith("o4-mini")||a.startsWith("gpt-5")&&!a.startsWith("gpt-5-chat"),c=a.startsWith("gpt-4")||a.startsWith("gpt-5-mini")||a.startsWith("gpt-5")&&!a.startsWith("gpt-5-nano")&&!a.startsWith("gpt-5-chat")||a.startsWith("o3")||a.startsWith("o4-mini"),d=a.startsWith("o1")||a.startsWith("o3")||a.startsWith("o4-mini")||a.startsWith("codex-mini")||a.startsWith("computer-use-preview")||a.startsWith("gpt-5")&&!a.startsWith("gpt-5-chat");return{supportsFlexProcessing:b,supportsPriorityProcessing:c,isReasoningModel:d,systemMessageMode:d?"developer":"system",supportsNonReasoningParameters:a.startsWith("gpt-5.1")||a.startsWith("gpt-5.2")}}function jQ(a){var b,c,d,e,f,g;if(null==a)return{inputTokens:{total:void 0,noCache:void 0,cacheRead:void 0,cacheWrite:void 0},outputTokens:{total:void 0,text:void 0,reasoning:void 0},raw:void 0};let h=null!=(b=a.prompt_tokens)?b:0,i=null!=(c=a.completion_tokens)?c:0,j=null!=(e=null==(d=a.prompt_tokens_details)?void 0:d.cached_tokens)?e:0,k=null!=(g=null==(f=a.completion_tokens_details)?void 0:f.reasoning_tokens)?g:0;return{inputTokens:{total:h,noCache:h-j,cacheRead:j,cacheWrite:void 0},outputTokens:{total:i,text:i-k,reasoning:k},raw:a}}function jR({id:a,model:b,created:c}){return{id:null!=a?a:void 0,modelId:null!=b?b:void 0,timestamp:c?new Date(1e3*c):void 0}}function jS(a){switch(a){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"other"}}var jT=dI(()=>dL(gB({id:f_().nullish(),created:gl().nullish(),model:f_().nullish(),choices:gz(gB({message:gB({role:gN("assistant").nullish(),content:f_().nullish(),tool_calls:gz(gB({id:f_().nullish(),type:gN("function"),function:gB({name:f_(),arguments:f_()})})).nullish(),annotations:gz(gB({type:gN("url_citation"),url_citation:gB({start_index:gl(),end_index:gl(),url:f_(),title:f_()})})).nullish()}),index:gl(),logprobs:gB({content:gz(gB({token:f_(),logprob:gl(),top_logprobs:gz(gB({token:f_(),logprob:gl()}))})).nullish()}).nullish(),finish_reason:f_().nullish()})),usage:gB({prompt_tokens:gl().nullish(),completion_tokens:gl().nullish(),total_tokens:gl().nullish(),prompt_tokens_details:gB({cached_tokens:gl().nullish()}).nullish(),completion_tokens_details:gB({reasoning_tokens:gl().nullish(),accepted_prediction_tokens:gl().nullish(),rejected_prediction_tokens:gl().nullish()}).nullish()}).nullish()}))),jU=dI(()=>dL(gE([gB({id:f_().nullish(),created:gl().nullish(),model:f_().nullish(),choices:gz(gB({delta:gB({role:gL(["assistant"]).nullish(),content:f_().nullish(),tool_calls:gz(gB({index:gl(),id:f_().nullish(),type:gN("function").nullish(),function:gB({name:f_().nullish(),arguments:f_().nullish()})})).nullish(),annotations:gz(gB({type:gN("url_citation"),url_citation:gB({start_index:gl(),end_index:gl(),url:f_(),title:f_()})})).nullish()}).nullish(),logprobs:gB({content:gz(gB({token:f_(),logprob:gl(),top_logprobs:gz(gB({token:f_(),logprob:gl()}))})).nullish()}).nullish(),finish_reason:f_().nullish(),index:gl()})),usage:gB({prompt_tokens:gl().nullish(),completion_tokens:gl().nullish(),total_tokens:gl().nullish(),prompt_tokens_details:gB({cached_tokens:gl().nullish()}).nullish(),completion_tokens_details:gB({reasoning_tokens:gl().nullish(),accepted_prediction_tokens:gl().nullish(),rejected_prediction_tokens:gl().nullish()}).nullish()}).nullish()}),jN]))),jV=dI(()=>dL(gB({logitBias:gJ(new gk({type:"number",coerce:!0,checks:[],...bd(void 0)}),gl()).optional(),logprobs:gE([gp(),gl()]).optional(),parallelToolCalls:gp().optional(),user:f_().optional(),reasoningEffort:gL(["none","minimal","low","medium","high","xhigh"]).optional(),maxCompletionTokens:gl().optional(),store:gp().optional(),metadata:gJ(f_().max(64),f_().max(512)).optional(),prediction:gJ(f_(),gt()).optional(),serviceTier:gL(["auto","flex","priority","default"]).optional(),strictJsonSchema:gp().optional(),textVerbosity:gL(["low","medium","high"]).optional(),promptCacheKey:f_().optional(),promptCacheRetention:gL(["in_memory","24h"]).optional(),safetyIdentifier:f_().optional(),systemMessageMode:gL(["system","developer","remove"]).optional(),forceReasoning:gp().optional()}))),jW=class{constructor(a,b){this.specificationVersion="v3",this.supportedUrls={"image/*":[/^https?:\/\/.*$/]},this.modelId=a,this.config=b}get provider(){return this.config.provider}async getArgs({prompt:a,maxOutputTokens:b,temperature:c,topP:d,topK:e,frequencyPenalty:f,presencePenalty:g,stopSequences:h,responseFormat:i,seed:j,tools:k,toolChoice:l,providerOptions:m}){var n,o,p,q,r;let s=[],t=null!=(n=await dR({provider:"openai",providerOptions:m,schema:jV}))?n:{},u=jP(this.modelId),v=null!=(o=t.forceReasoning)?o:u.isReasoningModel;null!=e&&s.push({type:"unsupported",feature:"topK"});let{messages:w,warnings:x}=function({prompt:a,systemMessageMode:b="system"}){var c;let d=[],e=[];for(let{role:f,content:g}of a)switch(f){case"system":switch(b){case"system":d.push({role:"system",content:g});break;case"developer":d.push({role:"developer",content:g});break;case"remove":e.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${b}`)}break;case"user":if(1===g.length&&"text"===g[0].type){d.push({role:"user",content:g[0].text});break}d.push({role:"user",content:g.map((a,b)=>{var c,d,e;switch(a.type){case"text":return{type:"text",text:a.text};case"file":if(a.mediaType.startsWith("image/")){let b="image/*"===a.mediaType?"image/jpeg":a.mediaType;return{type:"image_url",image_url:{url:a.data instanceof URL?a.data.toString():`data:${b};base64,${c_(a.data)}`,detail:null==(d=null==(c=a.providerOptions)?void 0:c.openai)?void 0:d.imageDetail}}}if(a.mediaType.startsWith("audio/")){if(a.data instanceof URL)throw new aY({functionality:"audio file parts with URLs"});switch(a.mediaType){case"audio/wav":return{type:"input_audio",input_audio:{data:c_(a.data),format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:c_(a.data),format:"mp3"}};default:throw new aY({functionality:`audio content parts with media type ${a.mediaType}`})}}if("application/pdf"===a.mediaType){if(a.data instanceof URL)throw new aY({functionality:"PDF file parts with URLs"});return{type:"file",file:"string"==typeof a.data&&a.data.startsWith("file-")?{file_id:a.data}:{filename:null!=(e=a.filename)?e:`part-${b}.pdf`,file_data:`data:application/pdf;base64,${c_(a.data)}`}}}else throw new aY({functionality:`file part media type ${a.mediaType}`})}})});break;case"assistant":{let a="",b=[];for(let c of g)switch(c.type){case"text":a+=c.text;break;case"tool-call":b.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.input)}})}d.push({role:"assistant",content:a,tool_calls:b.length>0?b:void 0});break}case"tool":for(let a of g){let b;if("tool-approval-response"===a.type)continue;let e=a.output;switch(e.type){case"text":case"error-text":b=e.value;break;case"execution-denied":b=null!=(c=e.reason)?c:"Tool execution denied.";break;case"content":case"json":case"error-json":b=JSON.stringify(e.value)}d.push({role:"tool",tool_call_id:a.toolCallId,content:b})}break;default:throw Error(`Unsupported role: ${f}`)}return{messages:d,warnings:e}}({prompt:a,systemMessageMode:null!=(p=t.systemMessageMode)?p:v?"developer":u.systemMessageMode});s.push(...x);let y=null==(q=t.strictJsonSchema)||q,z={model:this.modelId,logit_bias:t.logitBias,logprobs:!0===t.logprobs||"number"==typeof t.logprobs||void 0,top_logprobs:"number"==typeof t.logprobs?t.logprobs:"boolean"==typeof t.logprobs&&t.logprobs?0:void 0,user:t.user,parallel_tool_calls:t.parallelToolCalls,max_tokens:b,temperature:c,top_p:d,frequency_penalty:f,presence_penalty:g,response_format:(null==i?void 0:i.type)==="json"?null!=i.schema?{type:"json_schema",json_schema:{schema:i.schema,strict:y,name:null!=(r=i.name)?r:"response",description:i.description}}:{type:"json_object"}:void 0,stop:h,seed:j,verbosity:t.textVerbosity,max_completion_tokens:t.maxCompletionTokens,store:t.store,metadata:t.metadata,prediction:t.prediction,reasoning_effort:t.reasoningEffort,service_tier:t.serviceTier,prompt_cache_key:t.promptCacheKey,prompt_cache_retention:t.promptCacheRetention,safety_identifier:t.safetyIdentifier,messages:w};v?("none"===t.reasoningEffort&&u.supportsNonReasoningParameters||(null!=z.temperature&&(z.temperature=void 0,s.push({type:"unsupported",feature:"temperature",details:"temperature is not supported for reasoning models"})),null!=z.top_p&&(z.top_p=void 0,s.push({type:"unsupported",feature:"topP",details:"topP is not supported for reasoning models"})),null!=z.logprobs&&(z.logprobs=void 0,s.push({type:"other",message:"logprobs is not supported for reasoning models"}))),null!=z.frequency_penalty&&(z.frequency_penalty=void 0,s.push({type:"unsupported",feature:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),null!=z.presence_penalty&&(z.presence_penalty=void 0,s.push({type:"unsupported",feature:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),null!=z.logit_bias&&(z.logit_bias=void 0,s.push({type:"other",message:"logitBias is not supported for reasoning models"})),null!=z.top_logprobs&&(z.top_logprobs=void 0,s.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),null!=z.max_tokens&&(null==z.max_completion_tokens&&(z.max_completion_tokens=z.max_tokens),z.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&null!=z.temperature&&(z.temperature=void 0,s.push({type:"unsupported",feature:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),"flex"!==t.serviceTier||u.supportsFlexProcessing||(s.push({type:"unsupported",feature:"serviceTier",details:"flex processing is only available for o3, o4-mini, and gpt-5 models"}),z.service_tier=void 0),"priority"!==t.serviceTier||u.supportsPriorityProcessing||(s.push({type:"unsupported",feature:"serviceTier",details:"priority processing is only available for supported models (gpt-4, gpt-5, gpt-5-mini, o3, o4-mini) and requires Enterprise access. gpt-5-nano is not supported"}),z.service_tier=void 0);let{tools:A,toolChoice:B,toolWarnings:C}=function({tools:a,toolChoice:b}){a=(null==a?void 0:a.length)?a:void 0;let c=[];if(null==a)return{tools:void 0,toolChoice:void 0,toolWarnings:c};let d=[];for(let b of a)"function"===b.type?d.push({type:"function",function:{name:b.name,description:b.description,parameters:b.inputSchema,...null!=b.strict?{strict:b.strict}:{}}}):c.push({type:"unsupported",feature:`tool type: ${b.type}`});if(null==b)return{tools:d,toolChoice:void 0,toolWarnings:c};let e=b.type;switch(e){case"auto":case"none":case"required":return{tools:d,toolChoice:e,toolWarnings:c};case"tool":return{tools:d,toolChoice:{type:"function",function:{name:b.toolName}},toolWarnings:c};default:throw new aY({functionality:`tool choice type: ${e}`})}}({tools:k,toolChoice:l});return{args:{...z,tools:A,tool_choice:B},warnings:[...s,...C]}}async doGenerate(a){var b,c,d,e,f,g,h;let{args:i,warnings:j}=await this.getArgs(a),{responseHeaders:k,value:l,rawValue:m}=await dT({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:cT(this.config.headers(),a.headers),body:i,failedResponseHandler:jO,successfulResponseHandler:d$(jT),abortSignal:a.abortSignal,fetch:this.config.fetch}),n=l.choices[0],o=[],p=n.message.content;for(let a of(null!=p&&p.length>0&&o.push({type:"text",text:p}),null!=(b=n.message.tool_calls)?b:[]))o.push({type:"tool-call",toolCallId:null!=(c=a.id)?c:c7(),toolName:a.function.name,input:a.function.arguments});for(let a of null!=(d=n.message.annotations)?d:[])o.push({type:"source",sourceType:"url",id:c7(),url:a.url_citation.url,title:a.url_citation.title});let q=null==(e=l.usage)?void 0:e.completion_tokens_details;null==(f=l.usage)||f.prompt_tokens_details;let r={openai:{}};return(null==q?void 0:q.accepted_prediction_tokens)!=null&&(r.openai.acceptedPredictionTokens=null==q?void 0:q.accepted_prediction_tokens),(null==q?void 0:q.rejected_prediction_tokens)!=null&&(r.openai.rejectedPredictionTokens=null==q?void 0:q.rejected_prediction_tokens),(null==(g=n.logprobs)?void 0:g.content)!=null&&(r.openai.logprobs=n.logprobs.content),{content:o,finishReason:{unified:jS(n.finish_reason),raw:null!=(h=n.finish_reason)?h:void 0},usage:jQ(l.usage),request:{body:i},response:{...jR(l),headers:k,body:m},warnings:j,providerMetadata:r}}async doStream(a){let b,{args:c,warnings:d}=await this.getArgs(a),e={...c,stream:!0,stream_options:{include_usage:!0}},{responseHeaders:f,value:g}=await dT({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:cT(this.config.headers(),a.headers),body:e,failedResponseHandler:jO,successfulResponseHandler:dZ(jU),abortSignal:a.abortSignal,fetch:this.config.fetch}),h=[],i={unified:"other",raw:void 0},j=!1,k=!1,l={openai:{}};return{stream:g.pipeThrough(new TransformStream({start(a){a.enqueue({type:"stream-start",warnings:d})},transform(c,d){var e,f,g,m,n,o,p,q,r,s,t,u,v,w,x,y,z;if(a.includeRawChunks&&d.enqueue({type:"raw",rawValue:c.rawValue}),!c.success){i={unified:"error",raw:void 0},d.enqueue({type:"error",error:c.error});return}let A=c.value;if("error"in A){i={unified:"error",raw:void 0},d.enqueue({type:"error",error:A.error});return}!j&&Object.values(jR(A)).some(Boolean)&&(j=!0,d.enqueue({type:"response-metadata",...jR(A)})),null!=A.usage&&(b=A.usage,(null==(e=A.usage.completion_tokens_details)?void 0:e.accepted_prediction_tokens)!=null&&(l.openai.acceptedPredictionTokens=null==(f=A.usage.completion_tokens_details)?void 0:f.accepted_prediction_tokens),(null==(g=A.usage.completion_tokens_details)?void 0:g.rejected_prediction_tokens)!=null&&(l.openai.rejectedPredictionTokens=null==(m=A.usage.completion_tokens_details)?void 0:m.rejected_prediction_tokens));let B=A.choices[0];if((null==B?void 0:B.finish_reason)!=null&&(i={unified:jS(B.finish_reason),raw:B.finish_reason}),(null==(n=null==B?void 0:B.logprobs)?void 0:n.content)!=null&&(l.openai.logprobs=B.logprobs.content),(null==B?void 0:B.delta)==null)return;let C=B.delta;if(null!=C.content&&(k||(d.enqueue({type:"text-start",id:"0"}),k=!0),d.enqueue({type:"text-delta",id:"0",delta:C.content})),null!=C.tool_calls)for(let a of C.tool_calls){let b=a.index;if(null==h[b]){if("function"!==a.type)throw new aD({data:a,message:"Expected 'function' type."});if(null==a.id)throw new aD({data:a,message:"Expected 'id' to be a string."});if((null==(o=a.function)?void 0:o.name)==null)throw new aD({data:a,message:"Expected 'function.name' to be a string."});d.enqueue({type:"tool-input-start",id:a.id,toolName:a.function.name}),h[b]={id:a.id,type:"function",function:{name:a.function.name,arguments:null!=(p=a.function.arguments)?p:""},hasFinished:!1};let c=h[b];(null==(q=c.function)?void 0:q.name)!=null&&(null==(r=c.function)?void 0:r.arguments)!=null&&(c.function.arguments.length>0&&d.enqueue({type:"tool-input-delta",id:c.id,delta:c.function.arguments}),dQ(c.function.arguments)&&(d.enqueue({type:"tool-input-end",id:c.id}),d.enqueue({type:"tool-call",toolCallId:null!=(s=c.id)?s:c7(),toolName:c.function.name,input:c.function.arguments}),c.hasFinished=!0));continue}let c=h[b];!c.hasFinished&&((null==(t=a.function)?void 0:t.arguments)!=null&&(c.function.arguments+=null!=(v=null==(u=a.function)?void 0:u.arguments)?v:""),d.enqueue({type:"tool-input-delta",id:c.id,delta:null!=(w=a.function.arguments)?w:""}),(null==(x=c.function)?void 0:x.name)!=null&&(null==(y=c.function)?void 0:y.arguments)!=null&&dQ(c.function.arguments)&&(d.enqueue({type:"tool-input-end",id:c.id}),d.enqueue({type:"tool-call",toolCallId:null!=(z=c.id)?z:c7(),toolName:c.function.name,input:c.function.arguments}),c.hasFinished=!0))}if(null!=C.annotations)for(let a of C.annotations)d.enqueue({type:"source",sourceType:"url",id:c7(),url:a.url_citation.url,title:a.url_citation.title})},flush(a){k&&a.enqueue({type:"text-end",id:"0"}),a.enqueue({type:"finish",finishReason:i,usage:jQ(b),...null!=l?{providerMetadata:l}:{}})}})),request:{body:e},response:{headers:f}}}};function jX(a){var b,c,d,e;if(null==a)return{inputTokens:{total:void 0,noCache:void 0,cacheRead:void 0,cacheWrite:void 0},outputTokens:{total:void 0,text:void 0,reasoning:void 0},raw:void 0};let f=null!=(b=a.prompt_tokens)?b:0,g=null!=(c=a.completion_tokens)?c:0;return{inputTokens:{total:null!=(d=a.prompt_tokens)?d:void 0,noCache:f,cacheRead:void 0,cacheWrite:void 0},outputTokens:{total:null!=(e=a.completion_tokens)?e:void 0,text:g,reasoning:void 0},raw:a}}function jY({id:a,model:b,created:c}){return{id:null!=a?a:void 0,modelId:null!=b?b:void 0,timestamp:null!=c?new Date(1e3*c):void 0}}function jZ(a){switch(a){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"other"}}var j$=dI(()=>dL(gB({id:f_().nullish(),created:gl().nullish(),model:f_().nullish(),choices:gz(gB({text:f_(),finish_reason:f_(),logprobs:gB({tokens:gz(f_()),token_logprobs:gz(gl()),top_logprobs:gz(gJ(f_(),gl())).nullish()}).nullish()})),usage:gB({prompt_tokens:gl(),completion_tokens:gl(),total_tokens:gl()}).nullish()}))),j_=dI(()=>dL(gE([gB({id:f_().nullish(),created:gl().nullish(),model:f_().nullish(),choices:gz(gB({text:f_(),finish_reason:f_().nullish(),index:gl(),logprobs:gB({tokens:gz(f_()),token_logprobs:gz(gl()),top_logprobs:gz(gJ(f_(),gl())).nullish()}).nullish()})),usage:gB({prompt_tokens:gl(),completion_tokens:gl(),total_tokens:gl()}).nullish()}),jN]))),j0=dI(()=>dL(gB({echo:gp().optional(),logitBias:gJ(f_(),gl()).optional(),suffix:f_().optional(),user:f_().optional(),logprobs:gE([gp(),gl()]).optional()}))),j1=class{constructor(a,b){this.specificationVersion="v3",this.supportedUrls={},this.modelId=a,this.config=b}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}get provider(){return this.config.provider}async getArgs({prompt:a,maxOutputTokens:b,temperature:c,topP:d,topK:e,frequencyPenalty:f,presencePenalty:g,stopSequences:h,responseFormat:i,tools:j,toolChoice:k,seed:l,providerOptions:m}){let n=[],o={...await dR({provider:"openai",providerOptions:m,schema:j0}),...await dR({provider:this.providerOptionsName,providerOptions:m,schema:j0})};null!=e&&n.push({type:"unsupported",feature:"topK"}),(null==j?void 0:j.length)&&n.push({type:"unsupported",feature:"tools"}),null!=k&&n.push({type:"unsupported",feature:"toolChoice"}),null!=i&&"text"!==i.type&&n.push({type:"unsupported",feature:"responseFormat",details:"JSON response format is not supported."});let{prompt:p,stopSequences:q}=function({prompt:a,user:b="user",assistant:c="assistant"}){let d="";for(let{role:e,content:f}of("system"===a[0].role&&(d+=`${a[0].content}

`,a=a.slice(1)),a))switch(e){case"system":throw new az({message:"Unexpected system message in prompt: ${content}",prompt:a});case"user":{let a=f.map(a=>{if("text"===a.type)return a.text}).filter(Boolean).join("");d+=`${b}:
${a}

`;break}case"assistant":{let a=f.map(a=>{switch(a.type){case"text":return a.text;case"tool-call":throw new aY({functionality:"tool-call messages"})}}).join("");d+=`${c}:
${a}

`;break}case"tool":throw new aY({functionality:"tool messages"});default:throw Error(`Unsupported role: ${e}`)}return{prompt:d+=`${c}:
`,stopSequences:[`
${b}:`]}}({prompt:a}),r=[...null!=q?q:[],...null!=h?h:[]];return{args:{model:this.modelId,echo:o.echo,logit_bias:o.logitBias,logprobs:(null==o?void 0:o.logprobs)===!0?0:(null==o?void 0:o.logprobs)===!1||null==o?void 0:o.logprobs,suffix:o.suffix,user:o.user,max_tokens:b,temperature:c,top_p:d,frequency_penalty:f,presence_penalty:g,seed:l,prompt:p,stop:r.length>0?r:void 0},warnings:n}}async doGenerate(a){var b;let{args:c,warnings:d}=await this.getArgs(a),{responseHeaders:e,value:f,rawValue:g}=await dT({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:cT(this.config.headers(),a.headers),body:c,failedResponseHandler:jO,successfulResponseHandler:d$(j$),abortSignal:a.abortSignal,fetch:this.config.fetch}),h=f.choices[0],i={openai:{}};return null!=h.logprobs&&(i.openai.logprobs=h.logprobs),{content:[{type:"text",text:h.text}],usage:jX(f.usage),finishReason:{unified:jZ(h.finish_reason),raw:null!=(b=h.finish_reason)?b:void 0},request:{body:c},response:{...jY(f),headers:e,body:g},providerMetadata:i,warnings:d}}async doStream(a){let b,{args:c,warnings:d}=await this.getArgs(a),e={...c,stream:!0,stream_options:{include_usage:!0}},{responseHeaders:f,value:g}=await dT({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:cT(this.config.headers(),a.headers),body:e,failedResponseHandler:jO,successfulResponseHandler:dZ(j_),abortSignal:a.abortSignal,fetch:this.config.fetch}),h={unified:"other",raw:void 0},i={openai:{}},j=!0;return{stream:g.pipeThrough(new TransformStream({start(a){a.enqueue({type:"stream-start",warnings:d})},transform(c,d){if(a.includeRawChunks&&d.enqueue({type:"raw",rawValue:c.rawValue}),!c.success){h={unified:"error",raw:void 0},d.enqueue({type:"error",error:c.error});return}let e=c.value;if("error"in e){h={unified:"error",raw:void 0},d.enqueue({type:"error",error:e.error});return}j&&(j=!1,d.enqueue({type:"response-metadata",...jY(e)}),d.enqueue({type:"text-start",id:"0"})),null!=e.usage&&(b=e.usage);let f=e.choices[0];(null==f?void 0:f.finish_reason)!=null&&(h={unified:jZ(f.finish_reason),raw:f.finish_reason}),(null==f?void 0:f.logprobs)!=null&&(i.openai.logprobs=f.logprobs),(null==f?void 0:f.text)!=null&&f.text.length>0&&d.enqueue({type:"text-delta",id:"0",delta:f.text})},flush(a){j||a.enqueue({type:"text-end",id:"0"}),a.enqueue({type:"finish",finishReason:h,providerMetadata:i,usage:jX(b)})}})),request:{body:e},response:{headers:f}}}},j2=dI(()=>dL(gB({dimensions:gl().optional(),user:f_().optional()}))),j3=dI(()=>dL(gB({data:gz(gB({embedding:gz(gl())})),usage:gB({prompt_tokens:gl()}).nullish()}))),j4=class{constructor(a,b){this.specificationVersion="v3",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0,this.modelId=a,this.config=b}get provider(){return this.config.provider}async doEmbed({values:a,headers:b,abortSignal:c,providerOptions:d}){var e;if(a.length>this.maxEmbeddingsPerCall)throw new aQ({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:a});let f=null!=(e=await dR({provider:"openai",providerOptions:d,schema:j2}))?e:{},{responseHeaders:g,value:h,rawValue:i}=await dT({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:cT(this.config.headers(),b),body:{model:this.modelId,input:a,encoding_format:"float",dimensions:f.dimensions,user:f.user},failedResponseHandler:jO,successfulResponseHandler:d$(j3),abortSignal:c,fetch:this.config.fetch});return{warnings:[],embeddings:h.data.map(a=>a.embedding),usage:h.usage?{tokens:h.usage.prompt_tokens}:void 0,response:{headers:g,body:i}}}},j5=dI(()=>dL(gB({created:gl().nullish(),data:gz(gB({b64_json:f_(),revised_prompt:f_().nullish()})),background:f_().nullish(),output_format:f_().nullish(),size:f_().nullish(),quality:f_().nullish(),usage:gB({input_tokens:gl().nullish(),output_tokens:gl().nullish(),total_tokens:gl().nullish(),input_tokens_details:gB({image_tokens:gl().nullish(),text_tokens:gl().nullish()}).nullish()}).nullish()}))),j6={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10,"gpt-image-1-mini":10,"gpt-image-1.5":10},j7=["gpt-image-1-mini","gpt-image-1.5","gpt-image-1"],j8=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v3"}get maxImagesPerCall(){var a;return null!=(a=j6[this.modelId])?a:1}get provider(){return this.config.provider}async doGenerate({prompt:a,files:b,mask:c,n:d,size:e,aspectRatio:f,seed:g,providerOptions:h,headers:i,abortSignal:j}){var k,l,m,n,o,p,q,r,s,t,u,v;let w=[];null!=f&&w.push({type:"unsupported",feature:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=g&&w.push({type:"unsupported",feature:"seed"});let x=null!=(m=null==(l=null==(k=this.config._internal)?void 0:k.currentDate)?void 0:l.call(k))?m:new Date;if(null!=b){let{value:f,responseHeaders:g}=await dU({url:this.config.url({path:"/images/edits",modelId:this.modelId}),headers:cT(this.config.headers(),i),formData:function(a,b={}){let{useArrayBrackets:c=!0}=b,d=new FormData;for(let[b,e]of Object.entries(a))if(null!=e){if(Array.isArray(e)){if(1===e.length){d.append(b,e[0]);continue}let a=c?`${b}[]`:b;for(let b of e)d.append(a,b);continue}d.append(b,e)}return d}({model:this.modelId,prompt:a,image:await Promise.all(b.map(a=>"file"===a.type?new Blob([a.data instanceof Uint8Array?new Blob([a.data],{type:a.mediaType}):new Blob([cZ(a.data)],{type:a.mediaType})],{type:a.mediaType}):c5(a.url))),mask:null!=c?await ka(c):void 0,n:d,size:e,...null!=(n=h.openai)?n:{}}),failedResponseHandler:jO,successfulResponseHandler:d$(j5),abortSignal:j,fetch:this.config.fetch});return{images:f.data.map(a=>a.b64_json),warnings:w,usage:null!=f.usage?{inputTokens:null!=(o=f.usage.input_tokens)?o:void 0,outputTokens:null!=(p=f.usage.output_tokens)?p:void 0,totalTokens:null!=(q=f.usage.total_tokens)?q:void 0}:void 0,response:{timestamp:x,modelId:this.modelId,headers:g},providerMetadata:{openai:{images:f.data.map((a,b)=>{var c,d,e,g,h,i;return{...a.revised_prompt?{revisedPrompt:a.revised_prompt}:{},created:null!=(c=f.created)?c:void 0,size:null!=(d=f.size)?d:void 0,quality:null!=(e=f.quality)?e:void 0,background:null!=(g=f.background)?g:void 0,outputFormat:null!=(h=f.output_format)?h:void 0,...j9(null==(i=f.usage)?void 0:i.input_tokens_details,b,f.data.length)}})}}}}let{value:y,responseHeaders:z}=await dT({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:cT(this.config.headers(),i),body:{model:this.modelId,prompt:a,n:d,size:e,...null!=(r=h.openai)?r:{},...(v=this.modelId,!j7.some(a=>v.startsWith(a)))?{response_format:"b64_json"}:{}},failedResponseHandler:jO,successfulResponseHandler:d$(j5),abortSignal:j,fetch:this.config.fetch});return{images:y.data.map(a=>a.b64_json),warnings:w,usage:null!=y.usage?{inputTokens:null!=(s=y.usage.input_tokens)?s:void 0,outputTokens:null!=(t=y.usage.output_tokens)?t:void 0,totalTokens:null!=(u=y.usage.total_tokens)?u:void 0}:void 0,response:{timestamp:x,modelId:this.modelId,headers:z},providerMetadata:{openai:{images:y.data.map((a,b)=>{var c,d,e,f,g,h;return{...a.revised_prompt?{revisedPrompt:a.revised_prompt}:{},created:null!=(c=y.created)?c:void 0,size:null!=(d=y.size)?d:void 0,quality:null!=(e=y.quality)?e:void 0,background:null!=(f=y.background)?f:void 0,outputFormat:null!=(g=y.output_format)?g:void 0,...j9(null==(h=y.usage)?void 0:h.input_tokens_details,b,y.data.length)}})}}}}};function j9(a,b,c){if(null==a)return{};let d={};if(null!=a.image_tokens){let e=Math.floor(a.image_tokens/c),f=a.image_tokens-e*(c-1);d.imageTokens=b===c-1?f:e}if(null!=a.text_tokens){let e=Math.floor(a.text_tokens/c),f=a.text_tokens-e*(c-1);d.textTokens=b===c-1?f:e}return d}async function ka(a){return a?"url"===a.type?c5(a.url):new Blob([a.data instanceof Uint8Array?a.data:cZ(a.data)],{type:a.mediaType}):void 0}var kb=dI(()=>dL(gB({callId:f_(),operation:gG("type",[gB({type:gN("create_file"),path:f_(),diff:f_()}),gB({type:gN("delete_file"),path:f_()}),gB({type:gN("update_file"),path:f_(),diff:f_()})])}))),kc=dI(()=>dL(gB({status:gL(["completed","failed"]),output:f_().optional()})));dI(()=>dL(gB({})));var kd=dW({id:"openai.apply_patch",inputSchema:kb,outputSchema:kc}),ke=dI(()=>dL(gB({code:f_().nullish(),containerId:f_()}))),kf=dI(()=>dL(gB({outputs:gz(gG("type",[gB({type:gN("logs"),logs:f_()}),gB({type:gN("image"),url:f_()})])).nullish()}))),kg=dI(()=>dL(gB({container:gE([f_(),gB({fileIds:gz(f_()).optional()})]).optional()}))),kh=dW({id:"openai.code_interpreter",inputSchema:ke,outputSchema:kf}),ki=gB({key:f_(),type:gL(["eq","ne","gt","gte","lt","lte","in","nin"]),value:gE([f_(),gl(),gp(),gz(f_())])}),kj=gB({type:gL(["and","or"]),filters:gz(gE([ki,g_(()=>kj)]))}),kk=dI(()=>dL(gB({vectorStoreIds:gz(f_()),maxNumResults:gl().optional(),ranking:gB({ranker:f_().optional(),scoreThreshold:gl().optional()}).optional(),filters:gE([ki,kj]).optional()}))),kl=dI(()=>dL(gB({queries:gz(f_()),results:gz(gB({attributes:gJ(f_(),gv()),fileId:f_(),filename:f_(),score:gl(),text:f_()})).nullable()}))),km=dW({id:"openai.file_search",inputSchema:gB({}),outputSchema:kl}),kn=dI(()=>dL(gB({background:gL(["auto","opaque","transparent"]).optional(),inputFidelity:gL(["low","high"]).optional(),inputImageMask:gB({fileId:f_().optional(),imageUrl:f_().optional()}).optional(),model:f_().optional(),moderation:gL(["auto"]).optional(),outputCompression:gl().int().min(0).max(100).optional(),outputFormat:gL(["png","jpeg","webp"]).optional(),partialImages:gl().int().min(0).max(3).optional(),quality:gL(["auto","low","medium","high"]).optional(),size:gL(["1024x1024","1024x1536","1536x1024","auto"]).optional()}).strict())),ko=dW({id:"openai.image_generation",inputSchema:dI(()=>dL(gB({}))),outputSchema:dI(()=>dL(gB({result:f_()})))}),kp=dI(()=>dL(gB({action:gB({type:gN("exec"),command:gz(f_()),timeoutMs:gl().optional(),user:f_().optional(),workingDirectory:f_().optional(),env:gJ(f_(),f_()).optional()})}))),kq=dI(()=>dL(gB({output:f_()}))),kr=dW({id:"openai.local_shell",inputSchema:kp,outputSchema:kq}),ks=dI(()=>dL(gB({action:gB({commands:gz(f_()),timeoutMs:gl().optional(),maxOutputLength:gl().optional()})}))),kt=dI(()=>dL(gB({output:gz(gB({stdout:f_(),stderr:f_(),outcome:gG("type",[gB({type:gN("timeout")}),gB({type:gN("exit"),exitCode:gl()})])}))}))),ku=dW({id:"openai.shell",inputSchema:ks,outputSchema:kt}),kv=dI(()=>dL(gB({externalWebAccess:gp().optional(),filters:gB({allowedDomains:gz(f_()).optional()}).optional(),searchContextSize:gL(["low","medium","high"]).optional(),userLocation:gB({type:gN("approximate"),country:f_().optional(),city:f_().optional(),region:f_().optional(),timezone:f_().optional()}).optional()}))),kw=dW({id:"openai.web_search",inputSchema:dI(()=>dL(gB({}))),outputSchema:dI(()=>dL(gB({action:gG("type",[gB({type:gN("search"),query:f_().optional()}),gB({type:gN("openPage"),url:f_().nullish()}),gB({type:gN("findInPage"),url:f_().nullish(),pattern:f_().nullish()})]),sources:gz(gG("type",[gB({type:gN("url"),url:f_()}),gB({type:gN("api"),name:f_()})])).optional()})))}),kx=dI(()=>dL(gB({searchContextSize:gL(["low","medium","high"]).optional(),userLocation:gB({type:gN("approximate"),country:f_().optional(),city:f_().optional(),region:f_().optional(),timezone:f_().optional()}).optional()}))),ky=dW({id:"openai.web_search_preview",inputSchema:dI(()=>dL(gB({}))),outputSchema:dI(()=>dL(gB({action:gG("type",[gB({type:gN("search"),query:f_().optional()}),gB({type:gN("openPage"),url:f_().nullish()}),gB({type:gN("findInPage"),url:f_().nullish(),pattern:f_().nullish()})])})))}),kz=g_(()=>gE([f_(),gl(),gp(),gr(),gz(kz),gJ(f_(),kz)])),kA=dI(()=>dL(gB({serverLabel:f_(),allowedTools:gE([gz(f_()),gB({readOnly:gp().optional(),toolNames:gz(f_()).optional()})]).optional(),authorization:f_().optional(),connectorId:f_().optional(),headers:gJ(f_(),f_()).optional(),requireApproval:gE([gL(["always","never"]),gB({never:gB({toolNames:gz(f_()).optional()}).optional()})]).optional(),serverDescription:f_().optional(),serverUrl:f_().optional()}).refine(a=>null!=a.serverUrl||null!=a.connectorId,"One of serverUrl or connectorId must be provided."))),kB=dW({id:"openai.mcp",inputSchema:dI(()=>dL(gB({}))),outputSchema:dI(()=>dL(gB({type:gN("call"),serverLabel:f_(),name:f_(),arguments:f_(),output:f_().nullish(),error:gE([f_(),kz]).optional()})))}),kC={applyPatch:kd,codeInterpreter:(a={})=>kh(a),fileSearch:km,imageGeneration:(a={})=>ko(a),localShell:kr,shell:ku,webSearchPreview:ky,webSearch:(a={})=>kw(a),mcp:a=>kB(a)};function kD(a){var b,c,d,e;if(null==a)return{inputTokens:{total:void 0,noCache:void 0,cacheRead:void 0,cacheWrite:void 0},outputTokens:{total:void 0,text:void 0,reasoning:void 0},raw:void 0};let f=a.input_tokens,g=a.output_tokens,h=null!=(c=null==(b=a.input_tokens_details)?void 0:b.cached_tokens)?c:0,i=null!=(e=null==(d=a.output_tokens_details)?void 0:d.reasoning_tokens)?e:0;return{inputTokens:{total:f,noCache:f-h,cacheRead:h,cacheWrite:void 0},outputTokens:{total:g,text:g-i,reasoning:i},raw:a}}function kE(a,b){return!!b&&b.some(b=>a.startsWith(b))}async function kF({prompt:a,toolNameMapping:b,systemMessageMode:c,providerOptionsName:d,fileIdPrefixes:e,store:f,hasConversation:g=!1,hasLocalShellTool:h=!1,hasShellTool:i=!1,hasApplyPatchTool:j=!1}){var k,l,m,n,o,p,q,r,s,t,u,v,w;let x=[],y=[],z=new Set;for(let{role:A,content:B}of a)switch(A){case"system":switch(c){case"system":x.push({role:"system",content:B});break;case"developer":x.push({role:"developer",content:B});break;case"remove":y.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${c}`)}break;case"user":x.push({role:"user",content:B.map((a,b)=>{var c,f,g;switch(a.type){case"text":return{type:"input_text",text:a.text};case"file":if(a.mediaType.startsWith("image/")){let b="image/*"===a.mediaType?"image/jpeg":a.mediaType;return{type:"input_image",...a.data instanceof URL?{image_url:a.data.toString()}:"string"==typeof a.data&&kE(a.data,e)?{file_id:a.data}:{image_url:`data:${b};base64,${c_(a.data)}`},detail:null==(f=null==(c=a.providerOptions)?void 0:c[d])?void 0:f.imageDetail}}if("application/pdf"===a.mediaType){if(a.data instanceof URL)return{type:"input_file",file_url:a.data.toString()};return{type:"input_file",..."string"==typeof a.data&&kE(a.data,e)?{file_id:a.data}:{filename:null!=(g=a.filename)?g:`part-${b}.pdf`,file_data:`data:application/pdf;base64,${c_(a.data)}`}}}throw new aY({functionality:`file part media type ${a.mediaType}`})}})});break;case"assistant":{let a={};for(let c of B)switch(c.type){case"text":{let a=null==(l=null==(k=c.providerOptions)?void 0:k[d])?void 0:l.itemId;if(g&&null!=a)break;if(f&&null!=a){x.push({type:"item_reference",id:a});break}x.push({role:"assistant",content:[{type:"output_text",text:c.text}],id:a});break}case"tool-call":{let a=null!=(q=null==(n=null==(m=c.providerOptions)?void 0:m[d])?void 0:n.itemId)?q:null==(p=null==(o=c.providerMetadata)?void 0:o[d])?void 0:p.itemId;if(g&&null!=a)break;if(c.providerExecuted){f&&null!=a&&x.push({type:"item_reference",id:a});break}if(f&&null!=a){x.push({type:"item_reference",id:a});break}let e=b.toProviderToolName(c.toolName);if(h&&"local_shell"===e){let b=await dM({value:c.input,schema:kp});x.push({type:"local_shell_call",call_id:c.toolCallId,id:a,action:{type:"exec",command:b.action.command,timeout_ms:b.action.timeoutMs,user:b.action.user,working_directory:b.action.workingDirectory,env:b.action.env}});break}if(i&&"shell"===e){let b=await dM({value:c.input,schema:ks});x.push({type:"shell_call",call_id:c.toolCallId,id:a,status:"completed",action:{commands:b.action.commands,timeout_ms:b.action.timeoutMs,max_output_length:b.action.maxOutputLength}});break}if(j&&"apply_patch"===e){let b=await dM({value:c.input,schema:kb});x.push({type:"apply_patch_call",call_id:b.callId,id:a,status:"completed",operation:b.operation});break}x.push({type:"function_call",call_id:c.toolCallId,name:e,arguments:JSON.stringify(c.input),id:a});break}case"tool-result":if("execution-denied"===c.output.type||"json"===c.output.type&&"object"==typeof c.output.value&&null!=c.output.value&&"type"in c.output.value&&"execution-denied"===c.output.value.type||g)break;if(f){let a=null!=(t=null==(s=null==(r=c.providerMetadata)?void 0:r[d])?void 0:s.itemId)?t:c.toolCallId;x.push({type:"item_reference",id:a})}else y.push({type:"other",message:`Results for OpenAI tool ${c.toolName} are not sent to the API when store is false`});break;case"reasoning":{let b=await dR({provider:d,providerOptions:c.providerOptions,schema:kG}),e=null==b?void 0:b.itemId;if(g&&null!=e)break;if(null!=e){let d=a[e];if(f)void 0===d&&(x.push({type:"item_reference",id:e}),a[e]={type:"reasoning",id:e,summary:[]});else{let f=[];c.text.length>0?f.push({type:"summary_text",text:c.text}):void 0!==d&&y.push({type:"other",message:`Cannot append empty reasoning part to existing reasoning sequence. Skipping reasoning part: ${JSON.stringify(c)}.`}),void 0===d?(a[e]={type:"reasoning",id:e,encrypted_content:null==b?void 0:b.reasoningEncryptedContent,summary:f},x.push(a[e])):(d.summary.push(...f),(null==b?void 0:b.reasoningEncryptedContent)!=null&&(d.encrypted_content=b.reasoningEncryptedContent))}}else y.push({type:"other",message:`Non-OpenAI reasoning parts are not supported. Skipping reasoning part: ${JSON.stringify(c)}.`})}}break}case"tool":for(let a of B){let c;if("tool-approval-response"===a.type){if(z.has(a.approvalId))continue;z.add(a.approvalId),f&&x.push({type:"item_reference",id:a.approvalId}),x.push({type:"mcp_approval_response",approval_request_id:a.approvalId,approve:a.approved});continue}let d=a.output;if("execution-denied"===d.type&&(null==(v=null==(u=d.providerOptions)?void 0:u.openai)?void 0:v.approvalId))continue;let e=b.toProviderToolName(a.toolName);if(h&&"local_shell"===e&&"json"===d.type){let b=await dM({value:d.value,schema:kq});x.push({type:"local_shell_call_output",call_id:a.toolCallId,output:b.output});continue}if(i&&"shell"===e&&"json"===d.type){let b=await dM({value:d.value,schema:kt});x.push({type:"shell_call_output",call_id:a.toolCallId,output:b.output.map(a=>({stdout:a.stdout,stderr:a.stderr,outcome:"timeout"===a.outcome.type?{type:"timeout"}:{type:"exit",exit_code:a.outcome.exitCode}}))});continue}if(j&&"apply_patch"===a.toolName&&"json"===d.type){let b=await dM({value:d.value,schema:kc});x.push({type:"apply_patch_call_output",call_id:a.toolCallId,status:b.status,output:b.output});continue}switch(d.type){case"text":case"error-text":c=d.value;break;case"execution-denied":c=null!=(w=d.reason)?w:"Tool execution denied.";break;case"json":case"error-json":c=JSON.stringify(d.value);break;case"content":c=d.value.map(a=>{var b;switch(a.type){case"text":return{type:"input_text",text:a.text};case"image-data":return{type:"input_image",image_url:`data:${a.mediaType};base64,${a.data}`};case"image-url":return{type:"input_image",image_url:a.url};case"file-data":return{type:"input_file",filename:null!=(b=a.filename)?b:"data",file_data:`data:${a.mediaType};base64,${a.data}`};default:return void y.push({type:"other",message:`unsupported tool content part type: ${a.type}`})}}).filter(di)}x.push({type:"function_call_output",call_id:a.toolCallId,output:c})}break;default:throw Error(`Unsupported role: ${A}`)}return{input:x,warnings:y}}var kG=gB({itemId:f_().nullish(),reasoningEncryptedContent:f_().nullish()});function kH({finishReason:a,hasFunctionCall:b}){switch(a){case void 0:case null:return b?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return b?"tool-calls":"other"}}var kI=dI(()=>dL(gE([gB({type:gN("response.output_text.delta"),item_id:f_(),delta:f_(),logprobs:gz(gB({token:f_(),logprob:gl(),top_logprobs:gz(gB({token:f_(),logprob:gl()}))})).nullish()}),gB({type:gL(["response.completed","response.incomplete"]),response:gB({incomplete_details:gB({reason:f_()}).nullish(),usage:gB({input_tokens:gl(),input_tokens_details:gB({cached_tokens:gl().nullish()}).nullish(),output_tokens:gl(),output_tokens_details:gB({reasoning_tokens:gl().nullish()}).nullish()}),service_tier:f_().nullish()})}),gB({type:gN("response.created"),response:gB({id:f_(),created_at:gl(),model:f_(),service_tier:f_().nullish()})}),gB({type:gN("response.output_item.added"),output_index:gl(),item:gG("type",[gB({type:gN("message"),id:f_()}),gB({type:gN("reasoning"),id:f_(),encrypted_content:f_().nullish()}),gB({type:gN("function_call"),id:f_(),call_id:f_(),name:f_(),arguments:f_()}),gB({type:gN("web_search_call"),id:f_(),status:f_()}),gB({type:gN("computer_call"),id:f_(),status:f_()}),gB({type:gN("file_search_call"),id:f_()}),gB({type:gN("image_generation_call"),id:f_()}),gB({type:gN("code_interpreter_call"),id:f_(),container_id:f_(),code:f_().nullable(),outputs:gz(gG("type",[gB({type:gN("logs"),logs:f_()}),gB({type:gN("image"),url:f_()})])).nullable(),status:f_()}),gB({type:gN("mcp_call"),id:f_(),status:f_(),approval_request_id:f_().nullish()}),gB({type:gN("mcp_list_tools"),id:f_()}),gB({type:gN("mcp_approval_request"),id:f_()}),gB({type:gN("apply_patch_call"),id:f_(),call_id:f_(),status:gL(["in_progress","completed"]),operation:gG("type",[gB({type:gN("create_file"),path:f_(),diff:f_()}),gB({type:gN("delete_file"),path:f_()}),gB({type:gN("update_file"),path:f_(),diff:f_()})])}),gB({type:gN("shell_call"),id:f_(),call_id:f_(),status:gL(["in_progress","completed","incomplete"]),action:gB({commands:gz(f_())})})])}),gB({type:gN("response.output_item.done"),output_index:gl(),item:gG("type",[gB({type:gN("message"),id:f_()}),gB({type:gN("reasoning"),id:f_(),encrypted_content:f_().nullish()}),gB({type:gN("function_call"),id:f_(),call_id:f_(),name:f_(),arguments:f_(),status:gN("completed")}),gB({type:gN("code_interpreter_call"),id:f_(),code:f_().nullable(),container_id:f_(),outputs:gz(gG("type",[gB({type:gN("logs"),logs:f_()}),gB({type:gN("image"),url:f_()})])).nullable()}),gB({type:gN("image_generation_call"),id:f_(),result:f_()}),gB({type:gN("web_search_call"),id:f_(),status:f_(),action:gG("type",[gB({type:gN("search"),query:f_().nullish(),sources:gz(gG("type",[gB({type:gN("url"),url:f_()}),gB({type:gN("api"),name:f_()})])).nullish()}),gB({type:gN("open_page"),url:f_().nullish()}),gB({type:gN("find_in_page"),url:f_().nullish(),pattern:f_().nullish()})])}),gB({type:gN("file_search_call"),id:f_(),queries:gz(f_()),results:gz(gB({attributes:gJ(f_(),gE([f_(),gl(),gp()])),file_id:f_(),filename:f_(),score:gl(),text:f_()})).nullish()}),gB({type:gN("local_shell_call"),id:f_(),call_id:f_(),action:gB({type:gN("exec"),command:gz(f_()),timeout_ms:gl().optional(),user:f_().optional(),working_directory:f_().optional(),env:gJ(f_(),f_()).optional()})}),gB({type:gN("computer_call"),id:f_(),status:gN("completed")}),gB({type:gN("mcp_call"),id:f_(),status:f_(),arguments:f_(),name:f_(),server_label:f_(),output:f_().nullish(),error:gE([f_(),gB({type:f_().optional(),code:gE([gl(),f_()]).optional(),message:f_().optional()}).loose()]).nullish(),approval_request_id:f_().nullish()}),gB({type:gN("mcp_list_tools"),id:f_(),server_label:f_(),tools:gz(gB({name:f_(),description:f_().optional(),input_schema:gt(),annotations:gJ(f_(),gv()).optional()})),error:gE([f_(),gB({type:f_().optional(),code:gE([gl(),f_()]).optional(),message:f_().optional()}).loose()]).optional()}),gB({type:gN("mcp_approval_request"),id:f_(),server_label:f_(),name:f_(),arguments:f_(),approval_request_id:f_().optional()}),gB({type:gN("apply_patch_call"),id:f_(),call_id:f_(),status:gL(["in_progress","completed"]),operation:gG("type",[gB({type:gN("create_file"),path:f_(),diff:f_()}),gB({type:gN("delete_file"),path:f_()}),gB({type:gN("update_file"),path:f_(),diff:f_()})])}),gB({type:gN("shell_call"),id:f_(),call_id:f_(),status:gL(["in_progress","completed","incomplete"]),action:gB({commands:gz(f_())})})])}),gB({type:gN("response.function_call_arguments.delta"),item_id:f_(),output_index:gl(),delta:f_()}),gB({type:gN("response.image_generation_call.partial_image"),item_id:f_(),output_index:gl(),partial_image_b64:f_()}),gB({type:gN("response.code_interpreter_call_code.delta"),item_id:f_(),output_index:gl(),delta:f_()}),gB({type:gN("response.code_interpreter_call_code.done"),item_id:f_(),output_index:gl(),code:f_()}),gB({type:gN("response.output_text.annotation.added"),annotation:gG("type",[gB({type:gN("url_citation"),start_index:gl(),end_index:gl(),url:f_(),title:f_()}),gB({type:gN("file_citation"),file_id:f_(),filename:f_(),index:gl()}),gB({type:gN("container_file_citation"),container_id:f_(),file_id:f_(),filename:f_(),start_index:gl(),end_index:gl()}),gB({type:gN("file_path"),file_id:f_(),index:gl()})])}),gB({type:gN("response.reasoning_summary_part.added"),item_id:f_(),summary_index:gl()}),gB({type:gN("response.reasoning_summary_text.delta"),item_id:f_(),summary_index:gl(),delta:f_()}),gB({type:gN("response.reasoning_summary_part.done"),item_id:f_(),summary_index:gl()}),gB({type:gN("response.apply_patch_call_operation_diff.delta"),item_id:f_(),output_index:gl(),delta:f_(),obfuscation:f_().nullish()}),gB({type:gN("response.apply_patch_call_operation_diff.done"),item_id:f_(),output_index:gl(),diff:f_()}),gB({type:gN("error"),sequence_number:gl(),error:gB({type:f_(),code:f_(),message:f_(),param:f_().nullish()})}),gB({type:f_()}).loose().transform(a=>({type:"unknown_chunk",message:a.type}))]))),kJ=dI(()=>dL(gB({id:f_().optional(),created_at:gl().optional(),error:gB({message:f_(),type:f_(),param:f_().nullish(),code:f_()}).nullish(),model:f_().optional(),output:gz(gG("type",[gB({type:gN("message"),role:gN("assistant"),id:f_(),content:gz(gB({type:gN("output_text"),text:f_(),logprobs:gz(gB({token:f_(),logprob:gl(),top_logprobs:gz(gB({token:f_(),logprob:gl()}))})).nullish(),annotations:gz(gG("type",[gB({type:gN("url_citation"),start_index:gl(),end_index:gl(),url:f_(),title:f_()}),gB({type:gN("file_citation"),file_id:f_(),filename:f_(),index:gl()}),gB({type:gN("container_file_citation"),container_id:f_(),file_id:f_(),filename:f_(),start_index:gl(),end_index:gl()}),gB({type:gN("file_path"),file_id:f_(),index:gl()})]))}))}),gB({type:gN("web_search_call"),id:f_(),status:f_(),action:gG("type",[gB({type:gN("search"),query:f_().nullish(),sources:gz(gG("type",[gB({type:gN("url"),url:f_()}),gB({type:gN("api"),name:f_()})])).nullish()}),gB({type:gN("open_page"),url:f_().nullish()}),gB({type:gN("find_in_page"),url:f_().nullish(),pattern:f_().nullish()})])}),gB({type:gN("file_search_call"),id:f_(),queries:gz(f_()),results:gz(gB({attributes:gJ(f_(),gE([f_(),gl(),gp()])),file_id:f_(),filename:f_(),score:gl(),text:f_()})).nullish()}),gB({type:gN("code_interpreter_call"),id:f_(),code:f_().nullable(),container_id:f_(),outputs:gz(gG("type",[gB({type:gN("logs"),logs:f_()}),gB({type:gN("image"),url:f_()})])).nullable()}),gB({type:gN("image_generation_call"),id:f_(),result:f_()}),gB({type:gN("local_shell_call"),id:f_(),call_id:f_(),action:gB({type:gN("exec"),command:gz(f_()),timeout_ms:gl().optional(),user:f_().optional(),working_directory:f_().optional(),env:gJ(f_(),f_()).optional()})}),gB({type:gN("function_call"),call_id:f_(),name:f_(),arguments:f_(),id:f_()}),gB({type:gN("computer_call"),id:f_(),status:f_().optional()}),gB({type:gN("reasoning"),id:f_(),encrypted_content:f_().nullish(),summary:gz(gB({type:gN("summary_text"),text:f_()}))}),gB({type:gN("mcp_call"),id:f_(),status:f_(),arguments:f_(),name:f_(),server_label:f_(),output:f_().nullish(),error:gE([f_(),gB({type:f_().optional(),code:gE([gl(),f_()]).optional(),message:f_().optional()}).loose()]).nullish(),approval_request_id:f_().nullish()}),gB({type:gN("mcp_list_tools"),id:f_(),server_label:f_(),tools:gz(gB({name:f_(),description:f_().optional(),input_schema:gt(),annotations:gJ(f_(),gv()).optional()})),error:gE([f_(),gB({type:f_().optional(),code:gE([gl(),f_()]).optional(),message:f_().optional()}).loose()]).optional()}),gB({type:gN("mcp_approval_request"),id:f_(),server_label:f_(),name:f_(),arguments:f_(),approval_request_id:f_().optional()}),gB({type:gN("apply_patch_call"),id:f_(),call_id:f_(),status:gL(["in_progress","completed"]),operation:gG("type",[gB({type:gN("create_file"),path:f_(),diff:f_()}),gB({type:gN("delete_file"),path:f_()}),gB({type:gN("update_file"),path:f_(),diff:f_()})])}),gB({type:gN("shell_call"),id:f_(),call_id:f_(),status:gL(["in_progress","completed","incomplete"]),action:gB({commands:gz(f_())})})])).optional(),service_tier:f_().nullish(),incomplete_details:gB({reason:f_()}).nullish(),usage:gB({input_tokens:gl(),input_tokens_details:gB({cached_tokens:gl().nullish()}).nullish(),output_tokens:gl(),output_tokens_details:gB({reasoning_tokens:gl().nullish()}).nullish()}).optional()}))),kK=dI(()=>dL(gB({conversation:f_().nullish(),include:gz(gL(["reasoning.encrypted_content","file_search_call.results","message.output_text.logprobs"])).nullish(),instructions:f_().nullish(),logprobs:gE([gp(),gl().min(1).max(20)]).optional(),maxToolCalls:gl().nullish(),metadata:gt().nullish(),parallelToolCalls:gp().nullish(),previousResponseId:f_().nullish(),promptCacheKey:f_().nullish(),promptCacheRetention:gL(["in_memory","24h"]).nullish(),reasoningEffort:f_().nullish(),reasoningSummary:f_().nullish(),safetyIdentifier:f_().nullish(),serviceTier:gL(["auto","flex","priority","default"]).nullish(),store:gp().nullish(),strictJsonSchema:gp().nullish(),textVerbosity:gL(["low","medium","high"]).nullish(),truncation:gL(["auto","disabled"]).nullish(),user:f_().nullish(),systemMessageMode:gL(["system","developer","remove"]).optional(),forceReasoning:gp().optional()})));async function kL({tools:a,toolChoice:b}){a=(null==a?void 0:a.length)?a:void 0;let c=[];if(null==a)return{tools:void 0,toolChoice:void 0,toolWarnings:c};let d=[];for(let b of a)switch(b.type){case"function":d.push({type:"function",name:b.name,description:b.description,parameters:b.inputSchema,...null!=b.strict?{strict:b.strict}:{}});break;case"provider":switch(b.id){case"openai.file_search":{let a=await dM({value:b.args,schema:kk});d.push({type:"file_search",vector_store_ids:a.vectorStoreIds,max_num_results:a.maxNumResults,ranking_options:a.ranking?{ranker:a.ranking.ranker,score_threshold:a.ranking.scoreThreshold}:void 0,filters:a.filters});break}case"openai.local_shell":d.push({type:"local_shell"});break;case"openai.shell":d.push({type:"shell"});break;case"openai.apply_patch":d.push({type:"apply_patch"});break;case"openai.web_search_preview":{let a=await dM({value:b.args,schema:kx});d.push({type:"web_search_preview",search_context_size:a.searchContextSize,user_location:a.userLocation});break}case"openai.web_search":{let a=await dM({value:b.args,schema:kv});d.push({type:"web_search",filters:null!=a.filters?{allowed_domains:a.filters.allowedDomains}:void 0,external_web_access:a.externalWebAccess,search_context_size:a.searchContextSize,user_location:a.userLocation});break}case"openai.code_interpreter":{let a=await dM({value:b.args,schema:kg});d.push({type:"code_interpreter",container:null==a.container?{type:"auto",file_ids:void 0}:"string"==typeof a.container?a.container:{type:"auto",file_ids:a.container.fileIds}});break}case"openai.image_generation":{let a=await dM({value:b.args,schema:kn});d.push({type:"image_generation",background:a.background,input_fidelity:a.inputFidelity,input_image_mask:a.inputImageMask?{file_id:a.inputImageMask.fileId,image_url:a.inputImageMask.imageUrl}:void 0,model:a.model,moderation:a.moderation,partial_images:a.partialImages,quality:a.quality,output_compression:a.outputCompression,output_format:a.outputFormat,size:a.size});break}case"openai.mcp":{let a=await dM({value:b.args,schema:kA}),c=a=>({tool_names:a.toolNames}),e=a.requireApproval,f=null==e?void 0:"string"==typeof e?e:null!=e.never?{never:c(e.never)}:void 0;d.push({type:"mcp",server_label:a.serverLabel,allowed_tools:Array.isArray(a.allowedTools)?a.allowedTools:a.allowedTools?{read_only:a.allowedTools.readOnly,tool_names:a.allowedTools.toolNames}:void 0,authorization:a.authorization,connector_id:a.connectorId,headers:a.headers,require_approval:null!=f?f:"never",server_description:a.serverDescription,server_url:a.serverUrl})}}break;default:c.push({type:"unsupported",feature:`function tool ${b}`})}if(null==b)return{tools:d,toolChoice:void 0,toolWarnings:c};let e=b.type;switch(e){case"auto":case"none":case"required":return{tools:d,toolChoice:e,toolWarnings:c};case"tool":return{tools:d,toolChoice:"code_interpreter"===b.toolName||"file_search"===b.toolName||"image_generation"===b.toolName||"web_search_preview"===b.toolName||"web_search"===b.toolName||"mcp"===b.toolName||"apply_patch"===b.toolName?{type:b.toolName}:{type:"function",name:b.toolName},toolWarnings:c};default:throw new aY({functionality:`tool choice type: ${e}`})}}function kM(a){var b,c;let d={};for(let e of a)if("assistant"===e.role)for(let a of e.content){if("tool-call"!==a.type)continue;let e=null==(c=null==(b=a.providerOptions)?void 0:b.openai)?void 0:c.approvalRequestId;null!=e&&(d[e]=a.toolCallId)}return d}var kN=class{constructor(a,b){this.specificationVersion="v3",this.supportedUrls={"image/*":[/^https?:\/\/.*$/],"application/pdf":[/^https?:\/\/.*$/]},this.modelId=a,this.config=b}get provider(){return this.config.provider}async getArgs({maxOutputTokens:a,temperature:b,stopSequences:c,topP:d,topK:e,presencePenalty:f,frequencyPenalty:g,seed:h,prompt:i,providerOptions:j,tools:k,toolChoice:l,responseFormat:m}){var n,o,p,q,r,s;let t=[],u=jP(this.modelId);null!=e&&t.push({type:"unsupported",feature:"topK"}),null!=h&&t.push({type:"unsupported",feature:"seed"}),null!=f&&t.push({type:"unsupported",feature:"presencePenalty"}),null!=g&&t.push({type:"unsupported",feature:"frequencyPenalty"}),null!=c&&t.push({type:"unsupported",feature:"stopSequences"});let v=this.config.provider.includes("azure")?"azure":"openai",w=await dR({provider:v,providerOptions:j,schema:kK});null==w&&"openai"!==v&&(w=await dR({provider:"openai",providerOptions:j,schema:kK}));let x=null!=(n=null==w?void 0:w.forceReasoning)?n:u.isReasoningModel;(null==w?void 0:w.conversation)&&(null==w?void 0:w.previousResponseId)&&t.push({type:"unsupported",feature:"conversation",details:"conversation and previousResponseId cannot be used together"});let y=function({tools:a=[],providerToolNames:b}){let c={},d={};for(let e of a)if("provider"===e.type&&e.id in b){let a=b[e.id];c[e.name]=a,d[a]=e.name}return{toProviderToolName:a=>{var b;return null!=(b=c[a])?b:a},toCustomToolName:a=>{var b;return null!=(b=d[a])?b:a}}}({tools:k,providerToolNames:{"openai.code_interpreter":"code_interpreter","openai.file_search":"file_search","openai.image_generation":"image_generation","openai.local_shell":"local_shell","openai.shell":"shell","openai.web_search":"web_search","openai.web_search_preview":"web_search_preview","openai.mcp":"mcp","openai.apply_patch":"apply_patch"}}),{input:z,warnings:A}=await kF({prompt:i,toolNameMapping:y,systemMessageMode:null!=(o=null==w?void 0:w.systemMessageMode)?o:x?"developer":u.systemMessageMode,providerOptionsName:v,fileIdPrefixes:this.config.fileIdPrefixes,store:null==(p=null==w?void 0:w.store)||p,hasConversation:(null==w?void 0:w.conversation)!=null,hasLocalShellTool:E("openai.local_shell"),hasShellTool:E("openai.shell"),hasApplyPatchTool:E("openai.apply_patch")});t.push(...A);let B=null==(q=null==w?void 0:w.strictJsonSchema)||q,C=null==w?void 0:w.include;function D(a){null==C?C=[a]:C.includes(a)||(C=[...C,a])}function E(a){return(null==k?void 0:k.find(b=>"provider"===b.type&&b.id===a))!=null}let F="number"==typeof(null==w?void 0:w.logprobs)?null==w?void 0:w.logprobs:(null==w?void 0:w.logprobs)===!0?20:void 0;F&&D("message.output_text.logprobs");let G=null==(r=null==k?void 0:k.find(a=>"provider"===a.type&&("openai.web_search"===a.id||"openai.web_search_preview"===a.id)))?void 0:r.name;G&&D("web_search_call.action.sources"),E("openai.code_interpreter")&&D("code_interpreter_call.outputs");let H=null==w?void 0:w.store;!1===H&&x&&D("reasoning.encrypted_content");let I={model:this.modelId,input:z,temperature:b,top_p:d,max_output_tokens:a,...((null==m?void 0:m.type)==="json"||(null==w?void 0:w.textVerbosity))&&{text:{...(null==m?void 0:m.type)==="json"&&{format:null!=m.schema?{type:"json_schema",strict:B,name:null!=(s=m.name)?s:"response",description:m.description,schema:m.schema}:{type:"json_object"}},...(null==w?void 0:w.textVerbosity)&&{verbosity:w.textVerbosity}}},conversation:null==w?void 0:w.conversation,max_tool_calls:null==w?void 0:w.maxToolCalls,metadata:null==w?void 0:w.metadata,parallel_tool_calls:null==w?void 0:w.parallelToolCalls,previous_response_id:null==w?void 0:w.previousResponseId,store:H,user:null==w?void 0:w.user,instructions:null==w?void 0:w.instructions,service_tier:null==w?void 0:w.serviceTier,include:C,prompt_cache_key:null==w?void 0:w.promptCacheKey,prompt_cache_retention:null==w?void 0:w.promptCacheRetention,safety_identifier:null==w?void 0:w.safetyIdentifier,top_logprobs:F,truncation:null==w?void 0:w.truncation,...x&&((null==w?void 0:w.reasoningEffort)!=null||(null==w?void 0:w.reasoningSummary)!=null)&&{reasoning:{...(null==w?void 0:w.reasoningEffort)!=null&&{effort:w.reasoningEffort},...(null==w?void 0:w.reasoningSummary)!=null&&{summary:w.reasoningSummary}}}};x?(null==w?void 0:w.reasoningEffort)==="none"&&u.supportsNonReasoningParameters||(null!=I.temperature&&(I.temperature=void 0,t.push({type:"unsupported",feature:"temperature",details:"temperature is not supported for reasoning models"})),null!=I.top_p&&(I.top_p=void 0,t.push({type:"unsupported",feature:"topP",details:"topP is not supported for reasoning models"}))):((null==w?void 0:w.reasoningEffort)!=null&&t.push({type:"unsupported",feature:"reasoningEffort",details:"reasoningEffort is not supported for non-reasoning models"}),(null==w?void 0:w.reasoningSummary)!=null&&t.push({type:"unsupported",feature:"reasoningSummary",details:"reasoningSummary is not supported for non-reasoning models"})),(null==w?void 0:w.serviceTier)!=="flex"||u.supportsFlexProcessing||(t.push({type:"unsupported",feature:"serviceTier",details:"flex processing is only available for o3, o4-mini, and gpt-5 models"}),delete I.service_tier),(null==w?void 0:w.serviceTier)!=="priority"||u.supportsPriorityProcessing||(t.push({type:"unsupported",feature:"serviceTier",details:"priority processing is only available for supported models (gpt-4, gpt-5, gpt-5-mini, o3, o4-mini) and requires Enterprise access. gpt-5-nano is not supported"}),delete I.service_tier);let{tools:J,toolChoice:K,toolWarnings:L}=await kL({tools:k,toolChoice:l});return{webSearchToolName:G,args:{...I,tools:J,tool_choice:K},warnings:[...t,...L],store:H,toolNameMapping:y,providerOptionsName:v}}async doGenerate(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;let{args:A,warnings:B,webSearchToolName:C,toolNameMapping:D,providerOptionsName:E}=await this.getArgs(a),F=this.config.url({path:"/responses",modelId:this.modelId}),G=kM(a.prompt),{responseHeaders:H,value:I,rawValue:J}=await dT({url:F,headers:cT(this.config.headers(),a.headers),body:A,failedResponseHandler:jO,successfulResponseHandler:d$(kJ),abortSignal:a.abortSignal,fetch:this.config.fetch});if(I.error)throw new am({message:I.error.message,url:F,requestBodyValues:A,statusCode:400,responseHeaders:H,responseBody:J,isRetryable:!1});let K=[],L=[],M=!1;for(let x of I.output)switch(x.type){case"reasoning":for(let a of(0===x.summary.length&&x.summary.push({type:"summary_text",text:""}),x.summary))K.push({type:"reasoning",text:a.text,providerMetadata:{[E]:{itemId:x.id,reasoningEncryptedContent:null!=(b=x.encrypted_content)?b:null}}});break;case"image_generation_call":K.push({type:"tool-call",toolCallId:x.id,toolName:D.toCustomToolName("image_generation"),input:"{}",providerExecuted:!0}),K.push({type:"tool-result",toolCallId:x.id,toolName:D.toCustomToolName("image_generation"),result:{result:x.result}});break;case"local_shell_call":K.push({type:"tool-call",toolCallId:x.call_id,toolName:D.toCustomToolName("local_shell"),input:JSON.stringify({action:x.action}),providerMetadata:{[E]:{itemId:x.id}}});break;case"shell_call":K.push({type:"tool-call",toolCallId:x.call_id,toolName:D.toCustomToolName("shell"),input:JSON.stringify({action:{commands:x.action.commands}}),providerMetadata:{[E]:{itemId:x.id}}});break;case"message":for(let b of x.content){(null==(d=null==(c=a.providerOptions)?void 0:c[E])?void 0:d.logprobs)&&b.logprobs&&L.push(b.logprobs);let q={itemId:x.id,...b.annotations.length>0&&{annotations:b.annotations}};for(let a of(K.push({type:"text",text:b.text,providerMetadata:{[E]:q}}),b.annotations))"url_citation"===a.type?K.push({type:"source",sourceType:"url",id:null!=(g=null==(f=(e=this.config).generateId)?void 0:f.call(e))?g:c7(),url:a.url,title:a.title}):"file_citation"===a.type?K.push({type:"source",sourceType:"document",id:null!=(j=null==(i=(h=this.config).generateId)?void 0:i.call(h))?j:c7(),mediaType:"text/plain",title:a.filename,filename:a.filename,providerMetadata:{[E]:{type:a.type,fileId:a.file_id,index:a.index}}}):"container_file_citation"===a.type?K.push({type:"source",sourceType:"document",id:null!=(m=null==(l=(k=this.config).generateId)?void 0:l.call(k))?m:c7(),mediaType:"text/plain",title:a.filename,filename:a.filename,providerMetadata:{[E]:{type:a.type,fileId:a.file_id,containerId:a.container_id}}}):"file_path"===a.type&&K.push({type:"source",sourceType:"document",id:null!=(p=null==(o=(n=this.config).generateId)?void 0:o.call(n))?p:c7(),mediaType:"application/octet-stream",title:a.file_id,filename:a.file_id,providerMetadata:{[E]:{type:a.type,fileId:a.file_id,index:a.index}}})}break;case"function_call":M=!0,K.push({type:"tool-call",toolCallId:x.call_id,toolName:x.name,input:x.arguments,providerMetadata:{[E]:{itemId:x.id}}});break;case"web_search_call":K.push({type:"tool-call",toolCallId:x.id,toolName:D.toCustomToolName(null!=C?C:"web_search"),input:JSON.stringify({}),providerExecuted:!0}),K.push({type:"tool-result",toolCallId:x.id,toolName:D.toCustomToolName(null!=C?C:"web_search"),result:kP(x.action)});break;case"mcp_call":{let a=null!=x.approval_request_id&&null!=(q=G[x.approval_request_id])?q:x.id,b=`mcp.${x.name}`;K.push({type:"tool-call",toolCallId:a,toolName:b,input:x.arguments,providerExecuted:!0,dynamic:!0}),K.push({type:"tool-result",toolCallId:a,toolName:b,result:{type:"call",serverLabel:x.server_label,name:x.name,arguments:x.arguments,...null!=x.output?{output:x.output}:{},...null!=x.error?{error:x.error}:{}},providerMetadata:{[E]:{itemId:x.id}}});break}case"mcp_list_tools":break;case"mcp_approval_request":{let a=null!=(r=x.approval_request_id)?r:x.id,b=null!=(u=null==(t=(s=this.config).generateId)?void 0:t.call(s))?u:c7(),c=`mcp.${x.name}`;K.push({type:"tool-call",toolCallId:b,toolName:c,input:x.arguments,providerExecuted:!0,dynamic:!0}),K.push({type:"tool-approval-request",approvalId:a,toolCallId:b});break}case"computer_call":K.push({type:"tool-call",toolCallId:x.id,toolName:D.toCustomToolName("computer_use"),input:"",providerExecuted:!0}),K.push({type:"tool-result",toolCallId:x.id,toolName:D.toCustomToolName("computer_use"),result:{type:"computer_use_tool_result",status:x.status||"completed"}});break;case"file_search_call":K.push({type:"tool-call",toolCallId:x.id,toolName:D.toCustomToolName("file_search"),input:"{}",providerExecuted:!0}),K.push({type:"tool-result",toolCallId:x.id,toolName:D.toCustomToolName("file_search"),result:{queries:x.queries,results:null!=(w=null==(v=x.results)?void 0:v.map(a=>({attributes:a.attributes,fileId:a.file_id,filename:a.filename,score:a.score,text:a.text})))?w:null}});break;case"code_interpreter_call":K.push({type:"tool-call",toolCallId:x.id,toolName:D.toCustomToolName("code_interpreter"),input:JSON.stringify({code:x.code,containerId:x.container_id}),providerExecuted:!0}),K.push({type:"tool-result",toolCallId:x.id,toolName:D.toCustomToolName("code_interpreter"),result:{outputs:x.outputs}});break;case"apply_patch_call":K.push({type:"tool-call",toolCallId:x.call_id,toolName:D.toCustomToolName("apply_patch"),input:JSON.stringify({callId:x.call_id,operation:x.operation}),providerMetadata:{[E]:{itemId:x.id}}})}let N={[E]:{responseId:I.id,...L.length>0?{logprobs:L}:{},..."string"==typeof I.service_tier?{serviceTier:I.service_tier}:{}}},O=I.usage;return{content:K,finishReason:{unified:kH({finishReason:null==(x=I.incomplete_details)?void 0:x.reason,hasFunctionCall:M}),raw:null!=(z=null==(y=I.incomplete_details)?void 0:y.reason)?z:void 0},usage:kD(O),request:{body:A},response:{id:I.id,timestamp:new Date(1e3*I.created_at),modelId:I.model,headers:H,body:J},providerMetadata:N,warnings:B}}async doStream(a){let b,c,{args:d,warnings:e,webSearchToolName:f,toolNameMapping:g,store:h,providerOptionsName:i}=await this.getArgs(a),{responseHeaders:j,value:k}=await dT({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:cT(this.config.headers(),a.headers),body:{...d,stream:!0},failedResponseHandler:jO,successfulResponseHandler:dZ(kI),abortSignal:a.abortSignal,fetch:this.config.fetch}),l=this,m=kM(a.prompt),n=new Map,o={unified:"other",raw:void 0},p=[],q=null,r={},s=[],t=!1,u={};return{stream:k.pipeThrough(new TransformStream({start(a){a.enqueue({type:"stream-start",warnings:e})},transform(d,e){var j,k,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X;if(a.includeRawChunks&&e.enqueue({type:"raw",rawValue:d.rawValue}),!d.success){o={unified:"error",raw:void 0},e.enqueue({type:"error",error:d.error});return}let Y=d.value;if(kO(Y))if("function_call"===Y.item.type)r[Y.output_index]={toolName:Y.item.name,toolCallId:Y.item.call_id},e.enqueue({type:"tool-input-start",id:Y.item.call_id,toolName:Y.item.name});else if("web_search_call"===Y.item.type)r[Y.output_index]={toolName:g.toCustomToolName(null!=f?f:"web_search"),toolCallId:Y.item.id},e.enqueue({type:"tool-input-start",id:Y.item.id,toolName:g.toCustomToolName(null!=f?f:"web_search"),providerExecuted:!0}),e.enqueue({type:"tool-input-end",id:Y.item.id}),e.enqueue({type:"tool-call",toolCallId:Y.item.id,toolName:g.toCustomToolName(null!=f?f:"web_search"),input:JSON.stringify({}),providerExecuted:!0});else if("computer_call"===Y.item.type)r[Y.output_index]={toolName:g.toCustomToolName("computer_use"),toolCallId:Y.item.id},e.enqueue({type:"tool-input-start",id:Y.item.id,toolName:g.toCustomToolName("computer_use"),providerExecuted:!0});else if("code_interpreter_call"===Y.item.type)r[Y.output_index]={toolName:g.toCustomToolName("code_interpreter"),toolCallId:Y.item.id,codeInterpreter:{containerId:Y.item.container_id}},e.enqueue({type:"tool-input-start",id:Y.item.id,toolName:g.toCustomToolName("code_interpreter"),providerExecuted:!0}),e.enqueue({type:"tool-input-delta",id:Y.item.id,delta:`{"containerId":"${Y.item.container_id}","code":"`});else if("file_search_call"===Y.item.type)e.enqueue({type:"tool-call",toolCallId:Y.item.id,toolName:g.toCustomToolName("file_search"),input:"{}",providerExecuted:!0});else if("image_generation_call"===Y.item.type)e.enqueue({type:"tool-call",toolCallId:Y.item.id,toolName:g.toCustomToolName("image_generation"),input:"{}",providerExecuted:!0});else if("mcp_call"===Y.item.type||"mcp_list_tools"===Y.item.type||"mcp_approval_request"===Y.item.type);else if("apply_patch_call"===Y.item.type){let{call_id:a,operation:b}=Y.item;if(r[Y.output_index]={toolName:g.toCustomToolName("apply_patch"),toolCallId:a,applyPatch:{hasDiff:"delete_file"===b.type,endEmitted:"delete_file"===b.type}},e.enqueue({type:"tool-input-start",id:a,toolName:g.toCustomToolName("apply_patch")}),"delete_file"===b.type){let c=JSON.stringify({callId:a,operation:b});e.enqueue({type:"tool-input-delta",id:a,delta:c}),e.enqueue({type:"tool-input-end",id:a})}else e.enqueue({type:"tool-input-delta",id:a,delta:`{"callId":"${kQ(a)}","operation":{"type":"${kQ(b.type)}","path":"${kQ(b.path)}","diff":"`})}else"shell_call"===Y.item.type?r[Y.output_index]={toolName:g.toCustomToolName("shell"),toolCallId:Y.item.call_id}:"message"===Y.item.type?(s.splice(0,s.length),e.enqueue({type:"text-start",id:Y.item.id,providerMetadata:{[i]:{itemId:Y.item.id}}})):kO(Y)&&"reasoning"===Y.item.type&&(u[Y.item.id]={encryptedContent:Y.item.encrypted_content,summaryParts:{0:"active"}},e.enqueue({type:"reasoning-start",id:`${Y.item.id}:0`,providerMetadata:{[i]:{itemId:Y.item.id,reasoningEncryptedContent:null!=(j=Y.item.encrypted_content)?j:null}}}));else if("response.output_item.done"===Y.type){if("message"===Y.item.type)e.enqueue({type:"text-end",id:Y.item.id,providerMetadata:{[i]:{itemId:Y.item.id,...s.length>0&&{annotations:s}}}});else if("function_call"===Y.item.type)r[Y.output_index]=void 0,t=!0,e.enqueue({type:"tool-input-end",id:Y.item.call_id}),e.enqueue({type:"tool-call",toolCallId:Y.item.call_id,toolName:Y.item.name,input:Y.item.arguments,providerMetadata:{[i]:{itemId:Y.item.id}}});else if("web_search_call"===Y.item.type)r[Y.output_index]=void 0,e.enqueue({type:"tool-result",toolCallId:Y.item.id,toolName:g.toCustomToolName(null!=f?f:"web_search"),result:kP(Y.item.action)});else if("computer_call"===Y.item.type)r[Y.output_index]=void 0,e.enqueue({type:"tool-input-end",id:Y.item.id}),e.enqueue({type:"tool-call",toolCallId:Y.item.id,toolName:g.toCustomToolName("computer_use"),input:"",providerExecuted:!0}),e.enqueue({type:"tool-result",toolCallId:Y.item.id,toolName:g.toCustomToolName("computer_use"),result:{type:"computer_use_tool_result",status:Y.item.status||"completed"}});else if("file_search_call"===Y.item.type)r[Y.output_index]=void 0,e.enqueue({type:"tool-result",toolCallId:Y.item.id,toolName:g.toCustomToolName("file_search"),result:{queries:Y.item.queries,results:null!=(v=null==(k=Y.item.results)?void 0:k.map(a=>({attributes:a.attributes,fileId:a.file_id,filename:a.filename,score:a.score,text:a.text})))?v:null}});else if("code_interpreter_call"===Y.item.type)r[Y.output_index]=void 0,e.enqueue({type:"tool-result",toolCallId:Y.item.id,toolName:g.toCustomToolName("code_interpreter"),result:{outputs:Y.item.outputs}});else if("image_generation_call"===Y.item.type)e.enqueue({type:"tool-result",toolCallId:Y.item.id,toolName:g.toCustomToolName("image_generation"),result:{result:Y.item.result}});else if("mcp_call"===Y.item.type){r[Y.output_index]=void 0;let a=null!=(w=Y.item.approval_request_id)?w:void 0,b=null!=a&&null!=(y=null!=(x=n.get(a))?x:m[a])?y:Y.item.id,c=`mcp.${Y.item.name}`;e.enqueue({type:"tool-call",toolCallId:b,toolName:c,input:Y.item.arguments,providerExecuted:!0,dynamic:!0}),e.enqueue({type:"tool-result",toolCallId:b,toolName:c,result:{type:"call",serverLabel:Y.item.server_label,name:Y.item.name,arguments:Y.item.arguments,...null!=Y.item.output?{output:Y.item.output}:{},...null!=Y.item.error?{error:Y.item.error}:{}},providerMetadata:{[i]:{itemId:Y.item.id}}})}else if("mcp_list_tools"===Y.item.type)r[Y.output_index]=void 0;else if("apply_patch_call"===Y.item.type){let a=r[Y.output_index];(null==a?void 0:a.applyPatch)&&!a.applyPatch.endEmitted&&"delete_file"!==Y.item.operation.type&&(a.applyPatch.hasDiff||e.enqueue({type:"tool-input-delta",id:a.toolCallId,delta:kQ(Y.item.operation.diff)}),e.enqueue({type:"tool-input-delta",id:a.toolCallId,delta:'"}}'}),e.enqueue({type:"tool-input-end",id:a.toolCallId}),a.applyPatch.endEmitted=!0),a&&"completed"===Y.item.status&&e.enqueue({type:"tool-call",toolCallId:a.toolCallId,toolName:g.toCustomToolName("apply_patch"),input:JSON.stringify({callId:Y.item.call_id,operation:Y.item.operation}),providerMetadata:{[i]:{itemId:Y.item.id}}}),r[Y.output_index]=void 0}else if("mcp_approval_request"===Y.item.type){r[Y.output_index]=void 0;let a=null!=(B=null==(A=(z=l.config).generateId)?void 0:A.call(z))?B:c7(),b=null!=(C=Y.item.approval_request_id)?C:Y.item.id;n.set(b,a);let c=`mcp.${Y.item.name}`;e.enqueue({type:"tool-call",toolCallId:a,toolName:c,input:Y.item.arguments,providerExecuted:!0,dynamic:!0}),e.enqueue({type:"tool-approval-request",approvalId:b,toolCallId:a})}else if("local_shell_call"===Y.item.type)r[Y.output_index]=void 0,e.enqueue({type:"tool-call",toolCallId:Y.item.call_id,toolName:g.toCustomToolName("local_shell"),input:JSON.stringify({action:{type:"exec",command:Y.item.action.command,timeoutMs:Y.item.action.timeout_ms,user:Y.item.action.user,workingDirectory:Y.item.action.working_directory,env:Y.item.action.env}}),providerMetadata:{[i]:{itemId:Y.item.id}}});else if("shell_call"===Y.item.type)r[Y.output_index]=void 0,e.enqueue({type:"tool-call",toolCallId:Y.item.call_id,toolName:g.toCustomToolName("shell"),input:JSON.stringify({action:{commands:Y.item.action.commands}}),providerMetadata:{[i]:{itemId:Y.item.id}}});else if("reasoning"===Y.item.type){for(let a of Object.entries(u[Y.item.id].summaryParts).filter(([a,b])=>"active"===b||"can-conclude"===b).map(([a])=>a))e.enqueue({type:"reasoning-end",id:`${Y.item.id}:${a}`,providerMetadata:{[i]:{itemId:Y.item.id,reasoningEncryptedContent:null!=(D=Y.item.encrypted_content)?D:null}}});delete u[Y.item.id]}}else if("response.function_call_arguments.delta"===Y.type){let a=r[Y.output_index];null!=a&&e.enqueue({type:"tool-input-delta",id:a.toolCallId,delta:Y.delta})}else if("response.apply_patch_call_operation_diff.delta"===Y.type){let a=r[Y.output_index];(null==a?void 0:a.applyPatch)&&(e.enqueue({type:"tool-input-delta",id:a.toolCallId,delta:kQ(Y.delta)}),a.applyPatch.hasDiff=!0)}else if("response.apply_patch_call_operation_diff.done"===Y.type){let a=r[Y.output_index];(null==a?void 0:a.applyPatch)&&!a.applyPatch.endEmitted&&(a.applyPatch.hasDiff||(e.enqueue({type:"tool-input-delta",id:a.toolCallId,delta:kQ(Y.diff)}),a.applyPatch.hasDiff=!0),e.enqueue({type:"tool-input-delta",id:a.toolCallId,delta:'"}}'}),e.enqueue({type:"tool-input-end",id:a.toolCallId}),a.applyPatch.endEmitted=!0)}else if("response.image_generation_call.partial_image"===Y.type)e.enqueue({type:"tool-result",toolCallId:Y.item_id,toolName:g.toCustomToolName("image_generation"),result:{result:Y.partial_image_b64},preliminary:!0});else if("response.code_interpreter_call_code.delta"===Y.type){let a=r[Y.output_index];null!=a&&e.enqueue({type:"tool-input-delta",id:a.toolCallId,delta:kQ(Y.delta)})}else if("response.code_interpreter_call_code.done"===Y.type){let a=r[Y.output_index];null!=a&&(e.enqueue({type:"tool-input-delta",id:a.toolCallId,delta:'"}'}),e.enqueue({type:"tool-input-end",id:a.toolCallId}),e.enqueue({type:"tool-call",toolCallId:a.toolCallId,toolName:g.toCustomToolName("code_interpreter"),input:JSON.stringify({code:Y.code,containerId:a.codeInterpreter.containerId}),providerExecuted:!0}))}else if("response.created"===Y.type)q=Y.response.id,e.enqueue({type:"response-metadata",id:Y.response.id,timestamp:new Date(1e3*Y.response.created_at),modelId:Y.response.model});else if("response.output_text.delta"===Y.type)e.enqueue({type:"text-delta",id:Y.item_id,delta:Y.delta}),(null==(F=null==(E=a.providerOptions)?void 0:E[i])?void 0:F.logprobs)&&Y.logprobs&&p.push(Y.logprobs);else if("response.reasoning_summary_part.added"===Y.type){if(Y.summary_index>0){let a=u[Y.item_id];for(let b of(a.summaryParts[Y.summary_index]="active",Object.keys(a.summaryParts)))"can-conclude"===a.summaryParts[b]&&(e.enqueue({type:"reasoning-end",id:`${Y.item_id}:${b}`,providerMetadata:{[i]:{itemId:Y.item_id}}}),a.summaryParts[b]="concluded");e.enqueue({type:"reasoning-start",id:`${Y.item_id}:${Y.summary_index}`,providerMetadata:{[i]:{itemId:Y.item_id,reasoningEncryptedContent:null!=(H=null==(G=u[Y.item_id])?void 0:G.encryptedContent)?H:null}}})}}else{"response.reasoning_summary_text.delta"===Y.type?e.enqueue({type:"reasoning-delta",id:`${Y.item_id}:${Y.summary_index}`,delta:Y.delta,providerMetadata:{[i]:{itemId:Y.item_id}}}):"response.reasoning_summary_part.done"===Y.type?h?(e.enqueue({type:"reasoning-end",id:`${Y.item_id}:${Y.summary_index}`,providerMetadata:{[i]:{itemId:Y.item_id}}}),u[Y.item_id].summaryParts[Y.summary_index]="concluded"):u[Y.item_id].summaryParts[Y.summary_index]="can-conclude":"response.completed"===(X=Y).type||"response.incomplete"===X.type?(o={unified:kH({finishReason:null==(I=Y.response.incomplete_details)?void 0:I.reason,hasFunctionCall:t}),raw:null!=(K=null==(J=Y.response.incomplete_details)?void 0:J.reason)?K:void 0},c=Y.response.usage,"string"==typeof Y.response.service_tier&&(b=Y.response.service_tier)):"response.output_text.annotation.added"===Y.type?(s.push(Y.annotation),"url_citation"===Y.annotation.type?e.enqueue({type:"source",sourceType:"url",id:null!=(N=null==(M=(L=l.config).generateId)?void 0:M.call(L))?N:c7(),url:Y.annotation.url,title:Y.annotation.title}):"file_citation"===Y.annotation.type?e.enqueue({type:"source",sourceType:"document",id:null!=(Q=null==(P=(O=l.config).generateId)?void 0:P.call(O))?Q:c7(),mediaType:"text/plain",title:Y.annotation.filename,filename:Y.annotation.filename,providerMetadata:{[i]:{type:Y.annotation.type,fileId:Y.annotation.file_id,index:Y.annotation.index}}}):"container_file_citation"===Y.annotation.type?e.enqueue({type:"source",sourceType:"document",id:null!=(T=null==(S=(R=l.config).generateId)?void 0:S.call(R))?T:c7(),mediaType:"text/plain",title:Y.annotation.filename,filename:Y.annotation.filename,providerMetadata:{[i]:{type:Y.annotation.type,fileId:Y.annotation.file_id,containerId:Y.annotation.container_id}}}):"file_path"===Y.annotation.type&&e.enqueue({type:"source",sourceType:"document",id:null!=(W=null==(V=(U=l.config).generateId)?void 0:V.call(U))?W:c7(),mediaType:"application/octet-stream",title:Y.annotation.file_id,filename:Y.annotation.file_id,providerMetadata:{[i]:{type:Y.annotation.type,fileId:Y.annotation.file_id,index:Y.annotation.index}}})):"error"===Y.type&&e.enqueue({type:"error",error:Y})}},flush(a){let d={[i]:{responseId:q,...p.length>0?{logprobs:p}:{},...void 0!==b?{serviceTier:b}:{}}};a.enqueue({type:"finish",finishReason:o,usage:kD(c),providerMetadata:d})}})),request:{body:d},response:{headers:j}}}};function kO(a){return"response.output_item.added"===a.type}function kP(a){var b;switch(a.type){case"search":return{action:{type:"search",query:null!=(b=a.query)?b:void 0},...null!=a.sources&&{sources:a.sources}};case"open_page":return{action:{type:"openPage",url:a.url}};case"find_in_page":return{action:{type:"findInPage",url:a.url,pattern:a.pattern}}}}function kQ(a){return JSON.stringify(a).slice(1,-1)}var kR=dI(()=>dL(gB({instructions:f_().nullish(),speed:gl().min(.25).max(4).default(1).nullish()}))),kS=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v3"}get provider(){return this.config.provider}async getArgs({text:a,voice:b="alloy",outputFormat:c="mp3",speed:d,instructions:e,language:f,providerOptions:g}){let h=[],i=await dR({provider:"openai",providerOptions:g,schema:kR}),j={model:this.modelId,input:a,voice:b,response_format:"mp3",speed:d,instructions:e};if(c&&(["mp3","opus","aac","flac","wav","pcm"].includes(c)?j.response_format=c:h.push({type:"unsupported",feature:"outputFormat",details:`Unsupported output format: ${c}. Using mp3 instead.`})),i){let a={};for(let b in a){let c=a[b];void 0!==c&&(j[b]=c)}}return f&&h.push({type:"unsupported",feature:"language",details:`OpenAI speech models do not support language selection. Language parameter "${f}" was ignored.`}),{requestBody:j,warnings:h}}async doGenerate(a){var b,c,d;let e=null!=(d=null==(c=null==(b=this.config._internal)?void 0:b.currentDate)?void 0:c.call(b))?d:new Date,{requestBody:f,warnings:g}=await this.getArgs(a),{value:h,responseHeaders:i,rawValue:j}=await dT({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:cT(this.config.headers(),a.headers),body:f,failedResponseHandler:jO,successfulResponseHandler:async({response:a,url:b,requestBodyValues:c})=>{let d=cW(a);if(!a.body)throw new am({message:"Response body is empty",url:b,requestBodyValues:c,statusCode:a.status,responseHeaders:d,responseBody:void 0});try{let b=await a.arrayBuffer();return{responseHeaders:d,value:new Uint8Array(b)}}catch(e){throw new am({message:"Failed to read response as array buffer",url:b,requestBodyValues:c,statusCode:a.status,responseHeaders:d,responseBody:void 0,cause:e})}},abortSignal:a.abortSignal,fetch:this.config.fetch});return{audio:h,warnings:g,request:{body:JSON.stringify(f)},response:{timestamp:e,modelId:this.modelId,headers:i,body:j}}}},kT=dI(()=>dL(gB({text:f_(),language:f_().nullish(),duration:gl().nullish(),words:gz(gB({word:f_(),start:gl(),end:gl()})).nullish(),segments:gz(gB({id:gl(),seek:gl(),start:gl(),end:gl(),text:f_(),tokens:gz(gl()),temperature:gl(),avg_logprob:gl(),compression_ratio:gl(),no_speech_prob:gl()})).nullish()}))),kU=dI(()=>dL(gB({include:gz(f_()).optional(),language:f_().optional(),prompt:f_().optional(),temperature:gl().min(0).max(1).default(0).optional(),timestampGranularities:gz(gL(["word","segment"])).default(["segment"]).optional()}))),kV={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},kW=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v3"}get provider(){return this.config.provider}async getArgs({audio:a,mediaType:b,providerOptions:c}){let d=await dR({provider:"openai",providerOptions:c,schema:kU}),e=new FormData,f=a instanceof Uint8Array?new Blob([a]):new Blob([cZ(a)]);e.append("model",this.modelId);let g=function(a){var b;let[c,d=""]=a.toLowerCase().split("/");return null!=(b=({mpeg:"mp3","x-wav":"wav",opus:"ogg",mp4:"m4a","x-m4a":"m4a"})[d])?b:d}(b);if(e.append("file",new File([f],"audio",{type:b}),`audio.${g}`),d){for(let[a,b]of Object.entries({include:d.include,language:d.language,prompt:d.prompt,response_format:["gpt-4o-transcribe","gpt-4o-mini-transcribe"].includes(this.modelId)?"json":"verbose_json",temperature:d.temperature,timestamp_granularities:d.timestampGranularities}))if(null!=b)if(Array.isArray(b))for(let c of b)e.append(`${a}[]`,String(c));else e.append(a,String(b))}return{formData:e,warnings:[]}}async doGenerate(a){var b,c,d,e,f,g,h,i;let j=null!=(d=null==(c=null==(b=this.config._internal)?void 0:b.currentDate)?void 0:c.call(b))?d:new Date,{formData:k,warnings:l}=await this.getArgs(a),{value:m,responseHeaders:n,rawValue:o}=await dU({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:cT(this.config.headers(),a.headers),formData:k,failedResponseHandler:jO,successfulResponseHandler:d$(kT),abortSignal:a.abortSignal,fetch:this.config.fetch}),p=null!=m.language&&m.language in kV?kV[m.language]:void 0;return{text:m.text,segments:null!=(h=null!=(g=null==(e=m.segments)?void 0:e.map(a=>({text:a.text,startSecond:a.start,endSecond:a.end})))?g:null==(f=m.words)?void 0:f.map(a=>({text:a.word,startSecond:a.start,endSecond:a.end})))?h:[],language:p,durationInSeconds:null!=(i=m.duration)?i:void 0,warnings:l,response:{timestamp:j,modelId:this.modelId,headers:n,body:o}}}},kX=function(a={}){var b,c;let d=null!=(b=d_(dj({settingValue:a.baseURL,environmentVariableName:"OPENAI_BASE_URL"})))?b:"https://api.openai.com/v1",e=null!=(c=a.name)?c:"openai",f=()=>de({Authorization:`Bearer ${function({apiKey:a,environmentVariableName:b,apiKeyParameterName:c="apiKey",description:d}){if("string"==typeof a)return a;if(null!=a)throw new aL({message:`${d} API key must be a string.`});if("undefined"==typeof process)throw new aL({message:`${d} API key is missing. Pass it using the '${c}' parameter. Environment variables is not supported in this environment.`});if(null==(a=process.env[b]))throw new aL({message:`${d} API key is missing. Pass it using the '${c}' parameter or the ${b} environment variable.`});if("string"!=typeof a)throw new aL({message:`${d} API key must be a string. The value of the ${b} environment variable is not a string.`});return a}({apiKey:a.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":a.organization,"OpenAI-Project":a.project,...a.headers},"ai-sdk/openai/3.0.29"),g=b=>new j4(b,{provider:`${e}.embedding`,url:({path:a})=>`${d}${a}`,headers:f,fetch:a.fetch}),h=b=>new j8(b,{provider:`${e}.image`,url:({path:a})=>`${d}${a}`,headers:f,fetch:a.fetch}),i=b=>new kW(b,{provider:`${e}.transcription`,url:({path:a})=>`${d}${a}`,headers:f,fetch:a.fetch}),j=b=>new kS(b,{provider:`${e}.speech`,url:({path:a})=>`${d}${a}`,headers:f,fetch:a.fetch}),k=a=>{if(new.target)throw Error("The OpenAI model function cannot be called with the new keyword.");return l(a)},l=b=>new kN(b,{provider:`${e}.responses`,url:({path:a})=>`${d}${a}`,headers:f,fetch:a.fetch,fileIdPrefixes:["file-"]}),m=function(a){return k(a)};return m.specificationVersion="v3",m.languageModel=k,m.chat=b=>new jW(b,{provider:`${e}.chat`,url:({path:a})=>`${d}${a}`,headers:f,fetch:a.fetch}),m.completion=b=>new j1(b,{provider:`${e}.completion`,url:({path:a})=>`${d}${a}`,headers:f,fetch:a.fetch}),m.responses=l,m.embedding=g,m.embeddingModel=g,m.textEmbedding=g,m.textEmbeddingModel=g,m.image=h,m.imageModel=h,m.transcription=i,m.transcriptionModel=i,m.speech=j,m.speechModel=j,m.tools=kC,m}(),kY=c(72987);async function kZ(a){let b=await kY.z.project.findUnique({where:{id:a},include:{features:!0}});if(!b)throw Error("Proyecto no encontrado");let c=b.features.map(a=>`- ${a.name}: ${a.description} (~${a.estimatedHours}h)`).join("\n"),d=`Eres un Product Manager senior. Genera un PRD t\xe9cnico detallado pero conciso en Markdown para este proyecto:

T\xedtulo: ${b.title}
Descripci\xf3n: ${b.description}

Features identificadas:
${c}

Genera una especificaci\xf3n t\xe9cnica que incluya:
1. Resumen ejecutivo
2. Objetivos del producto
3. Scope del proyecto (lista las features)
4. Requerimientos funcionales
5. Arquitectura recomendada
6. Plan de desarrollo (fases)

Formato: Markdown puro, sin c\xf3digo.
`;try{let{text:b}=await jI({model:kX("gpt-4o"),prompt:d,temperature:.6});return console.log(`PRD generado para proyecto ${a}`),b}catch(a){throw console.error("Error generando PRD:",a),a}}async function k$(a,b,c){let d=await kY.z.project.update({where:{id:a},data:{status:"DELIVERED",deliveryFile:b,videoWalkthrough:c,deliveredAt:new Date}});try{await k_(d)}catch(a){console.error("Error enviando email de entrega:",a)}}async function k_(a){console.log(`Email de entrega enviado a ${a.clientId}`)}(0,c(51669).D)([kZ,k$]),(0,af.A)(kZ,"40b68259517ab7548e158ff6ef0a3c29864d8ee30a",null),(0,af.A)(k$,"70ce1ba1547cb37e65932060a56ac8051d2e68d52e",null)},43109:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>G,patchFetch:()=>F,routeModule:()=>B,serverHooks:()=>E,workAsyncStorage:()=>C,workUnitAsyncStorage:()=>D});var d={};c.r(d),c.d(d,{POST:()=>A});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(261),k=c(54290),l=c(85328),m=c(38928),n=c(46595),o=c(3421),p=c(17679),q=c(41681),r=c(63446),s=c(86439),t=c(51356),u=c(10641),v=c(72987);let w=require("crypto");var x=c.n(w),y=c(38279);let z=process.env.WOMPI_INTEGRITY_KEY;async function A(a){try{let b=a.headers.get("x-wompi-signature");if(!b||!z)return console.error("Missing signature or integrity key"),u.NextResponse.json({error:"Unauthorized"},{status:401});let c=await a.text();if(x().createHash("sha256").update(c+z).digest("hex")!==b)return console.error("Invalid signature"),u.NextResponse.json({error:"Invalid signature"},{status:401});let{event:d,data:e}=JSON.parse(c);if("transaction.updated"===d){let{reference:a,status:b,id:c}=e.transaction,d=await v.z.transaction.findUnique({where:{reference:a},include:{project:{include:{features:!0}}}});if(!d)return console.warn(`Transaction not found for reference: ${a}`),u.NextResponse.json({message:"Transaction not found"},{status:404});let f="PENDING";if("APPROVED"===b?f="APPROVED":"DECLINED"===b?f="DECLINED":"VOIDED"===b?f="VOIDED":"ERROR"===b&&(f="ERROR"),await v.z.transaction.update({where:{id:d.id},data:{wompiStatus:f,wompiId:c,approvedAt:"APPROVED"===f?new Date:null}}),"APPROVED"===f){let a=d.project;await (0,y.k)(a.id),await v.z.project.update({where:{id:a.id},data:{status:"PAID"}})}return u.NextResponse.json({message:"Webhook processed successfully"},{status:200})}return u.NextResponse.json({message:"Event received"},{status:200})}catch(a){return console.error("Webhook error:",a),u.NextResponse.json({error:"Internal server error"},{status:500})}}let B=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/webhooks/wompi/route",pathname:"/api/webhooks/wompi",filename:"route",bundlePath:"app/api/webhooks/wompi/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/home/runner/work/productized-service-saas/productized-service-saas/src/app/api/webhooks/wompi/route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:C,workUnitAsyncStorage:D,serverHooks:E}=B;function F(){return(0,g.patchFetch)({workAsyncStorage:C,workUnitAsyncStorage:D})}async function G(a,b,c){var d;let e="/api/webhooks/wompi/route";"/index"===e&&(e="/");let g=await B.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:y,routerServerContext:z,isOnDemandRevalidate:A,revalidateOnlyGenerated:C,resolvedPathname:D}=g,E=(0,j.normalizeAppPath)(e),F=!!(y.dynamicRoutes[E]||y.routes[D]);if(F&&!x){let a=!!y.routes[D],b=y.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||B.isDev||x||(G="/index"===(G=D)?"/":G);let H=!0===B.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:y,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>B.onRequestError(a,b,d,z)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>B.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&A&&C&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await B.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:A})},z),b}},l=await B.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",A?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(b instanceof s.NoFallbackError||await B.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:A})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48837:a=>{"use strict";var b=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyNames,e=Object.prototype.hasOwnProperty,f={};((a,c)=>{for(var d in c)b(a,d,{get:c[d],enumerable:!0})})(f,{SYMBOL_FOR_REQ_CONTEXT:()=>g,getContext:()=>h}),a.exports=((a,f,g,h)=>{if(f&&"object"==typeof f||"function"==typeof f)for(let i of d(f))e.call(a,i)||i===g||b(a,i,{get:()=>f[i],enumerable:!(h=c(f,i))||h.enumerable});return a})(b({},"__esModule",{value:!0}),f);let g=Symbol.for("@vercel/request-context");function h(){let a=globalThis;return a[g]?.get?.()??{}}},51669:(a,b)=>{"use strict";function c(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(b,"D",{enumerable:!0,get:function(){return c}})},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67913:(a,b,c)=>{"use strict";Object.create;var d=Object.defineProperty,e=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames;Object.getPrototypeOf;var g=Object.prototype.hasOwnProperty,h={};((a,b)=>{for(var c in b)d(a,c,{get:b[c],enumerable:!0})})(h,{getVercelOidcToken:()=>k,getVercelOidcTokenSync:()=>l}),a.exports=((a,b,c,h)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let i of f(b))g.call(a,i)||i===c||d(a,i,{get:()=>b[i],enumerable:!(h=e(b,i))||h.enumerable});return a})(d({},"__esModule",{value:!0}),h);var i=c(48837),j=c(1881);async function k(){let a,b="";try{b=l()}catch(b){a=b}try{let[{getTokenPayload:a,isExpired:d},{refreshToken:e}]=await Promise.all([await c.e(218).then(c.t.bind(c,87871,23)),await c.e(882).then(c.t.bind(c,78882,23))]);(!b||d(a(b)))&&(await e(),b=l())}catch(c){let b=a instanceof Error?a.message:"";if(c instanceof Error&&(b=`${b}
${c.message}`),b)throw new j.VercelOidcTokenError(b);throw c}return b}function l(){let a=(0,i.getContext)().headers?.["x-vercel-oidc-token"]??process.env.VERCEL_OIDC_TOKEN;if(!a)throw Error("The 'x-vercel-oidc-token' header is missing from the request. Do you have the OIDC option enabled in the Vercel project settings?");return a}},68633:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{decryptActionBoundArgs:function(){return s},encryptActionBoundArgs:function(){return r}}),c(77925);let d=c(97954),e=c(27825),f=c(47686),g=c(77533),h=c(63033),i=c(26906),j=function(a){return a&&a.__esModule?a:{default:a}}(c(74515)),k=new TextEncoder,l=new TextDecoder,m=void 0,n=void 0;async function o(a,b){let c=await (0,g.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=atob(b),e=d.slice(0,16),f=d.slice(16),h=l.decode(await (0,g.decrypt)(c,(0,g.stringToUint8Array)(e),(0,g.stringToUint8Array)(f)));if(!h.startsWith(a))throw Object.defineProperty(Error("Invalid Server Action payload: failed to decrypt."),"__NEXT_ERROR_CODE",{value:"E191",enumerable:!1,configurable:!0});return h.slice(a.length)}async function p(a,b){let c=await (0,g.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=new Uint8Array(16);h.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(d));let e=(0,g.arrayBufferToString)(d.buffer),f=await (0,g.encrypt)(c,d,k.encode(a+b));return btoa(e+(0,g.arrayBufferToString)(f))}var q=function(a){return a[a.Ready=0]="Ready",a[a.Pending=1]="Pending",a[a.Complete=2]="Complete",a}(q||{});let r=j.default.cache(async function a(b,...c){let e=h.workUnitAsyncStorage.getStore(),j=e?(0,h.getCacheSignal)(e):void 0,{clientModules:k}=(0,g.getClientReferenceManifestForRsc)(),l=Error();Error.captureStackTrace(l,a);let n=!1,o=e?(0,i.createHangingInputAbortSignal)(e):void 0,q=0;function r(){0===q&&(q=1,null==j||j.beginRead())}function s(){1===q&&(null==j||j.endRead()),q=2}o&&j&&o.addEventListener("abort",r,{once:!0});let t=await (0,f.streamToString)((0,d.renderToReadableStream)(c,k,{filterStackFrame:m,signal:o,onError(a){(null==o||!o.aborted)&&(n||(n=!0,l.message=a instanceof Error?a.message:String(a)))}}),o);if(n)throw s(),l;if(!e)return p(b,t);r();let u=(0,h.getPrerenderResumeDataCache)(e),v=(0,h.getRenderResumeDataCache)(e),w=b+t,x=(null==u?void 0:u.encryptedBoundArgs.get(w))??(null==v?void 0:v.encryptedBoundArgs.get(w));if(x)return x;let y=await p(b,t);return s(),null==u||u.encryptedBoundArgs.set(w,y),y});async function s(a,b){let c,d=await b,f=h.workUnitAsyncStorage.getStore();if(f){let b=(0,h.getCacheSignal)(f),e=(0,h.getPrerenderResumeDataCache)(f),g=(0,h.getRenderResumeDataCache)(f);(c=(null==e?void 0:e.decryptedBoundArgs.get(d))??(null==g?void 0:g.decryptedBoundArgs.get(d)))||(null==b||b.beginRead(),c=await o(a,d),null==b||b.endRead(),null==e||e.decryptedBoundArgs.set(d,c))}else c=await o(a,d);let{edgeRscModuleMapping:i,rscModuleMapping:j}=(0,g.getClientReferenceManifestForRsc)();return await (0,e.createFromReadableStream)(new ReadableStream({start(a){switch(a.enqueue(k.encode(c)),null==f?void 0:f.type){case"prerender":case"prerender-runtime":f.renderSignal.aborted?a.close():f.renderSignal.addEventListener("abort",()=>a.close(),{once:!0});break;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":case void 0:return a.close()}}}),{findSourceMapURL:n,serverConsumerManifest:{moduleLoading:null,moduleMap:j,serverModuleMap:(0,g.getServerModuleMap)()}})}},72987:(a,b,c)=>{"use strict";c.d(b,{z:()=>e});let d=require("@prisma/client"),e=global.prisma||new d.PrismaClient({log:["warn","error"]})},75879:(a,b,c)=>{"use strict";Object.defineProperty(b,"A",{enumerable:!0,get:function(){return d.registerServerReference}});let d=c(97954)},78335:()=>{},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},95736:(a,b,c)=>{"use strict";a.exports=c(44870)},96487:()=>{},98311:(a,b,c)=>{"use strict";var d=Object.defineProperty,e=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,g=Object.prototype.hasOwnProperty,h={};((a,b)=>{for(var c in b)d(a,c,{get:b[c],enumerable:!0})})(h,{getContext:()=>j.getContext,getVercelOidcToken:()=>i.getVercelOidcToken,getVercelOidcTokenSync:()=>i.getVercelOidcTokenSync}),a.exports=((a,b,c,h)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let i of f(b))g.call(a,i)||i===c||d(a,i,{get:()=>b[i],enumerable:!(h=e(b,i))||h.enumerable});return a})(d({},"__esModule",{value:!0}),h);var i=c(67913),j=c(48837)}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[720,641],()=>b(b.s=43109));module.exports=c})();